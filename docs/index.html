<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>picocli - a mighty tiny command line interface</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous" ></script>
<script>
    /*!
 * clipboard.js v2.0.6
 * https://clipboardjs.com/
 *
 * Licensed MIT Â© Zeno Rocha
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["ClipboardJS"] = factory();
	else
		root["ClipboardJS"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 6);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

function select(element) {
    var selectedText;

    if (element.nodeName === 'SELECT') {
        element.focus();

        selectedText = element.value;
    }
    else if (element.nodeName === 'INPUT' || element.nodeName === 'TEXTAREA') {
        var isReadOnly = element.hasAttribute('readonly');

        if (!isReadOnly) {
            element.setAttribute('readonly', '');
        }

        element.select();
        element.setSelectionRange(0, element.value.length);

        if (!isReadOnly) {
            element.removeAttribute('readonly');
        }

        selectedText = element.value;
    }
    else {
        if (element.hasAttribute('contenteditable')) {
            element.focus();
        }

        var selection = window.getSelection();
        var range = document.createRange();

        range.selectNodeContents(element);
        selection.removeAllRanges();
        selection.addRange(range);

        selectedText = selection.toString();
    }

    return selectedText;
}

module.exports = select;


/***/ }),
/* 1 */
/***/ (function(module, exports) {

function E () {
  // Keep this empty so it's easier to inherit from
  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)
}

E.prototype = {
  on: function (name, callback, ctx) {
    var e = this.e || (this.e = {});

    (e[name] || (e[name] = [])).push({
      fn: callback,
      ctx: ctx
    });

    return this;
  },

  once: function (name, callback, ctx) {
    var self = this;
    function listener () {
      self.off(name, listener);
      callback.apply(ctx, arguments);
    };

    listener._ = callback
    return this.on(name, listener, ctx);
  },

  emit: function (name) {
    var data = [].slice.call(arguments, 1);
    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();
    var i = 0;
    var len = evtArr.length;

    for (i; i < len; i++) {
      evtArr[i].fn.apply(evtArr[i].ctx, data);
    }

    return this;
  },

  off: function (name, callback) {
    var e = this.e || (this.e = {});
    var evts = e[name];
    var liveEvents = [];

    if (evts && callback) {
      for (var i = 0, len = evts.length; i < len; i++) {
        if (evts[i].fn !== callback && evts[i].fn._ !== callback)
          liveEvents.push(evts[i]);
      }
    }

    // Remove event from queue to prevent memory leak
    // Suggested by https://github.com/lazd
    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910

    (liveEvents.length)
      ? e[name] = liveEvents
      : delete e[name];

    return this;
  }
};

module.exports = E;
module.exports.TinyEmitter = E;


/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

var is = __webpack_require__(3);
var delegate = __webpack_require__(4);

/**
 * Validates all params and calls the right
 * listener function based on its target type.
 *
 * @param {String|HTMLElement|HTMLCollection|NodeList} target
 * @param {String} type
 * @param {Function} callback
 * @return {Object}
 */
function listen(target, type, callback) {
    if (!target && !type && !callback) {
        throw new Error('Missing required arguments');
    }

    if (!is.string(type)) {
        throw new TypeError('Second argument must be a String');
    }

    if (!is.fn(callback)) {
        throw new TypeError('Third argument must be a Function');
    }

    if (is.node(target)) {
        return listenNode(target, type, callback);
    }
    else if (is.nodeList(target)) {
        return listenNodeList(target, type, callback);
    }
    else if (is.string(target)) {
        return listenSelector(target, type, callback);
    }
    else {
        throw new TypeError('First argument must be a String, HTMLElement, HTMLCollection, or NodeList');
    }
}

/**
 * Adds an event listener to a HTML element
 * and returns a remove listener function.
 *
 * @param {HTMLElement} node
 * @param {String} type
 * @param {Function} callback
 * @return {Object}
 */
function listenNode(node, type, callback) {
    node.addEventListener(type, callback);

    return {
        destroy: function() {
            node.removeEventListener(type, callback);
        }
    }
}

/**
 * Add an event listener to a list of HTML elements
 * and returns a remove listener function.
 *
 * @param {NodeList|HTMLCollection} nodeList
 * @param {String} type
 * @param {Function} callback
 * @return {Object}
 */
function listenNodeList(nodeList, type, callback) {
    Array.prototype.forEach.call(nodeList, function(node) {
        node.addEventListener(type, callback);
    });

    return {
        destroy: function() {
            Array.prototype.forEach.call(nodeList, function(node) {
                node.removeEventListener(type, callback);
            });
        }
    }
}

/**
 * Add an event listener to a selector
 * and returns a remove listener function.
 *
 * @param {String} selector
 * @param {String} type
 * @param {Function} callback
 * @return {Object}
 */
function listenSelector(selector, type, callback) {
    return delegate(document.body, selector, type, callback);
}

module.exports = listen;


/***/ }),
/* 3 */
/***/ (function(module, exports) {

/**
 * Check if argument is a HTML element.
 *
 * @param {Object} value
 * @return {Boolean}
 */
exports.node = function(value) {
    return value !== undefined
        && value instanceof HTMLElement
        && value.nodeType === 1;
};

/**
 * Check if argument is a list of HTML elements.
 *
 * @param {Object} value
 * @return {Boolean}
 */
exports.nodeList = function(value) {
    var type = Object.prototype.toString.call(value);

    return value !== undefined
        && (type === '[object NodeList]' || type === '[object HTMLCollection]')
        && ('length' in value)
        && (value.length === 0 || exports.node(value[0]));
};

/**
 * Check if argument is a string.
 *
 * @param {Object} value
 * @return {Boolean}
 */
exports.string = function(value) {
    return typeof value === 'string'
        || value instanceof String;
};

/**
 * Check if argument is a function.
 *
 * @param {Object} value
 * @return {Boolean}
 */
exports.fn = function(value) {
    var type = Object.prototype.toString.call(value);

    return type === '[object Function]';
};


/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var closest = __webpack_require__(5);

/**
 * Delegates event to a selector.
 *
 * @param {Element} element
 * @param {String} selector
 * @param {String} type
 * @param {Function} callback
 * @param {Boolean} useCapture
 * @return {Object}
 */
function _delegate(element, selector, type, callback, useCapture) {
    var listenerFn = listener.apply(this, arguments);

    element.addEventListener(type, listenerFn, useCapture);

    return {
        destroy: function() {
            element.removeEventListener(type, listenerFn, useCapture);
        }
    }
}

/**
 * Delegates event to a selector.
 *
 * @param {Element|String|Array} [elements]
 * @param {String} selector
 * @param {String} type
 * @param {Function} callback
 * @param {Boolean} useCapture
 * @return {Object}
 */
function delegate(elements, selector, type, callback, useCapture) {
    // Handle the regular Element usage
    if (typeof elements.addEventListener === 'function') {
        return _delegate.apply(null, arguments);
    }

    // Handle Element-less usage, it defaults to global delegation
    if (typeof type === 'function') {
        // Use `document` as the first parameter, then apply arguments
        // This is a short way to .unshift `arguments` without running into deoptimizations
        return _delegate.bind(null, document).apply(null, arguments);
    }

    // Handle Selector-based usage
    if (typeof elements === 'string') {
        elements = document.querySelectorAll(elements);
    }

    // Handle Array-like based usage
    return Array.prototype.map.call(elements, function (element) {
        return _delegate(element, selector, type, callback, useCapture);
    });
}

/**
 * Finds closest match and invokes callback.
 *
 * @param {Element} element
 * @param {String} selector
 * @param {String} type
 * @param {Function} callback
 * @return {Function}
 */
function listener(element, selector, type, callback) {
    return function(e) {
        e.delegateTarget = closest(e.target, selector);

        if (e.delegateTarget) {
            callback.call(element, e);
        }
    }
}

module.exports = delegate;


/***/ }),
/* 5 */
/***/ (function(module, exports) {

var DOCUMENT_NODE_TYPE = 9;

/**
 * A polyfill for Element.matches()
 */
if (typeof Element !== 'undefined' && !Element.prototype.matches) {
    var proto = Element.prototype;

    proto.matches = proto.matchesSelector ||
                    proto.mozMatchesSelector ||
                    proto.msMatchesSelector ||
                    proto.oMatchesSelector ||
                    proto.webkitMatchesSelector;
}

/**
 * Finds the closest parent that matches a selector.
 *
 * @param {Element} element
 * @param {String} selector
 * @return {Function}
 */
function closest (element, selector) {
    while (element && element.nodeType !== DOCUMENT_NODE_TYPE) {
        if (typeof element.matches === 'function' &&
            element.matches(selector)) {
          return element;
        }
        element = element.parentNode;
    }
}

module.exports = closest;


/***/ }),
/* 6 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/select/src/select.js
var src_select = __webpack_require__(0);
var select_default = /*#__PURE__*/__webpack_require__.n(src_select);

// CONCATENATED MODULE: ./src/clipboard-action.js
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }



/**
 * Inner class which performs selection from either `text` or `target`
 * properties and then executes copy or cut operations.
 */

var clipboard_action_ClipboardAction = function () {
    /**
     * @param {Object} options
     */
    function ClipboardAction(options) {
        _classCallCheck(this, ClipboardAction);

        this.resolveOptions(options);
        this.initSelection();
    }

    /**
     * Defines base properties passed from constructor.
     * @param {Object} options
     */


    _createClass(ClipboardAction, [{
        key: 'resolveOptions',
        value: function resolveOptions() {
            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

            this.action = options.action;
            this.container = options.container;
            this.emitter = options.emitter;
            this.target = options.target;
            this.text = options.text;
            this.trigger = options.trigger;

            this.selectedText = '';
        }

        /**
         * Decides which selection strategy is going to be applied based
         * on the existence of `text` and `target` properties.
         */

    }, {
        key: 'initSelection',
        value: function initSelection() {
            if (this.text) {
                this.selectFake();
            } else if (this.target) {
                this.selectTarget();
            }
        }

        /**
         * Creates a fake textarea element, sets its value from `text` property,
         * and makes a selection on it.
         */

    }, {
        key: 'selectFake',
        value: function selectFake() {
            var _this = this;

            var isRTL = document.documentElement.getAttribute('dir') == 'rtl';

            this.removeFake();

            this.fakeHandlerCallback = function () {
                return _this.removeFake();
            };
            this.fakeHandler = this.container.addEventListener('click', this.fakeHandlerCallback) || true;

            this.fakeElem = document.createElement('textarea');
            // Prevent zooming on iOS
            this.fakeElem.style.fontSize = '12pt';
            // Reset box model
            this.fakeElem.style.border = '0';
            this.fakeElem.style.padding = '0';
            this.fakeElem.style.margin = '0';
            // Move element out of screen horizontally
            this.fakeElem.style.position = 'absolute';
            this.fakeElem.style[isRTL ? 'right' : 'left'] = '-9999px';
            // Move element to the same position vertically
            var yPosition = window.pageYOffset || document.documentElement.scrollTop;
            this.fakeElem.style.top = yPosition + 'px';

            this.fakeElem.setAttribute('readonly', '');
            this.fakeElem.value = this.text;

            this.container.appendChild(this.fakeElem);

            this.selectedText = select_default()(this.fakeElem);
            this.copyText();
        }

        /**
         * Only removes the fake element after another click event, that way
         * a user can hit `Ctrl+C` to copy because selection still exists.
         */

    }, {
        key: 'removeFake',
        value: function removeFake() {
            if (this.fakeHandler) {
                this.container.removeEventListener('click', this.fakeHandlerCallback);
                this.fakeHandler = null;
                this.fakeHandlerCallback = null;
            }

            if (this.fakeElem) {
                this.container.removeChild(this.fakeElem);
                this.fakeElem = null;
            }
        }

        /**
         * Selects the content from element passed on `target` property.
         */

    }, {
        key: 'selectTarget',
        value: function selectTarget() {
            this.selectedText = select_default()(this.target);
            this.copyText();
        }

        /**
         * Executes the copy operation based on the current selection.
         */

    }, {
        key: 'copyText',
        value: function copyText() {
            var succeeded = void 0;

            try {
                succeeded = document.execCommand(this.action);
            } catch (err) {
                succeeded = false;
            }

            this.handleResult(succeeded);
        }

        /**
         * Fires an event based on the copy operation result.
         * @param {Boolean} succeeded
         */

    }, {
        key: 'handleResult',
        value: function handleResult(succeeded) {
            this.emitter.emit(succeeded ? 'success' : 'error', {
                action: this.action,
                text: this.selectedText,
                trigger: this.trigger,
                clearSelection: this.clearSelection.bind(this)
            });
        }

        /**
         * Moves focus away from `target` and back to the trigger, removes current selection.
         */

    }, {
        key: 'clearSelection',
        value: function clearSelection() {
            if (this.trigger) {
                this.trigger.focus();
            }
            document.activeElement.blur();
            window.getSelection().removeAllRanges();
        }

        /**
         * Sets the `action` to be performed which can be either 'copy' or 'cut'.
         * @param {String} action
         */

    }, {
        key: 'destroy',


        /**
         * Destroy lifecycle.
         */
        value: function destroy() {
            this.removeFake();
        }
    }, {
        key: 'action',
        set: function set() {
            var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'copy';

            this._action = action;

            if (this._action !== 'copy' && this._action !== 'cut') {
                throw new Error('Invalid "action" value, use either "copy" or "cut"');
            }
        }

        /**
         * Gets the `action` property.
         * @return {String}
         */
        ,
        get: function get() {
            return this._action;
        }

        /**
         * Sets the `target` property using an element
         * that will be have its content copied.
         * @param {Element} target
         */

    }, {
        key: 'target',
        set: function set(target) {
            if (target !== undefined) {
                if (target && (typeof target === 'undefined' ? 'undefined' : _typeof(target)) === 'object' && target.nodeType === 1) {
                    if (this.action === 'copy' && target.hasAttribute('disabled')) {
                        throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');
                    }

                    if (this.action === 'cut' && (target.hasAttribute('readonly') || target.hasAttribute('disabled'))) {
                        throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');
                    }

                    this._target = target;
                } else {
                    throw new Error('Invalid "target" value, use a valid Element');
                }
            }
        }

        /**
         * Gets the `target` property.
         * @return {String|HTMLElement}
         */
        ,
        get: function get() {
            return this._target;
        }
    }]);

    return ClipboardAction;
}();

/* harmony default export */ var clipboard_action = (clipboard_action_ClipboardAction);
// EXTERNAL MODULE: ./node_modules/tiny-emitter/index.js
var tiny_emitter = __webpack_require__(1);
var tiny_emitter_default = /*#__PURE__*/__webpack_require__.n(tiny_emitter);

// EXTERNAL MODULE: ./node_modules/good-listener/src/listen.js
var listen = __webpack_require__(2);
var listen_default = /*#__PURE__*/__webpack_require__.n(listen);

// CONCATENATED MODULE: ./src/clipboard.js
var clipboard_typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var clipboard_createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function clipboard_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }





/**
 * Base class which takes one or more elements, adds event listeners to them,
 * and instantiates a new `ClipboardAction` on each click.
 */

var clipboard_Clipboard = function (_Emitter) {
    _inherits(Clipboard, _Emitter);

    /**
     * @param {String|HTMLElement|HTMLCollection|NodeList} trigger
     * @param {Object} options
     */
    function Clipboard(trigger, options) {
        clipboard_classCallCheck(this, Clipboard);

        var _this = _possibleConstructorReturn(this, (Clipboard.__proto__ || Object.getPrototypeOf(Clipboard)).call(this));

        _this.resolveOptions(options);
        _this.listenClick(trigger);
        return _this;
    }

    /**
     * Defines if attributes would be resolved using internal setter functions
     * or custom functions that were passed in the constructor.
     * @param {Object} options
     */


    clipboard_createClass(Clipboard, [{
        key: 'resolveOptions',
        value: function resolveOptions() {
            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

            this.action = typeof options.action === 'function' ? options.action : this.defaultAction;
            this.target = typeof options.target === 'function' ? options.target : this.defaultTarget;
            this.text = typeof options.text === 'function' ? options.text : this.defaultText;
            this.container = clipboard_typeof(options.container) === 'object' ? options.container : document.body;
        }

        /**
         * Adds a click event listener to the passed trigger.
         * @param {String|HTMLElement|HTMLCollection|NodeList} trigger
         */

    }, {
        key: 'listenClick',
        value: function listenClick(trigger) {
            var _this2 = this;

            this.listener = listen_default()(trigger, 'click', function (e) {
                return _this2.onClick(e);
            });
        }

        /**
         * Defines a new `ClipboardAction` on each click event.
         * @param {Event} e
         */

    }, {
        key: 'onClick',
        value: function onClick(e) {
            var trigger = e.delegateTarget || e.currentTarget;

            if (this.clipboardAction) {
                this.clipboardAction = null;
            }

            this.clipboardAction = new clipboard_action({
                action: this.action(trigger),
                target: this.target(trigger),
                text: this.text(trigger),
                container: this.container,
                trigger: trigger,
                emitter: this
            });
        }

        /**
         * Default `action` lookup function.
         * @param {Element} trigger
         */

    }, {
        key: 'defaultAction',
        value: function defaultAction(trigger) {
            return getAttributeValue('action', trigger);
        }

        /**
         * Default `target` lookup function.
         * @param {Element} trigger
         */

    }, {
        key: 'defaultTarget',
        value: function defaultTarget(trigger) {
            var selector = getAttributeValue('target', trigger);

            if (selector) {
                return document.querySelector(selector);
            }
        }

        /**
         * Returns the support of the given action, or all actions if no action is
         * given.
         * @param {String} [action]
         */

    }, {
        key: 'defaultText',


        /**
         * Default `text` lookup function.
         * @param {Element} trigger
         */
        value: function defaultText(trigger) {
            return getAttributeValue('text', trigger);
        }

        /**
         * Destroy lifecycle.
         */

    }, {
        key: 'destroy',
        value: function destroy() {
            this.listener.destroy();

            if (this.clipboardAction) {
                this.clipboardAction.destroy();
                this.clipboardAction = null;
            }
        }
    }], [{
        key: 'isSupported',
        value: function isSupported() {
            var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ['copy', 'cut'];

            var actions = typeof action === 'string' ? [action] : action;
            var support = !!document.queryCommandSupported;

            actions.forEach(function (action) {
                support = support && !!document.queryCommandSupported(action);
            });

            return support;
        }
    }]);

    return Clipboard;
}(tiny_emitter_default.a);

/**
 * Helper function to retrieve attribute value.
 * @param {String} suffix
 * @param {Element} element
 */


function getAttributeValue(suffix, element) {
    var attribute = 'data-clipboard-' + suffix;

    if (!element.hasAttribute(attribute)) {
        return;
    }

    return element.getAttribute(attribute);
}

/* harmony default export */ var clipboard = __webpack_exports__["default"] = (clipboard_Clipboard);

/***/ })
/******/ ])["default"];
});
</script>
<!-- Foldable TOC -->

<style>
    #tocbot a.toc-link.node-name--H1{ font-style: italic }
    @media screen{
      #tocbot > ul.toc-list{ margin-bottom: 0.5em; margin-left: 0.125em }
      #tocbot ul.sectlevel0, #tocbot a.toc-link.node-name--H1 + ul{
        padding-left: 0 }
      #tocbot a.toc-link{ height:100% }
      .is-collapsible{ max-height:3000px; overflow:hidden; }
      .is-collapsed{ max-height:0 }
      .is-active-link{ font-weight:700 }
    }
    @media print{
      #tocbot a.toc-link.node-name--H4{ display:none }
    }
</style>

<!-- Copy to clipboard button in sourc code listings -->

<style>
 .listingblock:hover .clipboard {
     display: block;
 }

 .clipboard {
     display: none;
     border: 0;
     font-size: .75em;
     text-transform: uppercase;
     font-weight: 500;
     padding: 6px;
     color: #999;
     position: absolute;
     top: .425rem;
     right: .5rem;
     background: transparent;
 }

 code + .clipboard {
    top: -0.05rem !important;
     right: 3rem !important;
 }

 .clipboard:hover, .clipboard:focus, .clipboard:active {
     outline: 0;
     background-color: #eee9e6;
 }
</style>
<script>
$(function() {

var pre = document.getElementsByTagName('pre');
for (var i = 0; i < pre.length; i++) {
    var b = document.createElement('input');
    b.setAttribute('role', 'button');
    b.setAttribute('type', 'button');
    b.value = 'Copy';
    b.className = 'clipboard';

    if (pre[i].childNodes.length === 1 && pre[i].childNodes[0].nodeType === 3) {
        var div = document.createElement('div');
        div.textContent = pre[i].textContent;
        pre[i].textContent = '';
        pre[i].appendChild(div);
    }
    pre[i].appendChild(b);
 }

new ClipboardJS('.clipboard', {
    text: function(b) {
        return b.parentNode.innerText;
    }
}).on('success', function(e) {
        e.clearSelection();
        e.trigger.value = 'Copied';
        setTimeout(function() {
            e.trigger.value = 'Copy';
        }, 2000);
    });
});
</script>
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>picocli - a mighty tiny command line interface</h1>
<div class="details">
<span id="revnumber">version 4.6.2,</span>
<span id="revdate">2021-11-05</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Features</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_overview">1.1. Overview</a></li>
<li><a href="#_example_application">1.2. Example application</a></li>
</ul>
</li>
<li><a href="#_getting_started">2. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_add_as_external_dependency">2.1. Add as External Dependency</a></li>
<li><a href="#_add_as_source">2.2. Add as Source</a></li>
<li><a href="#_annotation_processor">2.3. Annotation Processor</a></li>
<li><a href="#_running_the_application">2.4. Running the Application</a></li>
</ul>
</li>
<li><a href="#_options_and_parameters">3. Options and Parameters</a>
<ul class="sectlevel2">
<li><a href="#_options">3.1. Options</a></li>
<li><a href="#_interactive_password_options">3.2. Interactive (Password) Options</a></li>
<li><a href="#_short_posix_options">3.3. Short (POSIX) Options</a></li>
<li><a href="#_boolean_options">3.4. Boolean Options</a></li>
<li><a href="#_negatable_options">3.5. Negatable Options</a></li>
<li><a href="#_positional_parameters">3.6. Positional Parameters</a></li>
<li><a href="#_mixing_options_and_positional_parameters">3.7. Mixing Options and Positional Parameters</a></li>
<li><a href="#_double_dash">3.8. Double dash (<code>--</code>)</a></li>
<li><a href="#AtFiles">3.9. @-files</a></li>
</ul>
</li>
<li><a href="#_strongly_typed_everything">4. Strongly Typed Everything</a>
<ul class="sectlevel2">
<li><a href="#_built_in_types">4.1. Built-in Types</a></li>
<li><a href="#_custom_type_converters">4.2. Custom Type Converters</a></li>
<li><a href="#_handling_invalid_input">4.3. Handling Invalid Input</a></li>
<li><a href="#_option_specific_type_converters">4.4. Option-specific Type Converters</a></li>
<li><a href="#_arrays_collections_maps">4.5. Arrays, Collections, Maps</a></li>
<li><a href="#_optionalt">4.6. Optional&lt;T&gt;</a></li>
<li><a href="#_abstract_field_types">4.7. Abstract Field Types</a></li>
<li><a href="#_enum_types">4.8. Enum Types</a></li>
</ul>
</li>
<li><a href="#_default_values">5. Default Values</a>
<ul class="sectlevel2">
<li><a href="#defaultValue-annotation">5.1. <code>defaultValue</code> Annotation</a></li>
<li><a href="#_field_values">5.2. Field Values</a></li>
<li><a href="#_default_provider">5.3. Default Provider</a></li>
<li><a href="#_propertiesdefaultprovider">5.4. PropertiesDefaultProvider</a></li>
<li><a href="#fallbackValue-annotation">5.5. <code>fallbackValue</code> Annotation</a></li>
<li><a href="#_was_a_value_defaulted">5.6. Was a Value Defaulted?</a></li>
</ul>
</li>
<li><a href="#_multiple_values">6. Multiple Values</a>
<ul class="sectlevel2">
<li><a href="#_multiple_occurrences">6.1. Multiple Occurrences</a></li>
<li><a href="#_split_regex">6.2. Split Regex</a></li>
<li><a href="#_arity">6.3. Arity</a></li>
<li><a href="#_variable_arity_limitations">6.4. Variable Arity Limitations</a></li>
<li><a href="#_default_arity">6.5. Default Arity</a></li>
<li><a href="#_optional_values">6.6. Optional Values</a></li>
</ul>
</li>
<li><a href="#_required_arguments">7. Required Arguments</a>
<ul class="sectlevel2">
<li><a href="#_required_options">7.1. Required Options</a></li>
<li><a href="#_required_parameters">7.2. Required Parameters</a></li>
<li><a href="#_options_with_an_optional_parameter">7.3. Options with an Optional Parameter</a></li>
</ul>
</li>
<li><a href="#_argument_groups">8. Argument Groups</a>
<ul class="sectlevel2">
<li><a href="#_mutually_exclusive_options">8.1. Mutually Exclusive Options</a></li>
<li><a href="#_mutually_dependent_options">8.2. Mutually Dependent Options</a></li>
<li><a href="#_option_sections_in_usage_help">8.3. Option Sections in Usage Help</a></li>
<li><a href="#_repeating_composite_argument_groups">8.4. Repeating Composite Argument Groups</a></li>
<li><a href="#_default_values_in_argument_groups">8.5. Default Values in Argument Groups</a></li>
<li><a href="#_positional_parameters_2">8.6. Positional Parameters</a></li>
<li><a href="#_argument_group_limitations">8.7. Argument Group Limitations</a></li>
</ul>
</li>
<li><a href="#execute">9. Executing Commands</a>
<ul class="sectlevel2">
<li><a href="#_exit_code">9.1. Exit Code</a></li>
<li><a href="#_generating_an_exit_code">9.2. Generating an Exit Code</a></li>
<li><a href="#_exception_exit_codes">9.3. Exception Exit Codes</a></li>
<li><a href="#_usage_help_exit_code_section">9.4. Usage Help Exit Code Section</a></li>
<li><a href="#_execution_configuration">9.5. Execution Configuration</a></li>
<li><a href="#_migration">9.6. Migration</a></li>
<li><a href="#_diy_command_execution">9.7. DIY Command Execution</a></li>
<li><a href="#_handling_errors">9.8. Handling Errors</a></li>
</ul>
</li>
<li><a href="#_validation">10. Validation</a>
<ul class="sectlevel2">
<li><a href="#_built_in_validation">10.1. Built-in Validation</a></li>
<li><a href="#_custom_validation">10.2. Custom Validation</a></li>
</ul>
</li>
<li><a href="#_parser_configuration">11. Parser Configuration</a>
<ul class="sectlevel2">
<li><a href="#_case_sensitivity">11.1. Case Sensitivity</a></li>
<li><a href="#_abbreviated_options_and_subcommands">11.2. Abbreviated Options and Subcommands</a></li>
<li><a href="#_overwriting_single_options">11.3. Overwriting Single Options</a></li>
<li><a href="#_stop_at_positional">11.4. Stop At Positional</a></li>
<li><a href="#_stop_at_unmatched">11.5. Stop At Unmatched</a></li>
<li><a href="#_unmatched_input">11.6. Unmatched Input</a></li>
<li><a href="#unmatched-annotation">11.7. <code>@Unmatched</code> annotation</a></li>
<li><a href="#_unknown_options">11.8. Unknown Options</a></li>
<li><a href="#_option_names_as_option_values">11.9. Option Names as Option Values</a></li>
<li><a href="#_toggle_boolean_flags">11.10. Toggle Boolean Flags</a></li>
<li><a href="#_posix_clustered_short_options">11.11. POSIX Clustered Short Options</a></li>
<li><a href="#_lenient_mode">11.12. Lenient Mode</a></li>
<li><a href="#_quoted_values">11.13. Quoted Values</a></li>
<li><a href="#_customizing_negatable_options">11.14. Customizing Negatable Options</a></li>
<li><a href="#_custom_parameter_processing">11.15. Custom Parameter Processing</a></li>
</ul>
</li>
<li><a href="#_help">12. Help</a>
<ul class="sectlevel2">
<li><a href="#_help_options">12.1. Help Options</a></li>
<li><a href="#_mixin_standard_help_options">12.2. Mixin Standard Help Options</a></li>
<li><a href="#_built_in_help_subcommand">12.3. Built-in Help Subcommand</a></li>
<li><a href="#_custom_help_subcommands">12.4. Custom Help Subcommands</a></li>
<li><a href="#_printing_help_automatically">12.5. Printing Help Automatically</a></li>
</ul>
</li>
<li><a href="#_version_help">13. Version Help</a>
<ul class="sectlevel2">
<li><a href="#_static_version_information">13.1. Static Version Information</a></li>
<li><a href="#_dynamic_version_information">13.2. Dynamic Version Information</a></li>
</ul>
</li>
<li><a href="#_usage_help">14. Usage Help</a>
<ul class="sectlevel2">
<li><a href="#_compact_example">14.1. Compact Example</a></li>
<li><a href="#_command_name">14.2. Command Name</a></li>
<li><a href="#_parameter_labels">14.3. Parameter Labels</a></li>
<li><a href="#_option_list">14.4. Option List</a></li>
<li><a href="#_usage_width">14.5. Usage Width</a></li>
<li><a href="#_auto_terminal_width">14.6. Auto (Terminal) Width</a></li>
<li><a href="#_split_synopsis_label">14.7. Split Synopsis Label</a></li>
<li><a href="#_abbreviated_synopsis">14.8. Abbreviated Synopsis</a></li>
<li><a href="#_custom_synopsis">14.9. Custom Synopsis</a></li>
<li><a href="#_synopsis_subcommand_label">14.10. Synopsis Subcommand Label</a></li>
<li><a href="#_header_and_footer">14.11. Header and Footer</a></li>
<li><a href="#_exit_code_list">14.12. Exit Code List</a></li>
<li><a href="#_format_specifiers">14.13. Format Specifiers</a></li>
<li><a href="#_section_headings">14.14. Section Headings</a></li>
<li><a href="#_expanded_example">14.15. Expanded Example</a></li>
<li><a href="#_option_parameter_separators">14.16. Option-Parameter Separators</a></li>
<li><a href="#_hidden_options_and_parameters">14.17. Hidden Options and Parameters</a></li>
<li><a href="#_show_at_files">14.18. Show At Files</a></li>
<li><a href="#_show_end_of_options">14.19. Show End of Options</a></li>
<li><a href="#_show_default_values">14.20. Show Default Values</a></li>
</ul>
</li>
<li><a href="#_ansi_colors_and_styles">15. ANSI Colors and Styles</a>
<ul class="sectlevel2">
<li><a href="#_colorized_example">15.1. Colorized Example</a></li>
<li><a href="#_usage_help_with_styles_and_colors">15.2. Usage Help with Styles and Colors</a></li>
<li><a href="#_styles_and_colors_in_application_output">15.3. Styles and Colors in Application Output</a></li>
<li><a href="#_more_colors">15.4. More Colors</a></li>
<li><a href="#_configuring_fixed_elements">15.5. Configuring Fixed Elements</a></li>
<li><a href="#_supported_platforms">15.6. Supported Platforms</a></li>
<li><a href="#_forcing_ansi_onoff">15.7. Forcing ANSI On/Off</a></li>
<li><a href="#_heuristics_for_enabling_ansi">15.8. Heuristics for Enabling ANSI</a></li>
</ul>
</li>
<li><a href="#_usage_help_api">16. Usage Help API</a>
<ul class="sectlevel2">
<li><a href="#_reordering_sections">16.1. Reordering Sections</a></li>
<li><a href="#_custom_layout">16.2. Custom Layout</a></li>
</ul>
</li>
<li><a href="#_subcommands">17. Subcommands</a>
<ul class="sectlevel2">
<li><a href="#_subcommand_examples">17.1. Subcommand Examples</a></li>
<li><a href="#_registering_subcommands_declaratively">17.2. Registering Subcommands Declaratively</a></li>
<li><a href="#_subcommands_as_methods">17.3. Subcommands as Methods</a></li>
<li><a href="#_registering_subcommands_programmatically">17.4. Registering Subcommands Programmatically</a></li>
<li><a href="#_executing_subcommands">17.5. Executing Subcommands</a></li>
<li><a href="#_initialization_before_execution">17.6. Initialization Before Execution</a></li>
<li><a href="#parentcommand-annotation">17.7. <code>@ParentCommand</code> Annotation</a></li>
<li><a href="#_subcommand_aliases">17.8. Subcommand Aliases</a></li>
<li><a href="#_inherited_command_attributes">17.9. Inherited Command Attributes</a></li>
<li><a href="#_inherited_options">17.10. Inherited Options</a></li>
<li><a href="#_manually_parsing_subcommands">17.11. Manually Parsing Subcommands</a></li>
<li><a href="#_nested_sub_subcommands">17.12. Nested sub-Subcommands</a></li>
<li><a href="#_repeatable_subcommands">17.13. Repeatable Subcommands</a></li>
<li><a href="#_usage_help_for_subcommands">17.14. Usage Help for Subcommands</a></li>
<li><a href="#_hidden_subcommands">17.15. Hidden Subcommands</a></li>
<li><a href="#_help_subcommands">17.16. Help Subcommands</a></li>
<li><a href="#_required_subcommands">17.17. Required Subcommands</a></li>
<li><a href="#_subcommands_and_default_values">17.18. Subcommands and default values</a></li>
</ul>
</li>
<li><a href="#_reuse">18. Reuse</a>
<ul class="sectlevel2">
<li><a href="#_subclassing">18.1. Subclassing</a></li>
<li><a href="#_mixins">18.2. Mixins</a></li>
<li><a href="#_inherited_scope">18.3. Inherited Scope</a></li>
<li><a href="#_use_case_configure_log_level_with_a_global_option">18.4. Use Case: Configure Log Level with a Global Option</a></li>
<li><a href="#_sharing_options_in_subcommands">18.5. Sharing Options in Subcommands</a></li>
<li><a href="#_reuse_combinations">18.6. Reuse Combinations</a></li>
</ul>
</li>
<li><a href="#_internationalization">19. Internationalization</a>
<ul class="sectlevel2">
<li><a href="#_configuration">19.1. Configuration</a></li>
<li><a href="#_example_resource_bundle">19.2. Example Resource Bundle</a></li>
<li><a href="#_shared_resource_bundles">19.3. Shared Resource Bundles</a></li>
<li><a href="#_localizing_the_built_in_help">19.4. Localizing the Built-In Help</a></li>
<li><a href="#_localizing_default_values">19.5. Localizing Default Values</a></li>
<li><a href="#_controlling_the_locale">19.6. Controlling the locale</a></li>
</ul>
</li>
<li><a href="#_variable_interpolation">20. Variable Interpolation</a>
<ul class="sectlevel2">
<li><a href="#_variable_interpolation_example">20.1. Variable Interpolation Example</a></li>
<li><a href="#_predefined_variables">20.2. Predefined Variables</a></li>
<li><a href="#_custom_variables">20.3. Custom Variables</a></li>
<li><a href="#_default_values_for_custom_variables">20.4. Default Values for Custom Variables</a></li>
<li><a href="#_escaping_variables">20.5. Escaping Variables</a></li>
<li><a href="#_switching_off_variable_interpolation">20.6. Switching Off Variable Interpolation</a></li>
<li><a href="#_limitations_of_variable_interpolation">20.7. Limitations of Variable Interpolation</a></li>
</ul>
</li>
<li><a href="#_tips_tricks">21. Tips &amp; Tricks</a>
<ul class="sectlevel2">
<li><a href="#_programmatic_api">21.1. Programmatic API</a></li>
<li><a href="#option-parameters-methods">21.2. <code>@Option</code> and <code>@Parameters</code> Methods</a></li>
<li><a href="#command-methods">21.3.  <code>@Command</code> Methods</a></li>
<li><a href="#spec-annotation">21.4.  <code>@Spec</code> Annotation</a></li>
<li><a href="#_custom_factory">21.5. Custom Factory</a></li>
<li><a href="#_model_transformations">21.6. Model Transformations</a></li>
<li><a href="#_automatic_parameter_indexes">21.7. Automatic Parameter Indexes</a></li>
<li><a href="#_improved_support_for_chinese_japanese_and_korean">21.8. Improved Support for Chinese, Japanese and Korean</a></li>
<li><a href="#_boolean_options_with_parameters">21.9. Boolean Options with Parameters</a></li>
<li><a href="#_hexadecimal_values">21.10. Hexadecimal Values</a></li>
<li><a href="#_option_parameter_separators_2">21.11. Option-Parameter Separators</a></li>
<li><a href="#_best_practices_for_command_line_interfaces">21.12. Best Practices for Command Line Interfaces</a></li>
<li><a href="#_text_blocks_for_java_15">21.13. Text Blocks for Java 15</a></li>
</ul>
</li>
<li><a href="#_dependency_injection">22. Dependency Injection</a>
<ul class="sectlevel2">
<li><a href="#_guice_example">22.1. Guice Example</a></li>
<li><a href="#_spring_boot_example">22.2. Spring Boot Example</a></li>
<li><a href="#_micronaut_example">22.3. Micronaut Example</a></li>
<li><a href="#_quarkus_example">22.4. Quarkus Example</a></li>
<li><a href="#_cdi_2_0_jsr_365">22.5. CDI 2.0 (JSR 365)</a></li>
</ul>
</li>
<li><a href="#_java_9_jpms_modules">23. Java 9 JPMS Modules</a>
<ul class="sectlevel2">
<li><a href="#_module_configuration">23.1. Module Configuration</a></li>
</ul>
</li>
<li><a href="#_osgi_bundle">24. OSGi Bundle</a></li>
<li><a href="#_tracing">25. Tracing</a></li>
<li><a href="#_tab_autocomplete">26. TAB Autocomplete</a></li>
<li><a href="#_generate_man_page_documentation">27. Generate Man Page Documentation</a></li>
<li><a href="#_testing_your_application">28. Testing Your Application</a>
<ul class="sectlevel2">
<li><a href="#_black_box_and_white_box_testing">28.1. Black Box and White Box Testing</a></li>
<li><a href="#_testing_the_output">28.2. Testing the Output</a></li>
<li><a href="#_testing_the_exit_code">28.3. Testing the Exit Code</a></li>
<li><a href="#_testing_environment_variables">28.4. Testing Environment Variables</a></li>
<li><a href="#_mocking">28.5. Mocking</a></li>
</ul>
</li>
<li><a href="#_packaging_your_application">29. Packaging Your Application</a>
<ul class="sectlevel2">
<li><a href="#_alias">29.1. Alias</a></li>
<li><a href="#_launcher_script">29.2.  Launcher Script</a></li>
<li><a href="#_graalvm_native_image">29.3. GraalVM Native Image</a></li>
<li><a href="#_really_executable_jar">29.4. Really Executable JAR</a></li>
<li><a href="#_launch4j">29.5. launch4j</a></li>
<li><a href="#_javapackager_java_8">29.6. javapackager (Java 8)</a></li>
<li><a href="#_jlink_java_9">29.7. jlink (Java 9+)</a></li>
<li><a href="#_jpackage">29.8. jpackage</a></li>
<li><a href="#_jbang">29.9. jbang</a></li>
<li><a href="#_jreleaser">29.10. JReleaser</a></li>
</ul>
</li>
<li><a href="#_picocli_in_other_languages">30. Picocli in Other Languages</a>
<ul class="sectlevel2">
<li><a href="#_groovy">30.1. Groovy</a></li>
<li><a href="#_kotlin">30.2. Kotlin</a></li>
<li><a href="#_scala">30.3. Scala</a></li>
</ul>
</li>
<li><a href="#_api_javadoc">31. API Javadoc</a></li>
<li><a href="#_github_project">32. GitHub Project</a></li>
<li><a href="#_issue_tracker">33. Issue Tracker</a></li>
<li><a href="#_mailing_list">34. Mailing List</a></li>
<li><a href="#_license">35. License</a></li>
<li><a href="#_releases">36. Releases</a></li>
<li><a href="#_download">37. Download</a>
<ul class="sectlevel2">
<li><a href="#_build_tools">37.1. Build tools</a></li>
<li><a href="#_source">37.2. Source</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock right">
<div class="content">
<a class="image" href="https://github.com/remkop/picocli"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
</div>
</div>
<iframe src="https://ghbtns.com/github-btn.html?user=remkop&repo=picocli&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px" style="float:right"></iframe>
<div class="quoteblock">
<blockquote>
Every main method deserves picocli!
</blockquote>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/logo/horizontal.png" alt="picocli the Mighty Tiny Command Line Interface" width="800"></span></p>
</div>
<div class="paragraph">
<p>The user manual for the latest release is at <a href="http://picocli.info" class="bare">http://picocli.info</a>.
For the busy and impatient: there is also a <a href="quick-guide.html">Quick Guide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli aims to be the easiest way to create rich command line applications that can run on and off the JVM.
Considering picocli?
Check <a href="https://github.com/remkop/picocli/wiki/Feedback-from-Users">what happy users say</a> about picocli.</p>
</div>
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>1.1. Overview</h3>
<div class="paragraph">
<p>Picocli is a one-file framework for creating Java command line applications with almost zero code.
It supports a variety of command line syntax styles including POSIX, GNU, MS-DOS and more. It generates highly customizable usage help messages that use <a href="#_ansi_colors_and_styles">ANSI colors and styles</a> to contrast important elements and reduce the cognitive load on the user.</p>
</div>
<div class="paragraph">
<p>Picocli-based applications can have <a href="autocomplete.html">command line TAB completion</a> showing available options, option parameters and subcommands, for any level of nested subcommands.
Picocli-based applications can be ahead-of-time compiled to a <span class="image"><img src="https://www.graalvm.org/resources/img/logo-colored.svg" alt="GraalVM"></span>
<a href="#_graalvm_native_image">native image</a>, with extremely fast startup time and lower memory requirements, which can be distributed as a single executable file.</p>
</div>
<div class="paragraph">
<p>Picocli <a href="#_generate_man_page_documentation">generates beautiful documentation</a> for your application (HTML, PDF and Unix man pages).</p>
</div>
<div class="paragraph">
<div class="title">An example usage help message with ANSI colors and styles</div>
<p><span class="image"><img src="images/checksum-usage-help.png" alt="Screenshot of usage help with Ansi codes enabled"></span></p>
</div>
<div class="paragraph">
<p>Another distinguishing feature of picocli is how it aims to let users run picocli-based applications without requiring picocli as an external dependency:
all the source code lives in a single file, to encourage application authors to include it <em>in source form</em>.</p>
</div>
<div class="paragraph">
<p>Picocli makes it easy to follow <a href="https://clig.dev/#guidelines">Command Line Interface Guidelines</a>.</p>
</div>
<div class="paragraph">
<p>How it works: annotate your class and picocli initializes it from the command line arguments, converting the input to strongly typed values in the fields of your class.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Picocli also provides a <a href="#_programmatic_api">programmatic API</a>, separately from the annotations API.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_example_application"><a class="anchor" href="#_example_application"></a>1.2. Example application</h3>
<div class="paragraph">
<p>The example below shows a short but fully functional picocli-based <code>checksum</code> command line application.</p>
</div>
<div id="CheckSum-application" class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Command</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Option</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Parameters</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"checksum"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"checksum 4.0"</span><span class="o">,</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s">"Prints the checksum (MD5 by default) of a file to STDOUT."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">CheckSum</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"The file whose checksum to calculate."</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-a"</span><span class="o">,</span> <span class="s">"--algorithm"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"MD5, SHA-1, SHA-256, ..."</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">"MD5"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span> <span class="c1">// your business logic goes here...</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">fileContents</span> <span class="o">=</span> <span class="nc">Files</span><span class="o">.</span><span class="na">readAllBytes</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">toPath</span><span class="o">());</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">digest</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">algorithm</span><span class="o">).</span><span class="na">digest</span><span class="o">(</span><span class="n">fileContents</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%0"</span> <span class="o">+</span> <span class="o">(</span><span class="n">digest</span><span class="o">.</span><span class="na">length</span><span class="o">*</span><span class="mi">2</span><span class="o">)</span> <span class="o">+</span> <span class="s">"x%n"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">BigInteger</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">digest</span><span class="o">));</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// this example implements Callable, so parsing, error handling and handling user</span>
    <span class="c1">// requests for usage help or version help can be done with one line of code.</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">CheckSum</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div id="CheckSum-App-Groovy" class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Grab</span><span class="o">(</span><span class="s1">'info.picocli:picocli-groovy:4.6.2'</span><span class="o">)</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.*</span>

<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'checksum'</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s1">'checksum 4.0'</span><span class="o">,</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s1">'Prints the checksum (MD5 by default) of a file to STDOUT.'</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Checksum</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">'0'</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">'The file whose checksum to calculate.'</span><span class="o">)</span>
    <span class="n">File</span> <span class="n">file</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'-a'</span><span class="o">,</span> <span class="s1">'--algorithm'</span><span class="o">],</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">'MD5, SHA-1, SHA-256, ...'</span><span class="o">)</span>
    <span class="n">String</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">'MD5'</span>

    <span class="n">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">println</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">algorithm</span><span class="o">).</span><span class="na">digest</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">bytes</span><span class="o">).</span><span class="na">encodeHex</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span>
        <span class="mi">0</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="n">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="n">Checksum</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">))</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div id="CheckSum-App-Groovy-Script" class="listingblock secondary">
<div class="title">Groovy script</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Grab</span><span class="o">(</span><span class="s1">'info.picocli:picocli-groovy:4.6.2'</span><span class="o">)</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.*</span>
<span class="kn">import</span> <span class="nn">groovy.transform.Field</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'checksum'</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s1">'checksum 4.0'</span><span class="o">,</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s1">'Prints the checksum (MD5 by default) of a file to STDOUT.'</span><span class="o">)</span>
<span class="nd">@picocli.groovy.PicocliScript</span>

<span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">'0'</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">'The file whose checksum to calculate.'</span><span class="o">)</span>
<span class="nd">@Field</span> <span class="n">File</span> <span class="n">file</span>

<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'-a'</span><span class="o">,</span> <span class="s1">'--algorithm'</span><span class="o">],</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">'MD5, SHA-1, SHA-256, ...'</span><span class="o">)</span>
<span class="nd">@Field</span> <span class="n">String</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">'MD5'</span>

<span class="n">println</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">algorithm</span><span class="o">).</span><span class="na">digest</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">bytes</span><span class="o">).</span><span class="na">encodeHex</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span></code></pre>
</div>
</div>
<div id="CheckSum-App-Kotlin" class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Command</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Option</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Parameters</span>

<span class="k">import</span> <span class="nn">java.io.File</span>
<span class="k">import</span> <span class="nn">java.math.BigInteger</span>
<span class="k">import</span> <span class="nn">java.nio.file.Files</span>
<span class="k">import</span> <span class="nn">java.security.MessageDigest</span>
<span class="k">import</span> <span class="nn">java.util.concurrent.Callable</span>
<span class="k">import</span> <span class="nn">kotlin.system.exitProcess</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"checksum"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"checksum 4.0"</span><span class="p">],</span>
    <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Prints the checksum (MD5 by default) of a file to STDOUT."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Checksum</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"The file whose checksum to calculate."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">,</span> <span class="s">"--algorithm"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"MD5, SHA-1, SHA-256, ..."</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">algorithm</span> <span class="p">=</span> <span class="s">"MD5"</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">fileContents</span> <span class="p">=</span> <span class="nc">Files</span><span class="p">.</span><span class="nf">readAllBytes</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="nf">toPath</span><span class="p">())</span>
        <span class="kd">val</span> <span class="py">digest</span> <span class="p">=</span> <span class="nc">MessageDigest</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="n">algorithm</span><span class="p">).</span><span class="nf">digest</span><span class="p">(</span><span class="n">fileContents</span><span class="p">)</span>
        <span class="nf">println</span><span class="p">((</span><span class="s">"%0"</span> <span class="p">+</span> <span class="n">digest</span><span class="p">.</span><span class="n">size</span> <span class="p">*</span> <span class="mi">2</span> <span class="p">+</span> <span class="s">"x"</span><span class="p">).</span><span class="nf">format</span><span class="p">(</span><span class="nc">BigInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">digest</span><span class="p">)))</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">:</span> <span class="nc">Unit</span> <span class="p">=</span> <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Checksum</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span></code></pre>
</div>
</div>
<div id="CheckSum-App-Scala" class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.</span><span class="o">{</span><span class="nc">Command</span><span class="o">,</span> <span class="nc">Option</span><span class="o">,</span> <span class="nc">Parameters</span><span class="o">}</span>

<span class="k">import</span> <span class="nn">java.io.File</span>
<span class="k">import</span> <span class="nn">java.math.BigInteger</span>
<span class="k">import</span> <span class="nn">java.nio.file.Files</span>
<span class="k">import</span> <span class="nn">java.security.MessageDigest</span>
<span class="k">import</span> <span class="nn">java.util.concurrent.Callable</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"checksum"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="k">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"checksum 4.0"</span><span class="o">),</span>
  <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"Prints the checksum (MD5 by default) of a file to STDOUT."</span><span class="o">))</span>
<span class="k">class</span> <span class="nc">Checksum</span> <span class="k">extends</span> <span class="nc">Callable</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>

  <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="k">=</span> <span class="s">"0"</span><span class="o">,</span> <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"The file whose checksum to calculate."</span><span class="o">))</span>
   <span class="k">private</span> <span class="k">var</span> <span class="n">file</span><span class="k">:</span> <span class="kt">File</span> <span class="o">=</span> <span class="kc">null</span>

  <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-a"</span><span class="o">,</span> <span class="s">"--algorithm"</span><span class="o">),</span> <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"MD5, SHA-1, SHA-256, ..."</span><span class="o">))</span>
  <span class="k">private</span> <span class="k">var</span> <span class="n">algorithm</span> <span class="k">=</span> <span class="s">"MD5"</span>

  <span class="k">def</span> <span class="nf">call</span><span class="o">()</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">fileContents</span> <span class="k">=</span> <span class="nv">Files</span><span class="o">.</span><span class="py">readAllBytes</span><span class="o">(</span><span class="nv">file</span><span class="o">.</span><span class="py">toPath</span><span class="o">)</span>
    <span class="k">val</span> <span class="nv">digest</span> <span class="k">=</span> <span class="nv">MessageDigest</span><span class="o">.</span><span class="py">getInstance</span><span class="o">(</span><span class="n">algorithm</span><span class="o">).</span><span class="py">digest</span><span class="o">(</span><span class="n">fileContents</span><span class="o">)</span>
    <span class="nf">println</span><span class="o">((</span><span class="s">"%0"</span> <span class="o">+</span> <span class="nv">digest</span><span class="o">.</span><span class="py">size</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s">"x"</span><span class="o">).</span><span class="py">format</span><span class="o">(</span><span class="k">new</span> <span class="nc">BigInteger</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">digest</span><span class="o">)))</span>
    <span class="mi">0</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Checksum</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">System</span><span class="o">.</span><span class="py">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Checksum</span><span class="o">()).</span><span class="py">execute</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can <a href="https://www.jdoodle.com/embed/v0/2mQM?stdin=1&amp;arg=1" target="_blank" rel="noopener">run this example online</a>.
Try it without arguments, with an option like <code>--help</code> or <code>--version</code>, or with a file name like <code>/usr/bin/java</code> as command line argument.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Implement <code>Runnable</code> or <code>Callable</code> and your command can be <a href="#execute">executed</a> in one line of code.
The example <code>main</code> method calls <code>CommandLine.execute</code> to parse the command line, handle errors, handle requests for usage and version help, and invoke the business logic. Applications can call <code>System.exit</code> with the returned exit code to signal success or failure to their caller.</p>
</div>
<div class="paragraph">
<p>The <a href="#_mixin_standard_help_options">mixinStandardHelpOptions</a> attribute adds <code>--help</code> and <code>--version</code> options to your application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The picocli Quick Guide shows other <a href="https://picocli.info/quick-guide.html#_example_applications">sample applications</a> and explains them in more detail.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>2. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can add picocli as an external dependency to your project, or you can include it as source.</p>
</div>
<div class="sect2">
<h3 id="_add_as_external_dependency"><a class="anchor" href="#_add_as_external_dependency"></a>2.1. Add as External Dependency</h3>
<div class="paragraph">
<p>Below are examples of configuring Gradle or Maven to use picocli as an external dependency in your project:</p>
</div>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">'info.picocli:picocli:4.6.2'</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>info.picocli<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>picocli<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.6.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_as_source"><a class="anchor" href="#_add_as_source"></a>2.2. Add as Source</h3>
<div class="paragraph">
<p>To include as source, get the source code from the <a href="https://github.com/remkop/picocli/blob/master/src/main/java/picocli/CommandLine.java">GitHub file</a>. Copy and paste it into a file called <code>CommandLine.java</code>, add it to your project, and enjoy!</p>
</div>
</div>
<div class="sect2">
<h3 id="_annotation_processor"><a class="anchor" href="#_annotation_processor"></a>2.3. Annotation Processor</h3>
<div class="paragraph">
<p>The <code>picocli-codegen</code> module includes an annotation processor that can build a model from the picocli annotations at compile time rather than at runtime.</p>
</div>
<div class="paragraph">
<p>Enabling this annotation processor in your project is optional, but strongly recommended. Use this if youâre interested in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Compile time error checking</strong>. The annotation processor shows errors for invalid annotations and attributes immediately when you compile, instead of during testing at runtime, resulting in shorter feedback cycles.</p>
</li>
<li>
<p><strong><a href="#_graalvm_native_image">GraalVM native images</a></strong>. The annotation processor generates and updates <a href="https://github.com/oracle/graal/blob/master/substratevm/BuildConfiguration.md">GraalVM configuration</a> files under
<code>META-INF/native-image/picocli-generated/$project</code> during compilation, to be included in the application jar.
This includes configuration files for <a href="https://github.com/oracle/graal/blob/master/substratevm/Reflection.md">reflection</a>, <a href="https://github.com/oracle/graal/blob/master/substratevm/Resources.md">resources</a> and <a href="https://github.com/oracle/graal/blob/master/substratevm/DynamicProxy.md">dynamic proxies</a>.
By embedding these configuration files, your jar is instantly Graal-enabled.
In most cases no further configuration is needed when generating a native image.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_processor_option_project"><a class="anchor" href="#_processor_option_project"></a>2.3.1. Processor option: <code>project</code></h4>
<div class="paragraph">
<p>The picocli annotation processor supports a number of <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen#picocli-processor-options">options</a>, most important of which is the <code>project</code> option to control the output subdirectory: the generated files are written to <code>META-INF/native-image/picocli-generated/${project}</code>. A good convention is to use the Maven <code>${project.groupId}/${project.artifactId}</code> as the value; a unique subdirectory ensures your jar can be shaded with other jars that may also contain generated configuration files.</p>
</div>
<div class="paragraph">
<p>To configure this option, pass the <code>-Aproject=&lt;some value&gt;</code> to the javac compiler. The examples below show how to do this for Maven and Gradle.</p>
</div>
</div>
<div class="sect3">
<h4 id="_enabling_the_annotation_processor"><a class="anchor" href="#_enabling_the_annotation_processor"></a>2.3.2. Enabling the Annotation Processor</h4>
<div class="sect4">
<h5 id="_ide"><a class="anchor" href="#_ide"></a>IDE</h5>
<div class="paragraph">
<p><a href="https://immutables.github.io/apt.html">This page</a> shows the steps to configure Eclipse and IntelliJ IDEA to enable annotation processing.</p>
</div>
</div>
<div class="sect4">
<h5 id="_using_build_tools"><a class="anchor" href="#_using_build_tools"></a>Using Build Tools</h5>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">'info.picocli:picocli:4.6.2'</span>
    <span class="n">annotationProcessor</span> <span class="s1">'info.picocli:picocli-codegen:4.6.2'</span>
<span class="o">}</span>


<span class="n">compileJava</span> <span class="o">{</span>
    <span class="n">options</span><span class="o">.</span><span class="na">compilerArgs</span> <span class="o">+=</span> <span class="o">[</span><span class="s2">"-Aproject=${project.group}/${project.name}"</span><span class="o">]</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="c">&lt;!-- annotationProcessorPaths requires maven-compiler-plugin version 3.5 or higher --&gt;</span>
  <span class="nt">&lt;version&gt;</span>${maven-compiler-plugin-version}<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;annotationProcessorPaths&gt;</span>
      <span class="nt">&lt;path&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>info.picocli<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>picocli-codegen<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>4.6.2<span class="nt">&lt;/version&gt;</span>
      <span class="nt">&lt;/path&gt;</span>
    <span class="nt">&lt;/annotationProcessorPaths&gt;</span>
    <span class="nt">&lt;compilerArgs&gt;</span>
      <span class="nt">&lt;arg&gt;</span>-Aproject=${project.groupId}/${project.artifactId}<span class="nt">&lt;/arg&gt;</span>
    <span class="nt">&lt;/compilerArgs&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen"><code>picocli-codegen</code> README</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kotlin_projects_using_gradle"><a class="anchor" href="#_kotlin_projects_using_gradle"></a>Kotlin Projects Using Gradle</h5>
<div class="paragraph">
<p>Kotlin projects should add the <code>kotlin-kapt</code> plugin to enable the Kotlin Annotation processing tool (<a href="https://kotlinlang.org/docs/reference/kapt.html">kapt</a>),
then replace <code>annotationProcessor</code> with <code>kapt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>apply plugin: 'kotlin-kapt' // required
dependencies {
    // ...
    kapt 'info.picocli:picocli-codegen:4.6.2'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And replace <code>compileJava.options.compilerArgs</code> with <code>kapt.arguments</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>kapt {
    arguments {
        arg("project", "${project.group}/${project.name}")
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen"><code>picocli-codegen</code> README</a> for more details.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_application"><a class="anchor" href="#_running_the_application"></a>2.4. Running the Application</h3>
<div class="paragraph">
<p>After we successfully compiled our <a href="#CheckSum-application">example <code>CheckSum</code> application</a>, let&#8217;s quickly look at how to run it.</p>
</div>
<div class="paragraph">
<p>There are many ways to run picocli-based applications, depending on whether we included picocli as source, created a jar for our application or not, and whether we created a shaded jar (also known as uber-jar) containing all dependencies.</p>
</div>
<div class="paragraph">
<p>Before we run our <code>CheckSum</code> application, let&#8217;s create an example file whose checksum we want to print. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">echo</span> <span class="s2">"hello"</span> <span class="o">&gt;</span> hello.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, assuming we created a jar named <code>checksum.jar</code> containing our compiled <code>CheckSum.class</code>, we can run the application with <code>java -cp &lt;classpath&gt; &lt;MainClass&gt; [OPTIONS]</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java <span class="nt">-cp</span> <span class="s2">"picocli-4.6.2.jar:checksum.jar"</span> CheckSum <span class="nt">--algorithm</span> SHA-1 hello.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may want to package your application in such a way that end users can invoke it with a short command like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">checksum <span class="nt">--algorithm</span> SHA-1 hello.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_packaging_your_application">Packaging Your Application</a> section for ideas on how to accomplish this.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_options_and_parameters"><a class="anchor" href="#_options_and_parameters"></a>3. Options and Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Command line arguments can be separated into <em>options</em>  and <em>positional parameters</em>.
Options have a name, positional parameters are usually the values that follow the options, but they may be mixed.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/OptionsAndParameters2.png" alt="Example command with annotated @Option and @Parameters"></span></p>
</div>
<div class="paragraph">
<p>Picocli has separate annotations for options and positional parameters.</p>
</div>
<div class="sect2">
<h3 id="_options"><a class="anchor" href="#_options"></a>3.1. Options</h3>
<div class="paragraph">
<p>An option must have one or more <code>names</code>.
Picocli lets you use any option name you want.
Option names are case-sensitive by default, but this is <a href="#_case_sensitivity">customizable</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You may be interested in this <a href="http://catb.org/~esr/writings/taoup/html/ch10s05.html#id2948149">list of common option names</a>. Following these conventions may make your application more intuitive to use for experienced users.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The below example shows options with one or more names, options that take an option parameter, and a <a href="#_help_options">help</a> option.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Tar</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"create a new archive"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">create</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-f"</span><span class="o">,</span> <span class="s">"--file"</span> <span class="o">},</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"ARCHIVE"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"the archive file"</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">archive</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"FILE"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"one ore more files to archive"</span><span class="o">)</span>
    <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-h"</span><span class="o">,</span> <span class="s">"--help"</span> <span class="o">},</span> <span class="n">usageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"display a help message"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">helpRequested</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Tar</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"create a new archive"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">create</span><span class="p">:</span> <span class="nc">Boolean</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">,</span> <span class="s">"--file"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"ARCHIVE"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the archive file"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">archive</span><span class="p">:</span> <span class="nc">File</span><span class="p">;</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"FILE"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"one ore more files to archive"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-h"</span><span class="p">,</span> <span class="s">"--help"</span><span class="p">],</span> <span class="n">usageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"display a help message"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">helpRequested</span><span class="p">:</span> <span class="nc">Boolean</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Picocli matches the option names to set the field values.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-c"</span><span class="o">,</span> <span class="s">"--file"</span><span class="o">,</span> <span class="s">"result.tar"</span><span class="o">,</span> <span class="s">"file1.txt"</span><span class="o">,</span> <span class="s">"file2.txt"</span> <span class="o">};</span>
<span class="nc">Tar</span> <span class="n">tar</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Tar</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">tar</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

<span class="k">assert</span> <span class="o">!</span><span class="n">tar</span><span class="o">.</span><span class="na">helpRequested</span><span class="o">;</span>
<span class="k">assert</span>  <span class="n">tar</span><span class="o">.</span><span class="na">create</span><span class="o">;</span>
<span class="k">assert</span>  <span class="n">tar</span><span class="o">.</span><span class="na">archive</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"result.tar"</span><span class="o">));</span>
<span class="k">assert</span>  <span class="nc">Arrays</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">tar</span><span class="o">.</span><span class="na">files</span><span class="o">,</span> <span class="k">new</span> <span class="nc">File</span><span class="o">[]</span> <span class="o">{</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"file1.txt"</span><span class="o">),</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"file2.txt"</span><span class="o">)});</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args1</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"-c"</span><span class="p">,</span> <span class="s">"--file"</span><span class="p">,</span> <span class="s">"result.tar"</span><span class="p">,</span> <span class="s">"file1.txt"</span><span class="p">,</span> <span class="s">"file2.txt"</span><span class="p">)</span>
<span class="kd">var</span> <span class="py">tar</span> <span class="p">=</span> <span class="nc">Tar</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">tar</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args1</span><span class="p">);</span>

<span class="nf">assert</span><span class="p">(!</span><span class="n">tar</span><span class="p">.</span><span class="n">helpRequested</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">tar</span><span class="p">.</span><span class="n">create</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">tar</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="nc">File</span><span class="p">(</span><span class="s">"result.tar"</span><span class="p">)))</span>
<span class="nf">assert</span><span class="p">(</span><span class="nc">Arrays</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">tar</span><span class="p">.</span><span class="n">files</span><span class="p">,</span> <span class="n">arrayOf</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;(</span><span class="nc">File</span><span class="p">(</span><span class="s">"file1.txt"</span><span class="p">),</span> <span class="nc">File</span><span class="p">(</span><span class="s">"file2.txt"</span><span class="p">))))</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interactive_password_options"><a class="anchor" href="#_interactive_password_options"></a>3.2. Interactive (Password) Options</h3>
<div class="paragraph">
<p>Picocli 3.5 introduced password support: for options and positional parameters marked as <code>interactive</code>, the user is prompted to enter a value on the console.
When running on Java 6 or higher, picocli will use the <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Console.html#readPassword-java.lang.String-java.lang.Object&#8230;&#8203;-"><code>Console.readPassword</code></a> API so that user input is not echoed to the console.</p>
</div>
<div class="paragraph">
<p>From picocli 4.6, applications can choose to echo user input to the console by setting <code>echo = true</code>, and set the <code>prompt</code> text to control what is shown on the console when asking the user for input.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Interactive <em>positional parameters</em> have a limitation: they must be followed by a non-interactive positional parameter.
Commands where the <em>last</em> positional parameter is <code>interactive</code> are currently not supported.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_example"><a class="anchor" href="#_example"></a>3.2.1. Example</h4>
<div class="paragraph">
<p>The example below demonstrates how an interactive option can be used to specify a password.
From picocli 3.9.6, interactive options can use type <code>char[]</code> instead of String, to allow applications to null out the array after use so that sensitive information is no longer resident in memory.</p>
</div>
<div class="paragraph">
<p>Example usage:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Login</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-u"</span><span class="o">,</span> <span class="s">"--user"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"User name"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">user</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-p"</span><span class="o">,</span> <span class="s">"--password"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Passphrase"</span><span class="o">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="n">bytes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">password</span><span class="o">[</span><span class="n">i</span><span class="o">];</span> <span class="o">}</span>

        <span class="nc">MessageDigest</span> <span class="n">md</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>
        <span class="n">md</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Hi %s, your password is hashed to %s.%n"</span><span class="o">,</span> <span class="n">user</span><span class="o">,</span> <span class="n">base64</span><span class="o">(</span><span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">()));</span>

        <span class="c1">// null out the arrays when done</span>
        <span class="nc">Arrays</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="mi">0</span><span class="o">);</span>
        <span class="nc">Arrays</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">password</span><span class="o">,</span> <span class="sc">' '</span><span class="o">);</span>

        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">base64</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">arr</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Login</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-u"</span><span class="p">,</span> <span class="s">"--user"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"User name"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">user</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-p"</span><span class="p">,</span> <span class="s">"--password"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Passphrase"</span><span class="p">],</span> <span class="n">interactive</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">password</span><span class="p">:</span> <span class="nc">CharArray</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">bytes</span> <span class="p">=</span> <span class="nc">ByteArray</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">bytes</span><span class="p">.</span><span class="n">indices</span><span class="p">)</span> <span class="p">{</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">password</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">toByte</span><span class="p">()</span> <span class="p">}</span>

        <span class="kd">val</span> <span class="py">md</span> <span class="p">=</span> <span class="nc">MessageDigest</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="s">"SHA-256"</span><span class="p">)</span>
        <span class="n">md</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">bytes</span><span class="p">)</span>

        <span class="nf">println</span><span class="p">((</span><span class="s">"Hi %s, your password is hashed to %s."</span><span class="p">).</span><span class="nf">format</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="nf">base64</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="nf">digest</span><span class="p">())))</span>

        <span class="c1">// null out the arrays when done</span>
        <span class="nc">Arrays</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="nf">toByte</span><span class="p">())</span>
        <span class="nc">Arrays</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="sc">' '</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">base64</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="nc">ByteArray</span><span class="p">):</span> <span class="nc">String</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When this command is invoked like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Login</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="s">"-u"</span><span class="o">,</span> <span class="s">"user123"</span><span class="o">,</span> <span class="s">"-p"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Login</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(</span><span class="s">"-u"</span><span class="p">,</span> <span class="s">"user123"</span><span class="p">,</span> <span class="s">"-p"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the user will be prompted to enter a value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Enter value for --password (Passphrase):</code></pre>
</div>
</div>
<div class="paragraph">
<p>When running on Java 6 or higher, the user input is not echoed to the console.
After the user enters a password value and presses enter, the <code>call()</code> method is invoked, which prints something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Hi user123, your passphrase is hashed to 75K3eLr+dx6JJFuJ7LwIpEpOFmwGZZkRiB84PURz6U8=.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_optionally_interactive"><a class="anchor" href="#_optionally_interactive"></a>3.2.2. Optionally Interactive</h4>
<div class="paragraph">
<p>Interactive options by default cause the application to wait for input on stdin. For commands that need to be run interactively as well as in batch mode, it is useful if the option can optionally consume an argument from the command line.</p>
</div>
<div class="paragraph">
<p>The default <a href="#_arity">arity</a> for interactive options is zero, meaning that the option takes no parameters. From picocli 3.9.6, interactive options can also take a value from the command line if configured with <code>arity = "0..1"</code>. (See <a href="#_optional_values">Optional Values</a>.)</p>
</div>
<div class="paragraph">
<p>For example, if an application has these options:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--user"</span><span class="o">)</span>
<span class="nc">String</span> <span class="n">user</span><span class="o">;</span>

<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--password"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">password</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--user"</span><span class="p">])</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">user</span><span class="p">:</span> <span class="nc">String</span>

<span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--password"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span> <span class="n">interactive</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">password</span><span class="p">:</span> <span class="nc">CharArray</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the following input, the <code>password</code> field will be initialized to <code>"123"</code> without prompting the user for input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--password 123 --user Joe</pre>
</div>
</div>
<div class="paragraph">
<p>However, if the password is not specified, the user will be prompted to enter a value. In the following example, the password option has no parameter, so the user will be prompted to type in a value on the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--password --user Joe</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Providing Passwords to Batch Scripts Securely</div>
<div class="paragraph">
<p>Note that specifying a password in plain text on the command line or in scripts is not secure. There are alternatives that are more secure.</p>
</div>
<div class="paragraph">
<p>One idea is to add a separate different option (that could be named <code>--password:file</code>) that takes a <code>File</code> or <code>Path</code> parameter, where the application reads the password from the specified file.
Another idea is to add a separate different option (that could be named <code>--password:env</code>) that takes an environment variable name parameter, where the application gets the password from the userâs environment variables.</p>
</div>
<div class="paragraph">
<p>A command that combines either of these with an interactive <code>--password</code> option (with the default <code>arity = "0"</code>) allows end users to provide a password without specifying it in plain text on the command line. Such a command can be executed both interactively and in batch mode.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/remkop/picocli/blob/master/picocli-examples"><code>picocli-examples</code></a> module has an example, coded both in <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/interactive/PasswordDemo.java">Java</a> and <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin/interactive/PasswordDemo.kt">Kotlin</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">Interactive options and shell applications with JLine 2</div>
<div class="paragraph">
<p>Interactive options do not work in conjunction with JLine 2&#8217;s <code>ConsoleReader</code>. Either implement a <a href="#_custom_parameter_processing"><code>IParameterConsumer</code></a> which uses JLine2&#8217;s <code>ConsoleReader</code> directly or use <a href="https://github.com/remkop/picocli/tree/master/picocli-shell-jline3"><code>picocli-shell-jline3</code></a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_short_posix_options"><a class="anchor" href="#_short_posix_options"></a>3.3. Short (POSIX) Options</h3>
<div class="paragraph">
<p>Picocli supports <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html#tag_12_02">POSIX clustered short options</a>:
one or more single-character options without option-arguments, followed by at most one option with an option-argument, can be grouped behind one '-' delimiter.</p>
</div>
<div class="paragraph">
<p>For example, given this annotated class:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ClusteredShortOptions</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">aaa</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">bbb</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">ccc</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-f"</span><span class="o">)</span> <span class="nc">String</span>  <span class="n">file</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">ClusteredShortOptions</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">aaa</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">bbb</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">ccc</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following command line arguments are all equivalent and parsing them will give the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-abcfInputFile</span>.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-abcf</span><span class="o">=</span>InputFile.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-abc</span> <span class="nt">-f</span><span class="o">=</span>InputFile.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-ab</span> <span class="nt">-cf</span><span class="o">=</span>InputFile.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-a</span> <span class="nt">-b</span> <span class="nt">-c</span> <span class="nt">-fInputFile</span>.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-a</span> <span class="nt">-b</span> <span class="nt">-c</span> <span class="nt">-f</span> InputFile.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-a</span> <span class="nt">-b</span> <span class="nt">-c</span> <span class="nt">-f</span><span class="o">=</span>InputFile.txt
...</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">POSIX short options and usability</div>
<div class="paragraph">
<p>Applications can give a subtle hint to end users that an option is common and encouraged by providing both a short and a long name for an option.
Conversely, the absence of a short option can signal that the option is unusual or perhaps should be used with care.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_boolean_options"><a class="anchor" href="#_boolean_options"></a>3.4. Boolean Options</h3>
<div class="paragraph">
<p>Boolean options usually don&#8217;t need a parameter: it is enough to specify the option name on the command line.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BooleanOptions</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">x</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">BooleanOptions</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="k">false</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of <code>x</code> is <code>false</code> by default, and is set to <code>true</code> (the opposite of the default) if the <code>-x</code> option is specified on the command line.
If the <code>-x</code> option is specified multiple times on the command line, the value of <code>x</code> remains <code>true</code>. (Prior to picocli 4.0, the value of <code>x</code> would "toggle" (flip to its opposite) for every <code>-x</code> option on the command line. This can still be <a href="#_toggle_boolean_flags">configured</a> if required.)</p>
</div>
<div class="paragraph">
<p>This is enough in most cases, but picocli offers alternatives for applications that need to get the value from something other than the default value. When the option is specified on the command line, the annotated field (or <a href="#option-parameters-methods">method</a>) is assigned a value, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the parser is configured to <a href="#_toggle_boolean_flags">toggle boolean options</a>, the opposite of the <em>current value</em> is assigned. (This was the default prior to picocli 4.0.)</p>
</li>
<li>
<p>If a <a href="#fallbackValue-annotation">fallback value</a> is defined, the fallback value is assigned.</p>
</li>
<li>
<p>If the option is defined with a non-zero <a href="#_arity">arity</a>, and an option parameter was specified on the command line, this option <a href="#_boolean_options_with_parameters">parameter value is assigned</a>.</p>
</li>
<li>
<p>Otherwise, the value assigned is the logical opposite of the <em>default value</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_negatable_options"><a class="anchor" href="#_negatable_options"></a>3.5. Negatable Options</h3>
<div class="paragraph">
<p>From picocli 4.0, boolean options can be <code>negatable</code>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"negatable-options-demo"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">NegatableOptionsDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--verbose"</span><span class="o">,</span>           <span class="n">negatable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-XX:+PrintGCDetails"</span><span class="o">,</span> <span class="n">negatable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">printGCDetails</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-XX:-UseG1GC"</span><span class="o">,</span>        <span class="n">negatable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">useG1GC</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"negatable-options-demo"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">NegatableOptionsDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--verbose"</span><span class="p">],</span>           <span class="n">negatable</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">verbose</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-XX:+PrintGCDetails"</span><span class="p">],</span> <span class="n">negatable</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">printGCDetails</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-XX:-UseG1GC"</span><span class="p">],</span>        <span class="n">negatable</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">useG1GC</span> <span class="p">=</span> <span class="k">true</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When an option is negatable, picocli will recognize negative aliases of the option on the command line.</p>
</div>
<div class="paragraph">
<p>The usage help for the above example looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: negatable-options-demo [--[no-]verbose] [-XX:(+|-)PrintGCDetails]
                              [-XX:(+|-)UseG1GC]
      --[no-]verbose     Show verbose output
      -XX:(+|-)PrintGCDetails
                         Prints GC details
      -XX:(+|-)UseG1GC   Use G1 algorithm for GC</pre>
</div>
</div>
<div class="paragraph">
<p>For *nix-style long options, aliases have the prefix <code>no-</code> to the given names, for example <code>--no-verbose</code>.
For Java JVM-style options like <code>-XX:+PrintGCDetails</code>, the <code>:+</code> is turned into <code>:-</code> and vice versa.
Short option names are not given a negative alias by default. (This is <a href="#_customizing_negatable_options">customizable</a>.)</p>
</div>
<div class="paragraph">
<p>If the negated form of the option is found, for example <code>--no-verbose</code>, the value is set to the provided default. Otherwise, with a regular call, for example <code>--verbose</code>, it is set to the opposite of the default.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Negatable options that are <code>true</code> by default</div>
<div class="paragraph">
<p>When a negatable option is <code>true</code> by default, give it the negative name. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--no-backup"</span><span class="o">,</span> <span class="n">negatable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s">"Make a backup. True by default."</span><span class="o">)</span>
<span class="kt">boolean</span> <span class="n">backup</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--no-backup"</span><span class="p">],</span> <span class="n">negatable</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
  <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Make a backup. True by default."</span><span class="p">])</span>
<span class="kd">var</span> <span class="py">backup</span> <span class="p">=</span> <span class="k">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When end users specify <code>--no-backup</code> on the command line, the value is set to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The negated form of this option is <code>--backup</code>, and if that is specified, the default value is applied.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_positional_parameters"><a class="anchor" href="#_positional_parameters"></a>3.6. Positional Parameters</h3>
<div class="paragraph">
<p>Any command line arguments that are not subcommands or options (or option parameters) are interpreted as positional parameters.
Positional parameters generally follow the options but from picocli 2.0, positional parameters can be mixed with options on the command line.</p>
</div>
<div class="sect3">
<h4 id="_explicit_index"><a class="anchor" href="#_explicit_index"></a>3.6.1. Explicit Index</h4>
<div class="paragraph">
<p>Use the (zero-based) <code>index</code> attribute to specify exactly which parameters to capture.
Array or collection fields can capture multiple values.</p>
</div>
<div class="paragraph">
<p>The <code>index</code> attribute accepts <em>range</em> values, so an annotation like <code>@Parameters(index="2..4")</code> captures the arguments at index 2, 3 and 4. Range values can be <em>open-ended</em>. For example, <code>@Parameters(index="3..*")</code> captures all arguments from index 3 and up.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">PositionalParameters</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span>    <span class="nc">InetAddress</span> <span class="n">host</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span>    <span class="kt">int</span> <span class="n">port</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"2..*"</span><span class="o">)</span> <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">hidden</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>  <span class="c1">// "hidden": don't show this parameter in usage help message</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">allParameters</span><span class="o">;</span> <span class="c1">// no "index" attribute: captures _all_ arguments</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">PositionalParameters</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">)</span>    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">host</span><span class="p">:</span> <span class="nc">InetAddress</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">)</span>    <span class="kd">var</span> <span class="py">port</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"2..*"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">hidden</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>   <span class="c1">// "hidden": don't show this parameter in usage help message</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">allParameters</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="c1">// no "index" attribute: captures _all_ arguments</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Picocli initializes fields with the values at the specified index in the arguments array.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"localhost"</span><span class="o">,</span> <span class="s">"12345"</span><span class="o">,</span> <span class="s">"file1.txt"</span><span class="o">,</span> <span class="s">"file2.txt"</span> <span class="o">};</span>
<span class="nc">PositionalParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">populateCommand</span><span class="o">(</span><span class="k">new</span> <span class="nc">PositionalParameters</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span>

<span class="k">assert</span> <span class="n">params</span><span class="o">.</span><span class="na">host</span><span class="o">.</span><span class="na">getHostName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">params</span><span class="o">.</span><span class="na">port</span> <span class="o">==</span> <span class="mi">12345</span><span class="o">;</span>
<span class="k">assert</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">files</span><span class="o">,</span> <span class="k">new</span> <span class="nc">File</span><span class="o">[]</span> <span class="o">{</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"file1.txt"</span><span class="o">),</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"file2.txt"</span><span class="o">)});</span>

<span class="k">assert</span> <span class="n">params</span><span class="o">.</span><span class="na">allParameters</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">args</span><span class="o">));</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"localhost"</span><span class="p">,</span> <span class="s">"12345"</span><span class="p">,</span> <span class="s">"file1.txt"</span><span class="p">,</span> <span class="s">"file2.txt"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">params</span><span class="p">:</span> <span class="nc">PositionalParameters</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">populateCommand</span><span class="p">(</span><span class="nc">PositionalParameters</span><span class="p">(),</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span>

<span class="nf">assert</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">host</span><span class="p">.</span><span class="nf">getHostName</span><span class="p">().</span><span class="nf">equals</span><span class="p">(</span><span class="s">"localhost"</span><span class="p">))</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">port</span> <span class="p">===</span> <span class="mi">12345</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="nc">Arrays</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">files</span><span class="p">,</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="nc">File</span><span class="p">(</span><span class="s">"file1.txt"</span><span class="p">),</span> <span class="nc">File</span><span class="p">(</span><span class="s">"file2.txt"</span><span class="p">))))</span>

<span class="nf">assert</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">allParameters</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="nc">Arrays</span><span class="p">.</span><span class="nf">asList</span><span class="p">(*</span><span class="n">args</span><span class="p">)))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_strongly_typed_everything">Strongly Typed Everything</a> for which types are supported out of the box and how to add custom types.</p>
</div>
</div>
<div class="sect3">
<h4 id="_omitting_the_index"><a class="anchor" href="#_omitting_the_index"></a>3.6.2. Omitting the Index</h4>
<div class="paragraph">
<p>It is possible to omit the <code>index</code> attribute. This means different things for single-value and for multi-value positional parameters.</p>
</div>
<div class="paragraph">
<p>For <strong>multi-value</strong> positional parameters (arrays or collections), omitting the <code>index</code> attribute means the field captures <em>all</em> positional parameters (the equivalent of <code>index = "0..*"</code>).</p>
</div>
<div class="paragraph">
<p>For <strong>single-value</strong> positional parameters, picocli&#8217;s behaviour has changed since version 4.3:
prior to picocli 4.3, the default index for single-value positional parameters was also <code>index = "0..*"</code>, even though only one value (usually the first argument) can be captured.
From version 4.3, picocli assigns an index automatically, based on the other positional parameters defined in the same command.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Automatic indexes depend on the ability of Java reflection and Java annotation processors to iterate over fields in declaration order in the source code.
Officially this is not guaranteed by the Java spec.
In practice this has worked in Oracle JVMs and OpenJDK from Java 6, but there is some risk this may not work in the future or on other JVM&#8217;s.
In general, for single-value positional parameters, using <a href="#_explicit_index">explicit indexes</a> is the safer option.
(Multi-value positional parameters can safely omit the <code>index</code> attribute.)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Methods cannot be iterated over in predictable order.
For applications with <a href="#option-parameters-methods"><code>@Parameters</code>-annotated methods</a> or combinations of <code>@Parameters</code>-annotated methods and <code>@Parameters</code>-annotated fields, we recommend using <a href="#_explicit_index">explicit indexes</a> for single-value positional parameters.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="#_automatic_parameter_indexes">Automatic Parameter Indexes</a> for details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixing_options_and_positional_parameters"><a class="anchor" href="#_mixing_options_and_positional_parameters"></a>3.7. Mixing Options and Positional Parameters</h3>
<div class="paragraph">
<p>From picocli 2.0, positional parameters can be specified anywhere on the command line, they no longer need to follow the options.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Mixed</span> <span class="o">{</span>
    <span class="nd">@Parameters</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">positional</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-o"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">options</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Mixed</span> <span class="p">{</span>
    <span class="nd">@Parameters</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">positional</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-o"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">options</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Any command line argument that is not an option or subcommand is interpreted as a positional parameter.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"param0"</span><span class="o">,</span> <span class="s">"-o"</span><span class="o">,</span> <span class="s">"AAA"</span><span class="o">,</span> <span class="s">"param1"</span><span class="o">,</span> <span class="s">"param2"</span><span class="o">,</span> <span class="s">"-o"</span><span class="o">,</span> <span class="s">"BBB"</span><span class="o">,</span> <span class="s">"param3"</span> <span class="o">};</span>
<span class="nc">Mixed</span> <span class="n">mixed</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Mixed</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">mixed</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

<span class="k">assert</span> <span class="n">mixed</span><span class="o">.</span><span class="na">positional</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"param0"</span><span class="o">,</span> <span class="s">"param1"</span><span class="o">,</span> <span class="s">"param2"</span><span class="o">,</span> <span class="s">"param3"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">mixed</span><span class="o">.</span><span class="na">options</span><span class="o">.</span><span class="na">equals</span>   <span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"AAA"</span><span class="o">,</span> <span class="s">"BBB"</span><span class="o">));</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"param0"</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="s">"AAA"</span><span class="p">,</span> <span class="s">"param1"</span><span class="p">,</span> <span class="s">"param2"</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="s">"BBB"</span><span class="p">,</span> <span class="s">"param3"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">mixed</span> <span class="p">=</span> <span class="nc">Mixed</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">mixed</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>

<span class="nf">assert</span><span class="p">(</span><span class="n">mixed</span><span class="p">.</span><span class="n">positional</span> <span class="p">==</span> <span class="nc">Arrays</span><span class="p">.</span><span class="nf">asList</span><span class="p">(</span><span class="s">"param0"</span><span class="p">,</span> <span class="s">"param1"</span><span class="p">,</span> <span class="s">"param2"</span><span class="p">,</span> <span class="s">"param3"</span><span class="p">))</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">mixed</span><span class="p">.</span><span class="n">options</span> <span class="p">==</span> <span class="nc">Arrays</span><span class="p">.</span><span class="nf">asList</span><span class="p">(</span><span class="s">"AAA"</span><span class="p">,</span> <span class="s">"BBB"</span><span class="p">))</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_double_dash"><a class="anchor" href="#_double_dash"></a>3.8. Double dash (<code>--</code>)</h3>
<div class="paragraph">
<p>When one of the command line arguments is just two dashes without any characters attached (<code>--</code>),
picocli interprets all following arguments as positional parameters, even arguments that match an option name.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">DoubleDashDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-v"</span><span class="o">)</span>     <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-files"</span><span class="o">)</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">files</span><span class="o">;</span>
    <span class="nd">@Parameters</span>               <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">DoubleDashDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">])</span>     <span class="kd">var</span> <span class="py">verbose</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-files"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="nd">@Parameters</span>                 <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">params</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--</code> end-of-options delimiter clarifies which of the arguments are positional parameters:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-v"</span><span class="o">,</span> <span class="s">"--"</span><span class="o">,</span> <span class="s">"-files"</span><span class="o">,</span> <span class="s">"file1"</span><span class="o">,</span> <span class="s">"file2"</span> <span class="o">};</span>
<span class="nc">DoubleDashDemo</span> <span class="n">demo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DoubleDashDemo</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">demo</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

<span class="k">assert</span> <span class="n">demo</span><span class="o">.</span><span class="na">verbose</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">demo</span><span class="o">.</span><span class="na">files</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">demo</span><span class="o">.</span><span class="na">params</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"-files"</span><span class="o">,</span> <span class="s">"file1"</span><span class="o">,</span> <span class="s">"file2"</span><span class="o">));</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--"</span><span class="p">,</span> <span class="s">"-files"</span><span class="p">,</span> <span class="s">"file1"</span><span class="p">,</span> <span class="s">"file2"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">demo</span> <span class="p">=</span> <span class="nc">DoubleDashDemo</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">demo</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>

<span class="nf">assert</span><span class="p">(</span><span class="n">demo</span><span class="p">.</span><span class="n">verbose</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">demo</span><span class="p">.</span><span class="n">files</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">demo</span><span class="p">.</span><span class="n">params</span> <span class="p">==</span> <span class="nc">Arrays</span><span class="p">.</span><span class="nf">asList</span><span class="p">(</span><span class="s">"-files"</span><span class="p">,</span> <span class="s">"file1"</span><span class="p">,</span> <span class="s">"file2"</span><span class="p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A custom delimiter can be configured with <code>CommandLine.setEndOfOptionsDelimiter(String)</code>.</p>
</div>
<div class="paragraph">
<p>From picocli 4.3, an entry for <code>--</code> can be shown in the options list of the usage help message of a command with the <code>@Command(showEndOfOptionsDelimiterInUsageHelp = true)</code> annotation.
See <a href="#_show_end_of_options">Show End of Options</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="AtFiles"><a class="anchor" href="#AtFiles"></a>3.9. @-files</h3>
<div class="sect3">
<h4 id="_argument_files_for_long_command_lines"><a class="anchor" href="#_argument_files_for_long_command_lines"></a>3.9.1. Argument Files for Long Command Lines</h4>
<div class="paragraph">
<p>Users sometimes run into system limitations on the length of a command line when creating a
command line with lots of options or with long arguments for options.</p>
</div>
<div class="paragraph">
<p>Starting from v2.1.0, picocli supports "argument files" or "@-files".
Argument files are files that themselves contain arguments to the command.
When picocli encounters an argument beginning with the character `@',
it expands the contents of that file into the argument list.</p>
</div>
<div class="paragraph">
<p>An argument file can include options and positional parameters in any combination.
The arguments within a file can be space-separated or newline-separated.
If an argument contains embedded whitespace, put the whole argument in double or single quotes.
Within quoted values, backslashes need to be escaped with another backslash.</p>
</div>
<div class="paragraph">
<p>For example, it is possible to have a path with a space,
such as <code>c:\Program Files</code> that can be specified as either <code>"c:\\Program Files"</code> or,
to avoid an escape, <code>c:\Program" "Files</code>.</p>
</div>
<div class="paragraph">
<p>Lines starting with <code>#</code> are comments and are ignored.
The comment character can be configured with <code>CommandLine.setAtFileCommentChar(Character)</code>,
and comments can be switched off by setting the comment character to <code>null</code>.</p>
</div>
<div class="paragraph">
<p>The file may itself contain additional @-file arguments; any such arguments will be processed recursively.</p>
</div>
<div class="paragraph">
<p>If the file does not exist, or cannot be read, then the argument will be treated literally, and not removed.
Multiple @-files may be specified on the command line. The specified path may be relative (to the current directory) or absolute.</p>
</div>
<div class="paragraph">
<p>For example, suppose a file with arguments exists at <code>/home/foo/args</code>, with these contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># This line is a comment and is ignored.
ABC -option=123
'X Y Z'</pre>
</div>
</div>
<div class="paragraph">
<p>A command may be invoked with the @file argument, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java MyCommand @/home/foo/args</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above will be expanded to the contents of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java MyCommand ABC <span class="nt">-option</span><span class="o">=</span>123 <span class="s2">"X Y Z"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>@-file expansion can be switched off by calling <code>CommandLine::setExpandAtFiles</code> with <code>false</code>.
If turned on, you can still pass a real parameter with an initial '@' character by escaping it
with an additional '@' symbol, e.g. '@@somearg' will become '@somearg' and not be subject to expansion.</p>
</div>
<div class="paragraph">
<p>This feature is similar to the 'Command Line Argument File' processing supported by gcc, javadoc and javac.
The documentation for these tools has more details.
See for example the documentation for <a href="https://docs.oracle.com/en/java/javase/14/docs/specs/man/java.html#java-command-line-argument-files">java Command-Line Argument Files</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you think your users may find this feature (@files) useful, you could consider adding an option to your application that generates an @file for the specified arguments.
The <code>picocli-examples</code> module on GitHub has an <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/atfile/AtFileGenerator.java">example</a> to get you started.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_files_usage_help"><a class="anchor" href="#_files_usage_help"></a>3.9.2. @-files Usage Help</h4>
<div class="paragraph">
<p>From picocli 4.2, an entry for <code>@&lt;filename&gt;</code> can be shown in the options and parameters list of the usage help message of a command with the <code>@Command(showAtFileInUsageHelp = true)</code> annotation.
See <a href="#_show_at_files">Show At Files</a> for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_simplified_format"><a class="anchor" href="#_simplified_format"></a>3.9.3. Simplified Format</h4>
<div class="paragraph">
<p>From picocli 3.8.1, a simpler argument file format is also supported where every line (except empty lines and comment lines)
is interpreted as a single argument. Arguments containing whitespace do not need to be quoted,
but it is not possible to have arguments with embedded newlines or to have empty string arguments without quotes.
From picocli 3.9, this simpler argument format is fully compatible with <a href="http://jcommander.org/#_syntax">JCommander</a>'s <code>@-file</code> argument file format.</p>
</div>
<div class="paragraph">
<p>You can tell picocli to use the simplified argument file format programmatically with <code>CommandLine.setUseSimplifiedAtFiles(true)</code>,
or by setting system property <code>picocli.useSimplifiedAtFiles</code> without a value or with value <code>"true"</code>
(case-insensitive). The system property is useful to allow end users control over the format.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_strongly_typed_everything"><a class="anchor" href="#_strongly_typed_everything"></a>4. Strongly Typed Everything</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When command line options and positional parameters are mapped to the annotated fields,
the text value is converted to the type of the annotated field.</p>
</div>
<div class="sect2">
<h3 id="_built_in_types"><a class="anchor" href="#_built_in_types"></a>4.1. Built-in Types</h3>
<div class="paragraph">
<p>Out of the box, picocli can convert command line argument strings to a number of common data types.</p>
</div>
<div class="paragraph">
<p>Most of the built-in types work with Java 5, but picocli also has some default converters for Java 7 types like <code>Path</code> and Java 8 types like <code>Duration</code>, etc. These converters are loaded using reflection and are only available when running on a Java version that supports them. See the below list for details.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any Java primitive type or their wrapper</p>
</li>
<li>
<p>any <code>enum</code></p>
</li>
<li>
<p><code>String</code>, <code>StringBuilder</code>, <code>CharSequence</code></p>
</li>
<li>
<p><code>java.math.BigDecimal</code>, <code>java.math.BigInteger</code></p>
</li>
<li>
<p><code>java.nio.Charset</code></p>
</li>
<li>
<p><code>java.io.File</code></p>
</li>
<li>
<p><code>java.net.InetAddress</code></p>
</li>
<li>
<p><code>java.util.regex.Pattern</code></p>
</li>
<li>
<p><code>java.util.Date</code> (for values in <code>"yyyy-MM-dd"</code> format)</p>
</li>
<li>
<p><code>java.net.URL</code>, <code>java.net.URI</code></p>
</li>
<li>
<p><code>java.util.UUID</code></p>
</li>
<li>
<p><code>java.lang.Class</code> (from picocli 2.2, for the fully qualified class name)</p>
</li>
<li>
<p><code>java.nio.ByteOrder</code> (from picocli 2.2, for the Strings <code>"BIG_ENDIAN"</code> or <code>"LITTLE_ENDIAN"</code>)</p>
</li>
<li>
<p><code>java.util.Currency</code> (from picocli 2.2, for the ISO 4217 code of the currency)</p>
</li>
<li>
<p><code>java.net.NetworkInterface</code> (from picocli 2.2, for the InetAddress or name of the network interface)</p>
</li>
<li>
<p><code>java.util.TimeZoneConverter</code> (from picocli 2.2, for the ID for a TimeZone)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Converters loaded using reflection:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.nio.file.Path</code> (from picocli 2.2, requires Java 7 or higher)</p>
</li>
<li>
<p><code>java.time</code> value objects: <code>Duration</code>, <code>Instant</code>, <code>LocalDate</code>, <code>LocalDateTime</code>, <code>LocalTime</code>, <code>MonthDay</code>, <code>OffsetDateTime</code>, <code>OffsetTime</code>, <code>Period</code>, <code>Year</code>, <code>YearMonth</code>, <code>ZonedDateTime</code>, <code>ZoneId</code>, <code>ZoneOffset</code>  (from picocli 2.2, requires Java 8 or higher, invokes the <code>parse</code> method of these classes)</p>
</li>
<li>
<p><code>java.sql.Time</code> (for values in any of the <code>"HH:mm"</code>, <code>"HH:mm:ss"</code>, <code>"HH:mm:ss.SSS"</code>, or <code>"HH:mm:ss,SSS"</code> formats)</p>
</li>
<li>
<p><code>java.sql.Timestamp</code> (from picocli 2.2, for values in the <code>"yyyy-MM-dd HH:mm:ss"</code> or <code>"yyyy-MM-dd HH:mm:ss.fffffffff"</code> formats)</p>
</li>
<li>
<p><code>java.sql.Connection</code> (from picocli 2.2, for a database url of the form <code>jdbc:subprotocol:subname</code>)</p>
</li>
<li>
<p><code>java.sql.Driver</code> (from picocli 2.2, for a database URL of the form <code>jdbc:subprotocol:subname</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Sometimes loading converters with reflection is not desirable.
Use system property <code>picocli.converters.excludes</code> to specify a comma-separated list of fully qualified class names for which the converter should not be loaded.
Regular expressions are supported.
For example, invoking the program with <code>-Dpicocli.converters.excludes=java.sql.Ti.*</code> will not load type converters for <code>java.sql.Time</code> and <code>java.sql.Timestamp</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_custom_type_converters"><a class="anchor" href="#_custom_type_converters"></a>4.2. Custom Type Converters</h3>
<div class="paragraph">
<p>Register a custom type converter to handle data types other than the above built-in ones.</p>
</div>
<div class="sect3">
<h4 id="_single_parameter_type_converters"><a class="anchor" href="#_single_parameter_type_converters"></a>4.2.1. Single Parameter Type Converters</h4>
<div class="paragraph">
<p>Custom converters need to implement the <code>picocli.CommandLine.ITypeConverter</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="cm">/**
     * Converts the specified command line argument value to some domain object.
     * @param value the command line argument String value
     * @return the resulting domain object
     * @throws Exception an exception detailing what went wrong during the conversion
     */</span>
    <span class="no">K</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">CipherConverter</span> <span class="kd">implements</span> <span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="nc">Cipher</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Cipher</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Custom type converters can be specified for a specific option or positional parameter with the <code>converter</code> annotation attribute.
This is described in more detail in the <a href="#_option_specific_type_converters">Option-specific Type Converters</a> section, but here is a quick example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">converter</span> <span class="o">=</span> <span class="nc">CipherConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">javax</span><span class="o">.</span><span class="na">crypto</span><span class="o">.</span><span class="na">Cipher</span> <span class="n">cipher</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">converter</span> <span class="p">=</span> <span class="p">[</span><span class="nc">CipherConverter</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">cipher</span><span class="p">:</span> <span class="n">javax</span><span class="p">.</span><span class="n">crypto</span><span class="p">.</span><span class="nc">Cipher</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s2">"-a"</span><span class="o">,</span> <span class="n">converter</span> <span class="o">=</span> <span class="n">CipherConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kt">def</span> <span class="n">cipher</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy Script</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s2">"-a"</span><span class="o">,</span> <span class="n">converter</span> <span class="o">=</span> <span class="o">[</span> <span class="c1">// requires Groovy 3.0.7</span>
            <span class="o">{</span> <span class="o">{</span> <span class="n">str</span> <span class="o">-&gt;</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">str</span><span class="o">)</span> <span class="o">}</span> <span class="k">as</span> <span class="n">ITypeConverter</span> <span class="o">}</span>
    <span class="o">])</span>
    <span class="kt">def</span> <span class="n">cipher</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Groovy programs can use <a href="#_closures_in_annotations">closures in the <code>converter</code> attribute of the annotation</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, custom type converters can be registered <em>per type</em> in each command with the <code>CommandLine.registerConverter(Class&lt;K&gt; cls, ITypeConverter&lt;K&gt; converter)</code> method.
All options and positional parameters with the specified type will be converted by the specified converter.</p>
</div>
<div class="paragraph">
<p>After registering custom converters, call the <code>execute(String&#8230;&#8203;)</code> or <code>parseArgs(String&#8230;&#8203;)</code> method on the <code>CommandLine</code> instance where the converters are registered. (The static <code>populateCommand</code> method cannot be used.) For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Parameters</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Locale</span> <span class="n">locale</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">)</span> <span class="n">javax</span><span class="o">.</span><span class="na">crypto</span><span class="o">.</span><span class="na">Cipher</span> <span class="n">cipher</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">java.util.Locale</span>
<span class="k">import</span> <span class="nn">javax.crypto.Cipher</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Parameters</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">locale</span><span class="p">:</span> <span class="nc">Locale</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">cipher</span><span class="p">:</span> <span class="nc">Cipher</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Java 8 lambdas make it easy to register custom converters:
</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">App</span> <span class="n">app</span> <span class="p">=</span> <span class="n">new</span> <span class="nc">App</span><span class="p">();</span>
<span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="p">=</span> <span class="n">new</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Locale</span><span class="p">.</span><span class="k">class</span><span class="p">,</span> <span class="n">s</span> <span class="p">-&gt;</span> <span class="n">new</span> <span class="nc">Locale</span><span class="p">.</span><span class="nc">Builder</span><span class="p">().</span><span class="nf">setLanguageTag</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="nf">build</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Cipher</span><span class="p">.</span><span class="k">class</span><span class="p">,</span> <span class="n">s</span> <span class="p">-&gt;</span> <span class="nc">Cipher</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>

<span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-a"</span><span class="p">,</span> <span class="s">"AES/CBC/NoPadding"</span><span class="p">,</span> <span class="s">"en-GB"</span><span class="p">);</span>
<span class="n">assert</span> <span class="n">app</span><span class="p">.</span><span class="n">locale</span><span class="p">.</span><span class="nf">toLanguageTag</span><span class="p">().</span><span class="nf">equals</span><span class="p">(</span><span class="s">"en-GB"</span><span class="p">);</span>
<span class="n">assert</span> <span class="n">app</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="nf">getAlgorithm</span><span class="p">().</span><span class="nf">equals</span><span class="p">(</span><span class="s">"AES/CBC/NoPadding"</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">App</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Locale</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">s</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">-&gt;</span> <span class="nc">Locale</span><span class="p">.</span><span class="nc">Builder</span><span class="p">().</span><span class="nf">setLanguageTag</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Cipher</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">Cipher</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
    <span class="p">}</span>

<span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-a"</span><span class="p">,</span> <span class="s">"AES/CBC/NoPadding"</span><span class="p">,</span> <span class="s">"en-GB"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">locale</span><span class="p">.</span><span class="nf">toLanguageTag</span><span class="p">()</span> <span class="p">==</span> <span class="s">"en-GB"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="n">algorithm</span> <span class="p">==</span> <span class="s">"AES/CBC/NoPadding"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<em>Note on subcommands:</em> the specified converter will be registered with the <code>CommandLine</code> object
and all subcommands (and nested sub-subcommands) that were added <em>before</em> the converter was registered.
Subcommands added later will not have the converter added automatically.
To ensure a custom type converter is available to all subcommands, register the type converter last, after adding subcommands.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_multi_parameter_type_converters"><a class="anchor" href="#_multi_parameter_type_converters"></a>4.2.2. Multi Parameter Type Converters</h4>
<div class="paragraph">
<p>Some types take more than one parameter.
The <code>IParameterConsumer</code> interface can be used to implement a multi-parameter type converter.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"set-position"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">SetPositionCommand</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">parameterConsumer</span> <span class="o">=</span> <span class="nc">PointConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Point</span> <span class="n">position</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PointConverter</span> <span class="kd">implements</span> <span class="nc">IParameterConsumer</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consumeParameters</span><span class="o">(</span><span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">args</span><span class="o">,</span>
                                      <span class="nc">ArgSpec</span> <span class="n">argSpec</span><span class="o">,</span>
                                      <span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">commandSpec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span>
                        <span class="s">"Missing coordinates for Point. Please specify 2 coordinates."</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
            <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
            <span class="n">argSpec</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"set-position"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">SetPositionCommand</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">parameterConsumer</span> <span class="p">=</span> <span class="nc">PointConverter</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">position</span><span class="p">:</span> <span class="nc">Point</span>

    <span class="kd">class</span> <span class="nc">PointConverter</span> <span class="p">:</span> <span class="nc">IParameterConsumer</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">consumeParameters</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Stack</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span>
                                       <span class="n">argSpec</span><span class="p">:</span> <span class="nc">ArgSpec</span><span class="p">,</span>
                                       <span class="n">commandSpec</span><span class="p">:</span> <span class="nc">CommandSpec</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">size</span> <span class="p">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="nc">ParameterException</span><span class="p">(</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span>
                    <span class="s">"Missing coordinates for Point. Please specify 2 coordinates."</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="kd">val</span> <span class="py">x</span> <span class="p">=</span> <span class="n">args</span><span class="p">.</span><span class="nf">pop</span><span class="p">().</span><span class="nf">toInt</span><span class="p">()</span>
            <span class="kd">val</span> <span class="py">y</span> <span class="p">=</span> <span class="n">args</span><span class="p">.</span><span class="nf">pop</span><span class="p">().</span><span class="nf">toInt</span><span class="p">()</span>
            <span class="n">argSpec</span><span class="p">.</span><span class="nf">setValue</span><span class="p">(</span><span class="nc">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See the sections on <a href="#_custom_parameter_processing">Custom Parameter Processing</a> for more details.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Make sure any nested classes are <code>static</code>, or picocli will not be able to instantiate them.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_invalid_input"><a class="anchor" href="#_handling_invalid_input"></a>4.3. Handling Invalid Input</h3>
<div class="paragraph">
<p>If the user specifies invalid input, custom type converters should throw an exception.
Any exception is fine, and will result in a message like the below being displayed to the user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Invalid value for option '--socket-address': cannot convert 'xxxinvalidinput' to InetSocketAddress (java.lang.IllegalArgumentException: Invalid format: must be 'host:port' but was 'xxxinvalidinput')</pre>
</div>
</div>
<div class="paragraph">
<p>The above error message is generic and is reasonable for many exceptions, but sometimes you want more control over the error message displayed to the user.
To achieve this, throw a <code>picocli.CommandLine.TypeConversionException</code> instead.
When a <code>TypeConversionException</code> is thrown, picocli will show an error message that indicates the problematic option, followed by the exception message text. The resulting output looks something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Invalid value for option '--socket-address': Invalid format: must be 'host:port' but was 'xxxinvalidinput'</pre>
</div>
</div>
<div class="paragraph">
<p>Below is an example custom converter that throws a <code>TypeConversionException</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">InetSocketAddressConverter</span> <span class="kd">implements</span> <span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="nc">InetSocketAddress</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">InetSocketAddress</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="sc">':'</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">TypeConversionException</span><span class="o">(</span>
                <span class="s">"Invalid format: must be 'host:port' but was '"</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s">"'"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">adr</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">pos</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="o">));</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">InetSocketAddress</span><span class="o">(</span><span class="n">adr</span><span class="o">,</span> <span class="n">port</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">java.net.InetSocketAddress</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">InetSocketAddressConverter</span> <span class="p">:</span> <span class="nc">ITypeConverter</span><span class="p">&lt;</span><span class="nc">InetSocketAddress</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">InetSocketAddress</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">pos</span> <span class="p">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">lastIndexOf</span><span class="p">(</span><span class="sc">':'</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="p">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">TypeConversionException</span><span class="p">(</span>
                <span class="s">"Invalid format: must be 'host:port' but was '$value'"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kd">val</span> <span class="py">adr</span> <span class="p">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">port</span> <span class="p">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="n">pos</span> <span class="p">+</span> <span class="mi">1</span><span class="p">).</span><span class="nf">toInt</span><span class="p">()</span>
        <span class="k">return</span> <span class="nc">InetSocketAddress</span><span class="p">(</span><span class="n">adr</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>picocli-examples</code> module on GitHub has a minimal working <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/typeconverter/InetSocketAddressConverterDemo.java">example</a> which you can run in our <a href="https://www.jdoodle.com/embed/v0/2mxo?stdin=1&amp;arg=1" target="_blank" rel="noopener">online-editor</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_option_specific_type_converters"><a class="anchor" href="#_option_specific_type_converters"></a>4.4. Option-specific Type Converters</h3>
<div class="paragraph">
<p>Picocli 2.2 added a <code>converter</code> attribute to the <code>@Option</code> and <code>@Parameter</code> annotations. This allows a specific option or positional parameter to use a different converter than would be used by default based on the type of the field.</p>
</div>
<div class="paragraph">
<p>For example, for a specific field you may want to use a converter that maps the constant names defined in <a href="https://docs.oracle.com/javase/9/docs/api/java/sql/Types.html"><code>java.sql.Types</code></a> to the <code>int</code> value of these constants, but any other <code>int</code> fields should not be affected by this and should continue to use the standard int converter that parses numeric values.</p>
</div>
<div class="paragraph">
<p>Example usage:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--sqlType"</span><span class="o">,</span> <span class="n">converter</span> <span class="o">=</span> <span class="nc">SqlTypeConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">sqlType</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--sqlType"</span><span class="p">],</span> <span class="n">converter</span> <span class="p">=</span> <span class="p">[</span><span class="nc">SqlTypeConverter</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">sqlType</span> <span class="p">=</span> <span class="mi">0</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example implementation:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">SqlTypeConverter</span> <span class="kd">implements</span> <span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="s">"ARRAY"</span>  <span class="o">:</span> <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">ARRAY</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"BIGINT"</span> <span class="o">:</span> <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">BIGINT</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"BINARY"</span> <span class="o">:</span> <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">BINARY</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"BIT"</span>    <span class="o">:</span> <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">BIT</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"BLOB"</span>   <span class="o">:</span> <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">BLOB</span><span class="o">;</span>
            <span class="c1">// ...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">SqlTypeConverter</span> <span class="p">:</span> <span class="nc">ITypeConverter</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="nd">@Throws</span><span class="p">(</span><span class="nc">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">when</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="s">"ARRAY"</span>  <span class="p">-&gt;</span> <span class="k">return</span> <span class="nc">Types</span><span class="p">.</span><span class="nc">ARRAY</span>
            <span class="s">"BIGINT"</span> <span class="p">-&gt;</span> <span class="k">return</span> <span class="nc">Types</span><span class="p">.</span><span class="nc">BIGINT</span>
            <span class="s">"BINARY"</span> <span class="p">-&gt;</span> <span class="k">return</span> <span class="nc">Types</span><span class="p">.</span><span class="nc">BINARY</span>
            <span class="s">"BIT"</span>    <span class="p">-&gt;</span> <span class="k">return</span> <span class="nc">Types</span><span class="p">.</span><span class="nc">BIT</span>
            <span class="s">"BLOB"</span>   <span class="p">-&gt;</span> <span class="k">return</span> <span class="nc">Types</span><span class="p">.</span><span class="nc">BLOB</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This may also be useful for applications that need a custom type converter but want to use the static convenience methods (<code>populateCommand</code>, <code>run</code>, <code>call</code>, <code>invoke</code>). The <code>converter</code> annotation does not require a <code>CommandLine</code> instance so it can be used with the static convenience methods.</p>
</div>
<div class="paragraph">
<p>Type converters declared with the <code>converter</code> attribute need to have a public no-argument constructor to be instantiated, unless a <a href="#_custom_factory">Custom Factory</a> is installed to instantiate classes.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
If your type converter is declared as nested class, make sure you mark this class as <code>static</code>, or picocli will not be able to instantiate your nested converter class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_arrays_collections_maps"><a class="anchor" href="#_arrays_collections_maps"></a>4.5. Arrays, Collections, Maps</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Starting from picocli 2.0, the <code>type</code> attribute is no longer necessary for <code>Collection</code> and <code>Map</code> fields:
picocli will infer the collection element type from the generic type.
(The <code>type</code> attribute still works as before, it is just optional in most cases.)
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_arrays_and_collections"><a class="anchor" href="#_arrays_and_collections"></a>4.5.1. Arrays and Collections</h4>
<div class="paragraph">
<p>Multiple parameters can be captured together in a single array or <code>Collection</code> field.
The array or collection elements can be any type for which a <a href="#_strongly_typed_everything">converter</a> is registered.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Convert</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-patterns"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"the regex patterns to use"</span><span class="o">)</span>
    <span class="nc">Pattern</span><span class="o">[]</span> <span class="n">patterns</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="cm">/* type = File.class, */</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"the files to convert"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">files</span><span class="o">;</span> <span class="c1">// picocli infers type from the generic type</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">java.io.File</span>
<span class="k">import</span> <span class="nn">java.util.regex.Pattern</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">Convert</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-patterns"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the regex patterns to use"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">patterns</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Pattern</span><span class="p">&gt;</span>

    <span class="nd">@Parameters</span><span class="p">(</span> <span class="cm">/* type = [File::class], */</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the files to convert"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span> <span class="c1">// picocli infers type from the generic type</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-patterns"</span><span class="o">,</span> <span class="s">"a*b"</span><span class="o">,</span> <span class="s">"-patterns"</span><span class="o">,</span> <span class="s">"[a-e][i-u]"</span><span class="o">,</span> <span class="s">"file1.txt"</span><span class="o">,</span> <span class="s">"file2.txt"</span> <span class="o">};</span>
<span class="nc">Convert</span> <span class="n">convert</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">populateCommand</span><span class="o">(</span><span class="k">new</span> <span class="nc">Convert</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span>

<span class="c1">// convert.patterns now has two Pattern objects</span>
<span class="c1">// convert.files now has two File objects</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"-patterns"</span><span class="p">,</span> <span class="s">"a*b"</span><span class="p">,</span> <span class="s">"-patterns"</span><span class="p">,</span> <span class="s">"[a-e][i-u]"</span><span class="p">,</span> <span class="s">"file1.txt"</span><span class="p">,</span> <span class="s">"file2.txt"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">convert</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">populateCommand</span><span class="p">(</span><span class="nc">Convert</span><span class="p">(),</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span>

<span class="c1">// convert.patterns now has two Pattern objects</span>
<span class="c1">// convert.files now has two File objects</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a collection is returned from a type converter, the <em>contents</em> of the collection are added to the field or method parameter, not the collection itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the field or method parameter is <code>null</code>, picocli will instantiate it when the option or positional parameter is successfully matched.
If the <code>Collection</code> type is not a concrete class, picocli will make a best effort to instantiate it based on the field type:
<code>List &#8594; ArrayList</code>, <code>SortedSet &#8594; TreeSet</code>, <code>Set &#8594; LinkedHashSet</code>, <code>Queue &#8594; LinkedList</code>, otherwise, <code>ArrayList</code>.</p>
</div>
<div class="paragraph">
<p>Multi-value options and positional parameters can be defined with a <code>split</code> regular expression to allow end users to specify multiple values in a single parameter.
See the <a href="#_split_regex">Split Regex</a> section for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_maps"><a class="anchor" href="#_maps"></a>4.5.2. Maps</h4>
<div class="paragraph">
<p>Picocli 1.0 introduced support for <code>Map</code> fields similar to Java&#8217;s system properties <code>-Dkey=value</code> or Gradle&#8217;s project properties <code>-Pmyprop=myvalue</code>.</p>
</div>
<div class="paragraph">
<p><code>Map</code> fields may have any type for their key and value
as long as a <a href="#_strongly_typed_everything">converter</a> is registered for both the key and the value type.
Key and value types are inferred from the map&#8217;s generic type parameters.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.net.InetAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Proxy.Type</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MapDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-p"</span><span class="o">,</span> <span class="s">"--proxyHost"</span><span class="o">})</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Proxy</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="nc">InetAddress</span><span class="o">&gt;</span> <span class="n">proxies</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-u"</span><span class="o">,</span> <span class="s">"--timeUnit"</span><span class="o">})</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">TimeUnit</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="n">timeout</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">java.net.InetAddress</span>
<span class="k">import</span> <span class="nn">java.net.Proxy</span>
<span class="k">import</span> <span class="nn">java.util.concurrent.TimeUnit</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MapDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-p"</span><span class="p">,</span> <span class="s">"--proxyHost"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">proxies</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">Proxy</span><span class="err">.</span><span class="nc">Type</span><span class="p">,</span> <span class="nc">InetAddress</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-u"</span><span class="p">,</span> <span class="s">"--timeUnit"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">timeout</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">TimeUnit</span><span class="p">,</span> <span class="nc">Long</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Map options may be specified multiple times with different key-value pairs. (See <a href="#_multiple_values">Multiple Values</a>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-p</span> <span class="nv">HTTP</span><span class="o">=</span>123.123.123.123 <span class="nt">--proxyHost</span> <span class="nv">SOCKS</span><span class="o">=</span>212.212.212.212
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-uDAYS</span><span class="o">=</span>3 <span class="nt">-u</span> <span class="nv">HOURS</span><span class="o">=</span>23 <span class="nt">-u</span><span class="o">=</span><span class="nv">MINUTES</span><span class="o">=</span>59 <span class="nt">--timeUnit</span><span class="o">=</span><span class="nv">SECONDS</span><span class="o">=</span>13</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the annotated field is <code>null</code>, picocli will instantiate it when the option or positional parameter is matched.
If the <code>Map</code> type is not a concrete class, picocli will instantiate a <code>LinkedHashMap</code> to preserve the input ordering.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On the command line, the key and the value must be separated by a <code>=</code> character.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Map options and positional parameters can be defined with a <code>split</code> regular expression to allow end users to specify multiple values in a single parameter.
See the <a href="#_split_regex">Split Regex</a> section for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_key_only_map_parameters"><a class="anchor" href="#_key_only_map_parameters"></a>4.5.3. Key-only map parameters</h4>
<div class="paragraph">
<p>By default, picocli expects Map options and positional parameters to look like <code>key=value</code>,
that is, the option parameter or positional parameter is expected to have a key part and a value part, separated by a <code>=</code> character.
If this is not the case, picocli shows a user-facing error message: <code>Value for &#8230;&#8203; should be in KEY=VALUE format but was &#8230;&#8203;</code>.</p>
</div>
<div class="paragraph">
<p>From picocli 4.6, applications can specify a <code>mapFallbackValue</code> to allow end users to specify only the key part.
The specified <code>mapFallbackValue</code> is put into the map when end users to specify only a key.
The value type can be <a href="#_optionalt">wrapped in a <code>java.util.Optional</code></a>.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-P"</span><span class="o">,</span> <span class="s">"--properties"</span><span class="o">},</span> <span class="n">mapFallbackValue</span> <span class="o">=</span> <span class="nc">Option</span><span class="o">.</span><span class="na">NULL_VALUE</span><span class="o">)</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">properties</span><span class="o">;</span>

<span class="nd">@Parameters</span><span class="o">(</span><span class="n">mapFallbackValue</span> <span class="o">=</span> <span class="s">"INFO"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"... ${MAP-FALLBACK-VALUE} ..."</span><span class="o">)</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?&gt;,</span> <span class="nc">LogLevel</span><span class="o">&gt;</span> <span class="n">logLevels</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-P"</span><span class="p">,</span> <span class="s">"--properties"</span><span class="p">],</span> <span class="n">mapFallbackValue</span> <span class="p">=</span> <span class="nc">Option</span><span class="p">.</span><span class="nc">NULL_VALUE</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">properties</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">Optional</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;&gt;</span>

<span class="nd">@Parameters</span><span class="p">(</span><span class="n">mapFallbackValue</span> <span class="p">=</span> <span class="s">"INFO"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="s">"... ${MAP-FALLBACK-VALUE} ..."</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">logLevels</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">Class</span><span class="p">&lt;</span><span class="err">?</span><span class="p">&gt;,</span> <span class="nc">LogLevel</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows input like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;cmd&gt; --properties=key1 -Pkey2 -Pkey3=3 org.myorg.MyClass org.myorg.OtherClass=DEBUG</pre>
</div>
</div>
<div class="paragraph">
<p>The above input would give the following results:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>properties = [key1: Optional.empty, key2: Optional.empty, key3: Optional[3]]
logLevels  = [org.myorg.MyClass: INFO, org.myorg.OtherClass: DEBUG]</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the option description may contain the <a href="#_predefined_variables"><code>${MAP-FALLBACK-VALUE}</code></a> variable which will be replaced with the actual map fallback value when the usage help is shown.</p>
</div>
</div>
<div class="sect3">
<h4 id="_system_properties"><a class="anchor" href="#_system_properties"></a>4.5.4. System Properties</h4>
<div class="paragraph">
<p>A common requirement for command line applications is to support the <code>-Dkey=value</code> syntax to allow end users to set system properties.</p>
</div>
<div class="paragraph">
<p>The example below uses the <code>Map</code> type to define an <code>@Option</code>-<a href="#option-parameters-methods">annotated method</a> that delegates all key-value pairs to <code>System::setProperty</code>.
Note the use of <code>mapFallbackValue = ""</code> to allow <a href="#_key_only_map_parameters">key-only option parameters</a>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">SystemPropertiesDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-D"</span><span class="o">,</span> <span class="n">mapFallbackValue</span> <span class="o">=</span> <span class="s">""</span><span class="o">)</span> <span class="c1">// allow -Dkey</span>
    <span class="kt">void</span> <span class="nf">setProperty</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">props</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">props</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">SystemPropertiesDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-D"</span><span class="p">],</span> <span class="n">mapFallbackValue</span> <span class="p">=</span> <span class="s">""</span><span class="p">)</span> <span class="c1">// allow -Dkey</span>
    <span class="k">fun</span> <span class="nf">setProperty</span><span class="p">(</span><span class="n">props</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
        <span class="n">props</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">System</span><span class="p">.</span><span class="nf">setProperty</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optionalt"><a class="anchor" href="#_optionalt"></a>4.6. Optional&lt;T&gt;</h3>
<div class="paragraph">
<p>From version 4.6, picocli supports single-value types wrapped in a <code>java.util.Optional</code> container object when running on Java 8 or higher.
If the option or positional parameter was not specified on the command line, picocli assigns the value <code>Optional.empty()</code> instead of <code>null</code>.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">;</span>

<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-D"</span><span class="o">,</span> <span class="n">mapFallbackValue</span> <span class="o">=</span> <span class="nc">Option</span><span class="o">.</span><span class="na">NULL_VALUE</span><span class="o">)</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">x</span><span class="p">:</span> <span class="nc">Optional</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span>

<span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-D"</span><span class="p">],</span> <span class="n">mapFallbackValue</span> <span class="p">=</span> <span class="nc">Option</span><span class="p">.</span><span class="nc">NULL_VALUE</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">map</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">Optional</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Picocli has only limited support for <code>java.util.Optional</code> types:
only single-value types, and the values in a <code>Map</code> (but not the keys!) can be wrapped in an <code>Optional</code> container.
<code>java.util.Optional</code> cannot be combined with arrays or other <code>Collection</code> classes.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_abstract_field_types"><a class="anchor" href="#_abstract_field_types"></a>4.7. Abstract Field Types</h3>
<div class="paragraph">
<p>The field&#8217;s type can be an interface or an abstract class.
The <code>type</code> attribute can be used to control for each field what concrete class the string value should be converted to.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--big"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">BigDecimal</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// concrete Number subclass</span>
    <span class="nc">Number</span><span class="o">[]</span> <span class="n">big</span><span class="o">;</span> <span class="c1">// array type with abstract component class</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--small"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">Short</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// other Number subclass</span>
    <span class="nc">Number</span><span class="o">[]</span> <span class="n">small</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">type</span> <span class="o">=</span> <span class="nc">StringBuilder</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// StringBuilder implements CharSequence</span>
    <span class="nc">CharSequence</span> <span class="n">address</span><span class="o">;</span> <span class="c1">// interface type</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--big"</span><span class="p">],</span> <span class="n">type</span> <span class="p">=</span> <span class="p">[</span><span class="nc">BigDecimal</span><span class="o">::</span><span class="k">class</span><span class="p">])</span> <span class="c1">// concrete Number subclass</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">big</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Number</span><span class="p">&gt;</span> <span class="c1">// array type with abstract component class</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--small"</span><span class="p">],</span> <span class="n">type</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Short</span><span class="o">::</span><span class="k">class</span><span class="p">])</span> <span class="c1">// other Number subclass</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">small</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Number</span><span class="p">&gt;</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">type</span> <span class="p">=</span> <span class="p">[</span><span class="nc">StringBuilder</span><span class="o">::</span><span class="k">class</span><span class="p">])</span> <span class="c1">// StringBuilder implements CharSequence</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">address</span><span class="p">:</span> <span class="nc">CharSequence</span> <span class="c1">// interface type</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_maps_and_collections_with_abstract_elements"><a class="anchor" href="#_maps_and_collections_with_abstract_elements"></a>4.7.1. Maps and Collections with Abstract Elements</h4>
<div class="paragraph">
<p>For raw maps and collections, or when using generics with unbounded wildcards like <code>Map&lt;?, ?&gt;</code>, or when the type parameters are themselves abstract classes like <code>List&lt;CharSequence&gt;</code> or <code>Map&lt;? extends Number, ? super Number&gt;</code>, there is not enough information to convert to a stronger type. By default, the raw String values are added as is to such collections.</p>
</div>
<div class="paragraph">
<p>The <code>type</code> attribute can be specified to convert to a stronger type than String. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">TypeDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span>  <span class="c1">// not enough information to convert</span>
    <span class="nc">Map</span><span class="o">&lt;?,</span> <span class="o">?&gt;</span> <span class="n">weaklyTyped</span><span class="o">;</span> <span class="c1">// String keys and values are added as is</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="o">{</span><span class="nc">Short</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">BigDecimal</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nc">Map</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Number</span><span class="o">,</span> <span class="o">?</span> <span class="kd">super</span> <span class="nc">Number</span><span class="o">&gt;</span> <span class="n">stronglyTyped</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-s"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">CharBuffer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CharSequence</span><span class="o">&gt;</span> <span class="n">text</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">TypeDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span>              <span class="c1">// not enough information to convert</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">weaklyTyped</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="err">*</span><span class="p">,</span> <span class="err">*</span><span class="p">&gt;</span> <span class="c1">// String keys and values are added as is</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">type</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Short</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">BigDecimal</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">stronglyTyped</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">Number</span><span class="p">,</span> <span class="nc">Number</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-s"</span><span class="p">],</span> <span class="n">type</span> <span class="p">=</span> <span class="p">[</span><span class="nc">CharBuffer</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">text</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">CharSequence</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enum_types"><a class="anchor" href="#_enum_types"></a>4.8. Enum Types</h3>
<div class="paragraph">
<p>It is encouraged to use <code>enum</code> types for options or positional parameters with a limited set of valid values.
Not only will picocli validate the input, it allows you to <a href="#_show_default_values">show all values</a> in the usage help message with <code>@Option(description = "Valid values: ${COMPLETION-CANDIDATES}")</code>. It also allows command line completion to suggest completion candidates for the values of this option.</p>
</div>
<div class="paragraph">
<p>Enum value matching is case-sensitive by default, but as of picocli 3.4 this can be controlled with <code>CommandLine::setCaseInsensitiveEnumValuesAllowed</code> and <code>CommandSpec::caseInsensitiveEnumValuesAllowed</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_values"><a class="anchor" href="#_default_values"></a>5. Default Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to define a default value for an option or positional parameter, that is assigned when the user did not specify this option or positional parameter on the command line.</p>
</div>
<div class="paragraph">
<p>Configuring a default value guarantees that the <code>@Option</code> or <code>@Parameters</code>-annotated field will get set, annotated method will get called, and, when using the programmatic API, that the <a href="https://picocli.info/apidocs/picocli/CommandLine.Model.ArgSpec.html#setValue-T-"><code>ArgSpec.setValue</code></a> method will get invoked, even when the option or positional parameter was not specified on the command line.</p>
</div>
<div class="sect2">
<h3 id="defaultValue-annotation"><a class="anchor" href="#defaultValue-annotation"></a>5.1. <code>defaultValue</code> Annotation</h3>
<div class="paragraph">
<p>The recommended way to give an option or positional parameter a default value is to use the <code>defaultValue</code> annotation attribute. This works correctly with argument groups, <code>@Option</code> and <code>@Parameters</code>-annotated methods, and allows annotation processors to detect and use default values.</p>
</div>
<div class="paragraph">
<p>For <a href="#option-parameters-methods">@Option and @Parameters-annotated methods</a> and <a href="#command-methods">@Command-annotated methods</a>, there is no alternative but to use the <code>defaultValue</code> annotation attribute. For example, for an annotated interface:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">interface</span> <span class="nc">Spec</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"123"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"... ${DEFAULT-VALUE} ..."</span><span class="o">)</span>
    <span class="kt">int</span> <span class="nf">count</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">interface</span> <span class="nc">Spec</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"123"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"... \${DEFAULT-VALUE} ..."</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">count</span><span class="p">():</span> <span class="nc">Int</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of using the <code>defaultValue</code> attribute in the option of a command method:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">CommandMethod</span> <span class="o">{</span>
    <span class="nd">@Command</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Do something."</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">doit</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"123"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">CommandMethod</span> <span class="p">{</span>
    <span class="nd">@Command</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Do something."</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">doit</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"123"</span><span class="p">)</span> <span class="n">count</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you can use the <code>${DEFAULT-VALUE}</code> <a href="#_predefined_variables">variable</a> in the <code>description</code> of the option or positional parameter and picocli will <a href="#_show_default_values">show</a> the actual default value.</p>
</div>
</div>
<div class="sect2">
<h3 id="_field_values"><a class="anchor" href="#_field_values"></a>5.2. Field Values</h3>
<div class="paragraph">
<p>For annotated fields, it is possible to declare the field with a value:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"The count (default: ${DEFAULT-VALUE})"</span><span class="o">)</span>
<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">123</span><span class="o">;</span> <span class="c1">// default value is 123</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"The count (default: \${DEFAULT-VALUE})"</span><span class="p">])</span>
<span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">123</span> <span class="c1">// default value is 123</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Defining a default value by assigning a value at the field declaration has limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>when the option is used in an argument group, the usage help <a href="#_default_values_in_argument_groups">cannot show the default value</a></p>
</li>
<li>
<p>picocli&#8217;s annotation processors can only detect default values in annotations, not in the field declaration. Your application may not work correctly with future features like documentation generated from the annotations.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_default_provider"><a class="anchor" href="#_default_provider"></a>5.3. Default Provider</h3>
<div class="paragraph">
<p>Finally, you can specify a default provider in the <code>@Command</code> annotation:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">defaultValueProvider</span> <span class="o">=</span> <span class="nc">MyDefaultProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyCommand</span> <span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">defaultValueProvider</span> <span class="p">=</span> <span class="nc">MyDefaultProvider</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MyCommand</span> <span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default provider allows you to get default values from a configuration file or some other central place.
Default providers need to implement the <code>picocli.CommandLine.IDefaultValueProvider</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IDefaultValueProvider</span> <span class="o">{</span>

    <span class="cm">/**
     * Returns the default value for an option or positional parameter or {@code null}.
     * The returned value is converted to the type of the option/positional parameter
     * via the same type converter used when populating this option/positional
     * parameter from a command line argument.
     *
     * @param argSpec the option or positional parameter, never {@code null}
     * @return the default value for the option or positional parameter, or {@code null} if
     *       this provider has no default value for the specified option or positional parameter
     * @throws Exception when there was a problem obtaining the default value
     */</span>
    <span class="nc">String</span> <span class="nf">defaultValue</span><span class="o">(</span><span class="nc">ArgSpec</span> <span class="n">argSpec</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See the
<a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/defaultprovider/">default provider examples</a>
for example implementations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_propertiesdefaultprovider"><a class="anchor" href="#_propertiesdefaultprovider"></a>5.4. PropertiesDefaultProvider</h3>
<div class="paragraph">
<p>From picocli 4.1, applications can use the built-in <code>PropertiesDefaultProvider</code>
implementation that loads default values from a properties file.</p>
</div>
<div class="paragraph">
<p>By default, this implementation tries to find a properties file named <code>.${COMMAND-NAME}.properties</code> in the user home directory, where <code>${COMMAND-NAME}</code> is the name of the command. If a command has aliases in addition to its name, these aliases are also used to try to find the properties file. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine.PropertiesDefaultProvider</span><span class="o">;</span>
<span class="c1">// ...</span>
<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git"</span><span class="o">,</span> <span class="n">defaultValueProvider</span> <span class="o">=</span> <span class="nc">PropertiesDefaultProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.PropertiesDefaultProvider;</span>
<span class="c1">// ...</span>
<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"git"</span><span class="p">,</span> <span class="n">defaultValueProvider</span> <span class="p">=</span> <span class="nc">PropertiesDefaultProvider</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="p">{</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above will try to load default values from <code>new File(System.getProperty("user.home"), ".git.properties")</code>.
The location of the properties file can also be controlled with system property <code>"picocli.defaults.${COMMAND-NAME}.path"</code> (<code>"picocli.defaults.git.path"</code> in this example), in which case the value of the property must be the path to the file containing the default values.</p>
</div>
<div class="paragraph">
<p>The location of the properties file may also be specified programmatically. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyCommand</span><span class="o">());</span>
<span class="nc">File</span> <span class="n">defaultsFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"path/to/config/mycommand.properties"</span><span class="o">);</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">setDefaultValueProvider</span><span class="o">(</span><span class="k">new</span> <span class="nc">PropertiesDefaultProvider</span><span class="o">(</span><span class="n">defaultsFile</span><span class="o">));</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyCommand</span><span class="p">())</span>
<span class="kd">val</span> <span class="py">defaultsFile</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="s">"path/to/config/mycommand.properties"</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">defaultValueProvider</span> <span class="p">=</span> <span class="nc">PropertiesDefaultProvider</span><span class="p">(</span><span class="n">defaultsFile</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_propertiesdefaultprovider_format"><a class="anchor" href="#_propertiesdefaultprovider_format"></a>5.4.1. PropertiesDefaultProvider Format</h4>
<div class="paragraph">
<p>The <code>PropertiesDefaultProvider</code> expects the properties file to be in the standard java <code>.properties</code> <a href="https://en.wikipedia.org/wiki/.properties">format</a>.</p>
</div>
<div class="paragraph">
<p>For options, the key is either the <a href="https://picocli.info/apidocs/picocli/CommandLine.Option.html#descriptionKey--">descriptionKey</a>,
or the option&#8217;s <a href="https://picocli.info/apidocs/picocli/CommandLine.Model.OptionSpec.html#longestName--">longest name</a>, without the prefix. So, for an option <code>--verbose</code>, the key would be <code>verbose</code>, and for an option <code>/F</code>, the key would be <code>F</code>.</p>
</div>
<div class="paragraph">
<p>For positional parameters, the key is either the <a href="https://picocli.info/apidocs/picocli/CommandLine.Parameters.html#descriptionKey--">descriptionKey</a>,
or the positional parameter&#8217;s <a href="https://picocli.info/apidocs/picocli/CommandLine.Parameters.html#paramLabel--">param label</a>.</p>
</div>
<div class="paragraph">
<p>End users may not know what the <code>descriptionKey</code> of your options and positional parameters are, so be sure  to document that with your application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_subcommands_default_values"><a class="anchor" href="#_subcommands_default_values"></a>5.4.2. Subcommands Default Values</h4>
<div class="paragraph">
<p>The default values for options and positional parameters of subcommands can be included in the
properties file for the top-level command, so that end users need to maintain only a single file.
This can be achieved by prefixing the keys for the options and positional parameters
with their command&#8217;s qualified name.
For example, to give the  <code>git commit</code> command&#8217;s <code>--cleanup</code> option a
default value of <code>strip</code>, define a key of <code>git.commit.cleanup</code> and assign
it a default value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code># /home/remko/.git.properties
git.commit.cleanup = strip</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fallbackValue-annotation"><a class="anchor" href="#fallbackValue-annotation"></a>5.5. <code>fallbackValue</code> Annotation</h3>
<div class="paragraph">
<p>If an option is defined with <code>arity = "0..1"</code>, it <a href="#_optional_values">may or may not have a parameter value</a>.
If such an option is specified without a value on the command line, it is assigned the fallback value.</p>
</div>
<div class="paragraph">
<p>The <code>fallbackValue</code> annotation attribute was introduced in picocli 4.0; prior to this, (from picocli 2.3) an empty String was assigned.</p>
</div>
<div class="paragraph">
<p>This is different from the <code>defaultValue</code>, which is assigned if the option is not specified at all on the command line.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">FallbackValueDemo</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">,</span>
            <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"-1"</span><span class="o">,</span> <span class="n">fallbackValue</span> <span class="o">=</span> <span class="s">"-2"</span><span class="o">,</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"Option with optional parameter. Default: ${DEFAULT-VALUE}, "</span> <span class="o">+</span>
                          <span class="s">"if specified without parameter: ${FALLBACK-VALUE}"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"x = %s%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">FallbackValueDemo</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">FallbackValueDemo</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span>
            <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"-1"</span><span class="p">,</span> <span class="n">fallbackValue</span> <span class="p">=</span> <span class="s">"-2"</span><span class="p">,</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option with optional parameter. Default: \${DEFAULT-VALUE}, "</span> <span class="p">+</span>
                           <span class="s">"if specified without parameter: \${FALLBACK-VALUE}"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="nf">println</span><span class="p">(</span><span class="s">"x = $x"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">FallbackValueDemo</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Gives the following results:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java FallbackValueDemo <span class="nt">-x</span> 100
x <span class="o">=</span> 100

java FallbackValueDemo <span class="nt">-x</span>
x <span class="o">=</span> <span class="nt">-2</span>

java FallbackValueDemo
x <span class="o">=</span> <span class="nt">-1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Any String value is converted to the type of the option before it is assigned to the option. Options and positional parameters may define a <a href="#_custom_type_converters">custom type converter</a> if necessary.</p>
</div>
<div class="paragraph">
<p>Note that the option description may contain the <code>${FALLBACK-VALUE}</code> <a href="#_predefined_variables">variable</a> which will be replaced with the actual fallback value when the usage help is shown.</p>
</div>
<div class="paragraph">
<p><a href="#_boolean_options">Boolean options</a> can also define a <code>fallbackValue</code> to specify the value that should be set when the option is matched on the command line, regardless of the default value. This can be useful when the default is configurable by the end user, for example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_was_a_value_defaulted"><a class="anchor" href="#_was_a_value_defaulted"></a>5.6. Was a Value Defaulted?</h3>
<div class="paragraph">
<p>Sometimes an application is interested in knowing whether an option value was specified on the command line, or whether the default value was assigned.</p>
</div>
<div class="paragraph">
<p>You can use <code>ParseResult::hasMatchedOption</code> to detect whether an option was actually matched on the command line,
and <code>ParseResult::matchedOptionValue</code> to get the (type-converted) value that was specified on the command line.
<code>OptionSpec::getValue</code> will return the value assigned (which may be a command line argument or may be the default value).</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"defaults"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"defaults 0.1"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DefaultValueDemo</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"20"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>

    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ParseResult</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">().</span><span class="na">getParseResult</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="nc">OptionSpec</span> <span class="n">option</span> <span class="o">:</span> <span class="n">spec</span><span class="o">.</span><span class="na">options</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="na">longestName</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%s was specified: %s%n"</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">pr</span><span class="o">.</span><span class="na">hasMatchedOption</span><span class="o">(</span><span class="n">option</span><span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%s=%s (-1 means this option was not matched on command line)%n"</span><span class="o">,</span>
                    <span class="n">name</span><span class="o">,</span> <span class="n">pr</span><span class="o">.</span><span class="na">matchedOptionValue</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%s=%s (arg value or default)%n"</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">option</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultValueDemo</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"defaults"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"defaults 0.1"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">DefaultValueDemo</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">10</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"20"</span><span class="p">)</span>
    <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Spec</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">pr</span><span class="p">:</span> <span class="nc">ParseResult</span> <span class="p">=</span> <span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">().</span><span class="n">parseResult</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">option</span> <span class="k">in</span> <span class="n">spec</span><span class="p">.</span><span class="nf">options</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">option</span><span class="p">.</span><span class="nf">longestName</span><span class="p">()</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"$name was specified: ${pr.hasMatchedOption(option)}"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"$name=${pr.matchedOptionValue(name, -1)} "</span> <span class="p">+</span>
                    <span class="s">"(-1 means this option was not matched on command line)"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"$name=${option.getValue&lt;T&gt;()} (arg value or default)"</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">DefaultValueDemo</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_values"><a class="anchor" href="#_multiple_values"></a>6. Multiple Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Multi-valued options and positional parameters are annotated fields that can capture multiple values from the command line.</p>
</div>
<div class="sect2">
<h3 id="_multiple_occurrences"><a class="anchor" href="#_multiple_occurrences"></a>6.1. Multiple Occurrences</h3>
<div class="sect3">
<h4 id="_repeated_options"><a class="anchor" href="#_repeated_options"></a>6.1.1. Repeated Options</h4>
<div class="paragraph">
<p>The simplest way to create a multi-valued option is to declare an annotated field whose type is an array, collection or a map.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-option"</span><span class="o">)</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-option"</span><span class="p">])</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">values</span><span class="p">:</span> <span class="nc">IntArray</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Users may specify the same option multiple times. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -option 111 -option 222 -option 333</pre>
</div>
</div>
<div class="paragraph">
<p>Each value is appended to the array or collection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_multiple_positional_parameters"><a class="anchor" href="#_multiple_positional_parameters"></a>6.1.2. Multiple Positional Parameters</h4>
<div class="paragraph">
<p>Similarly for multi-valued positional parameters:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Parameters</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">TimeUnit</span><span class="o">&gt;</span> <span class="n">units</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Parameters</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">units</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">TimeUnit</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Users may specify multiple positional parameters. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; SECONDS HOURS DAYS</pre>
</div>
</div>
<div class="paragraph">
<p>Again, each value is appended to the array or collection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_repeated_boolean_options"><a class="anchor" href="#_repeated_boolean_options"></a>6.1.3. Repeated Boolean Options</h4>
<div class="paragraph">
<p>Boolean options with multiple values are supported as of picocli 2.1.0.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-v"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="o">,</span>
                                      <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="o">})</span>
<span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Specify multiple -v options to increase verbosity."</span><span class="p">,</span>
                                        <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="p">])</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">verbosity</span><span class="p">:</span> <span class="nc">BooleanArray</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Users may specify multiple boolean flag options without parameters. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -v -v -v -vvv</pre>
</div>
</div>
<div class="paragraph">
<p>The above example results in six <code>true</code> values being added to the <code>verbosity</code> array.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_split_regex"><a class="anchor" href="#_split_regex"></a>6.2. Split Regex</h3>
<div class="paragraph">
<p>Options and parameters may also specify a <code>split</code> regular expression used to split each option parameter into smaller substrings.
Each of these substrings is converted to the type of the collection or array. See <a href="#_arrays_and_collections">Arrays and Collections</a>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-option"</span><span class="o">,</span> <span class="n">split</span> <span class="o">=</span> <span class="s">","</span><span class="o">)</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-option"</span><span class="p">],</span> <span class="n">split</span> <span class="p">=</span> <span class="s">","</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">values</span><span class="p">:</span> <span class="nc">IntArray</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A single command line argument like the following will be split up and three <code>int</code> values are added to the array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>-option 111,222,333</pre>
</div>
</div>
<div class="paragraph">
<p>Similarly for <a href="#_maps">Maps</a>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-fix"</span><span class="o">,</span> <span class="n">split</span> <span class="o">=</span> <span class="s">"\\|"</span><span class="o">,</span> <span class="n">splitSynopsisLabel</span> <span class="o">=</span> <span class="s">"|"</span><span class="o">)</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">message</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-fix"</span><span class="p">],</span> <span class="n">split</span> <span class="p">=</span> <span class="s">"\\|"</span><span class="p">,</span> <span class="n">splitSynopsisLabel</span> <span class="p">=</span> <span class="s">"|"</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">message</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above option, command line arguments like the following are interpreted as a set of key-value pairs instead of a single string:</p>
</div>
<div class="listingblock">
<div class="title">Note: end users need to quote the option parameter to prevent the vertical bar <code>|</code> characters from being interpreted by the shell as "pipe" directives to connect processes.</div>
<div class="content">
<pre>-fix "8=FIX.4.4|9=69|35=A|49=MBT|56=TargetCompID|34=9|52=20130625-04:05:32.682|98=0|108=30|10=052"</pre>
</div>
</div>
<div class="paragraph">
<p>The above input results in the <code>message</code> field being assigned a <code>LinkedHashMap</code> with the following key-value pairs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{8=FIX.4.4, 9=69, 35=A, 49=MBT, 56=TargetCompID, 34=9, 52=20130625-04:05:32.682, 98=0, 108=30, 10=052}</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_quoted_values">Quoted Values</a> for details on handling more complex cases.</p>
</div>
<div class="paragraph">
<p>Picocli 4.3 introduced the <code>splitSynopsisLabel</code> attribute to control what is shown in the synopsis of the usage help message.
See <a href="#_split_synopsis_label">Split Synopsis Label</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_arity"><a class="anchor" href="#_arity"></a>6.3. Arity</h3>
<div class="paragraph">
<p>Sometimes you want to define an option that requires more than one option parameter <em>for each option occurrence</em> on the command line.</p>
</div>
<div class="paragraph">
<p>The <code>arity</code> attribute lets you control exactly how many parameters to consume for each option occurrence.</p>
</div>
<div class="paragraph">
<p>The <code>arity</code> attribute can specify an exact number of required parameters, or a <em>range</em> with a minimum and a maximum number of parameters.
The maximum can be an exact upper bound, or it can be <code>"*"</code> to denote <em>any number</em> of parameters. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ArityDemo</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">arity</span> <span class="o">=</span> <span class="s">"1..3"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"one to three Files"</span><span class="o">)</span>
    <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-f"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"2"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"exactly two floating point numbers"</span><span class="o">)</span>
    <span class="kt">double</span><span class="o">[]</span> <span class="n">doubles</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-s"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"1..*"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"at least one string"</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">strings</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">ArityDemo</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">arity</span> <span class="p">=</span> <span class="s">"1..3"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"one to three Files"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"exactly two floating point numbers"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">doubles</span><span class="p">:</span> <span class="nc">DoubleArray</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-s"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"1..*"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"at least one string"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">strings</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>MissingParameterException</code> is thrown when fewer than the minimum number of parameters is specified on the command line.</p>
</div>
<div class="paragraph">
<p>Once the minimum number of parameters is consumed, picocli will check each subsequent command line argument to see whether it is an additional parameter, or a new option. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ArityDemo -s A B C -f 1.0 2.0 /file1 /file2</pre>
</div>
</div>
<div class="paragraph">
<p>Option <code>-s</code> has arity <code>"1..*"</code> but instead of consuming all parameters,
the <code>-f</code> argument is recognized as a separate option.</p>
</div>
</div>
<div class="sect2">
<h3 id="_variable_arity_limitations"><a class="anchor" href="#_variable_arity_limitations"></a>6.4. Variable Arity Limitations</h3>
<div class="sect3">
<h4 id="_variable_arity_options_and_unknown_options"><a class="anchor" href="#_variable_arity_options_and_unknown_options"></a>6.4.1. Variable Arity Options and Unknown Options</h4>
<div class="paragraph">
<p>As mentioned in the <a href="#_arity">previous section</a>, while processing parameters for an option with variable arity, when a known option, a subcommand, or the <a href="#_double_dash">end-of-options delimiter</a> is encountered, picocli will stop adding parameters to the variable arity option.</p>
</div>
<div class="paragraph">
<p>However, by default the picocli parser does not give special treatment to <a href="#_unknown_options">unknown options</a> (values that "look like" an option) when processing parameters for an option with variable arity.
Such values are simply consumed by the option with variable arity. From picocli 4.4 this is <a href="#_option_parameters_resembling_options">configurable</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_variable_arity_options_and_positional_parameters"><a class="anchor" href="#_variable_arity_options_and_positional_parameters"></a>6.4.2. Variable Arity Options and Positional Parameters</h4>
<div class="paragraph">
<p>Be careful when defining commands that have both an option with variable arity (like <code>arity = "0..*"</code>) and a positional parameter.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The picocli parser is "greedy" when it handles option parameters for options with variable arity: it looks at the value following the option name, and if that value can be taken as a parameter (not another option or subcommand, and max arity is not reached yet) then it will process the value as a parameter for that option. This may not always be what you want.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Ambiguous</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"The file (required)."</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..*"</span><span class="o">,</span>
      <span class="n">description</span> <span class="o">=</span> <span class="s">"Option with optional parameters"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">values</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Ambiguous</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"The file (required)."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..*"</span><span class="p">,</span>
      <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option with optional parameters"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">values</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When <code>-y a b c path/to/file</code> is specified on the command line, this results in an error: <code>Missing required parameter: &lt;file&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Users can use the <a href="#_double_dash">end-of-options delimiter</a> and disambiguate the input with
<code>-y a b c &dash;&dash; VALUE</code>, but this may not be obvious to many users.
One idea is to <a href="#_show_end_of_options">show the end-of-options</a> delimiter in the usage help.</p>
</div>
<div class="paragraph">
<p>A better alternative may be to redesign your command to avoid the ambiguity altogether.
One idea is to use the <a href="#_default_arity">default arity</a> (<code>arity = "1"</code> in our example) and use the <a href="#_split_regex">split</a> attribute to allow users to specify multiple values in a single argument like <code>a,b,c</code>.
If <code>-y</code> takes only a single parameter, then user input like <code>-y a,b,c path/to/file</code> is no longer ambiguous.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_default_arity"><a class="anchor" href="#_default_arity"></a>6.5. Default Arity</h3>
<div class="paragraph">
<p>If no <code>arity</code> is specified, the number of parameters depends on the field&#8217;s type.</p>
</div>
<div class="sect3">
<h4 id="_option_arity"><a class="anchor" href="#_option_arity"></a>6.5.1. Option Arity</h4>
<table class="tableblock frame-all grid-cols stretch">
<caption class="title">Table 1. Default <code>arity</code> for <code>@Option</code> fields</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 5%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">@Option Field Type</th>
<th class="tableblock halign-left valign-top">Default Arity</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean options by default don&#8217;t require an option parameter. The field is set to the opposite of its default value when the option name is recognized. (This can be <a href="#_toggle_boolean_flags">configured</a>.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-valued type (e.g., <code>int</code>, <code>String</code>, <code>File</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The option name must be followed by a value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-valued type (arrays, collections or maps)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The option name must be followed by a value.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Prior to picocli 2.0, multi-valued options used to greedily consume as many arguments as possible until
encountering another option or subcommand.
If your application relies on the previous behaviour, you need to explicitly specify an option arity of <code>0..*</code> when migrating to picocli 2.0.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_positional_parameter_arity"><a class="anchor" href="#_positional_parameter_arity"></a>6.5.2. Positional Parameter Arity</h4>
<table class="tableblock frame-all grid-cols stretch">
<caption class="title">Table 2. Default <code>arity</code> for <code>@Parameters</code> fields</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 5%;">
<col style="width: 65%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">@Parameters Field Type</th>
<th class="tableblock halign-left valign-top">Default Arity</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Positional parameters of type <code>boolean</code> or <code>Boolean</code> require a value. Only <code>true</code> or <code>false</code> (case insensitive) are valid values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-valued type (e.g., <code>int</code>, <code>String</code>, <code>File</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One parameter required for each position.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-valued type (arrays, collections or maps)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For multi-valued positional parameters (arrays, collections or maps), values are optional, not <a href="#_required_parameters">required</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>@Parameters</code> fields are applied to a command line argument if their index matches the argument&#8217;s position.
The default index is <code>*</code>, meaning all positions.
A <code>@Parameters</code> field with <code>index = "*"</code> is applied multiple times: once for each positional parameter on the command line.</p>
</div>
<div class="paragraph">
<p>When a <code>@Parameters</code> field is applied (because its index matches the index of the positional parameter), the field may consume zero, one or more arguments, depending on its arity.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optional_values"><a class="anchor" href="#_optional_values"></a>6.6. Optional Values</h3>
<div class="sect3">
<h4 id="_optional_option_parameters"><a class="anchor" href="#_optional_option_parameters"></a>6.6.1. Optional Option Parameters</h4>
<div class="paragraph">
<p>When an option is defined with <code>arity = "0..1"</code>, it may or not have a parameter value.</p>
</div>
<div class="paragraph">
<p>The <a href="#fallbackValue-annotation">fallback value</a> determines what value is assigned when the option is specified without a value, while the <a href="#defaultValue-annotation">default value</a> determines what value is assigned when the option is not specified at all.</p>
</div>
</div>
<div class="sect3">
<h4 id="_optional_parameter_use_cases"><a class="anchor" href="#_optional_parameter_use_cases"></a>6.6.2. Optional Parameter Use Cases</h4>
<div class="paragraph">
<p>This feature is commonly used when an application wants to combine two options into one:
the presence or absence of the option can be used like a boolean flag to trigger some behaviour, and the option value can be used to modify this behaviour.</p>
</div>
<div class="paragraph">
<p>An example use case is an option that switches on logging when present, with an optional value to set the log level. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--syslog"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"OFF"</span><span class="o">,</span> <span class="n">fallbackValue</span> <span class="o">=</span> <span class="s">"INFO"</span><span class="o">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"When specified without arguments, start sending syslog messages at INFO level."</span><span class="o">,</span>
        <span class="s">"If absent, no messages are sent to syslog."</span><span class="o">,</span>
        <span class="s">"Optionally specify a severity value. Valid values: ${COMPLETION-CANDIDATES}."</span><span class="o">})</span>
<span class="nc">MyLogLevel</span> <span class="n">syslogLevel</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--syslog"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"OFF"</span><span class="p">,</span> <span class="n">fallbackValue</span> <span class="p">=</span> <span class="s">"INFO"</span><span class="p">,</span>
    <span class="n">description</span> <span class="p">=</span> <span class="p">[</span>
        <span class="s">"When specified without arguments, start sending syslog messages at INFO level."</span><span class="p">,</span>
        <span class="s">"If absent, no messages are sent to syslog."</span><span class="p">,</span>
        <span class="s">"Optionally specify a severity value. Valid values: \${COMPLETION-CANDIDATES}."</span><span class="p">])</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">syslogLevel</span><span class="p">:</span> <span class="nc">MyLogLevel</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another example use case is <a href="#_optionally_interactive">password options</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_optional_parameter_limitations"><a class="anchor" href="#_optional_parameter_limitations"></a>6.6.3. Optional Parameter Limitations</h4>
<div class="paragraph">
<p>Be careful when defining commands that have both an option with an optional parameter and a positional parameter.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The picocli parser is "greedy" when it handles optional parameters: it looks at the value following the option name, and if that value is likely to be a parameter (not another option or subcommand) then it will process the value as a parameter for that option. This may not always be what you want.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Ambiguous</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"The file (required)."</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">,</span>
      <span class="n">description</span> <span class="o">=</span> <span class="s">"Option with optional parameter"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Ambiguous</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"The file (required)."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option with optional parameter"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">value</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When <code>-x VALUE</code> is specified on the command line, this results in an error: <code>Missing required parameter: &lt;file&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Users can use the <a href="#_double_dash">end-of-options delimiter</a> and disambiguate the input with
<code>-x &dash;&dash; VALUE</code>, but this may not be obvious to many users.
One idea is to <a href="#_show_end_of_options">show the end-of-options</a> delimiter in the usage help.
Another idea is to make use of the <a href="#IParameterPreprocessor_Parser_Plugin">IParameterPreprocessor Parser Plugin</a> introduced with picocli 4.6.</p>
</div>
<div class="paragraph">
<p>An alternative is to avoid the use of optional parameters and use the default arity in this scenario to eliminate the ambiguity altogether.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_required_arguments"><a class="anchor" href="#_required_arguments"></a>7. Required Arguments</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_required_options"><a class="anchor" href="#_required_options"></a>7.1. Required Options</h3>
<div class="paragraph">
<p>Options can be marked <code>required</code> to make it mandatory for the user to specify them on the command line. When a required option is not specified, a <code>MissingParameterException</code> is thrown from the <code>parse</code> method. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MandatoryOption</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-n"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"mandatory number"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">number</span><span class="o">;</span>

    <span class="nd">@Parameters</span>
    <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MandatoryOption</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-n"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"mandatory number"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">number</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Parameters</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following command line arguments would result in an exception complaining that <code>number</code> is missing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// invalid: missing option -n
&lt;command&gt; file1 file2 file3</pre>
</div>
</div>
<div class="paragraph">
<p>The following command line arguments would be accepted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// valid: required option -n has a value
&lt;command&gt; -n 123 file1 file2 file3</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_required_parameters"><a class="anchor" href="#_required_parameters"></a>7.2. Required Parameters</h3>
<div class="paragraph">
<p>Single-value <code>@Parameters</code> are always mandatory, because single-value positional parameters <a href="#_positional_parameter_arity">have <code>arity = "1"</code></a> by default.</p>
</div>
<div class="paragraph">
<p>The <code>arity</code> attribute can be used to make multi-value <code>@Parameters</code> mandatory:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BothOptionAndParametersMandatory</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">arity</span> <span class="o">=</span> <span class="s">"1..*"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"at least one File"</span><span class="o">)</span>
    <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-n"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"mandatory number"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">number</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">BothOptionAndParametersMandatory</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">arity</span> <span class="p">=</span> <span class="s">"1..*"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"at least one File"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-n"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"mandatory number"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">number</span> <span class="p">=</span> <span class="mi">0</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following command line arguments would result in an exception complaining that <code>files</code> are missing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// invalid: missing file parameters
&lt;command&gt; -n 123</pre>
</div>
</div>
<div class="paragraph">
<p>The following command line arguments would be accepted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// valid: both required fields have a value
&lt;command&gt; -n 123 file1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_options_with_an_optional_parameter"><a class="anchor" href="#_options_with_an_optional_parameter"></a>7.3. Options with an Optional Parameter</h3>
<div class="paragraph">
<p>See <a href="#_optional_values">Optional Values</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_argument_groups"><a class="anchor" href="#_argument_groups"></a>8. Argument Groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli 4.0 introduces a new <code>@ArgGroup</code> annotation and its <code>ArgGroupSpec</code> programmatic equivalent.</p>
</div>
<div class="paragraph">
<p>Argument Groups can be used to define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mutually exclusive options</p>
</li>
<li>
<p>options that must co-occur (dependent options)</p>
</li>
<li>
<p>option sections in the usage help message</p>
</li>
<li>
<p>repeating composite arguments</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a group using the annotations API, annotate a field or method with <code>@ArgGroup</code>.
The field&#8217;s type refers to the class containing the options and positional parameters in the group.
(For annotated interface methods this would be the return type, for annotated setter methods in a concrete class this would be the setter&#8217;s parameter type.)</p>
</div>
<div class="paragraph">
<p>Picocli will instantiate this class when needed to capture command line argument values in the <code>@Option</code> and <code>@Parameters</code>-annotated fields and methods of this class.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="#_inherited_options">Inherited Options</a> currently cannot be used in Argument Groups.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_mutually_exclusive_options"><a class="anchor" href="#_mutually_exclusive_options"></a>8.1. Mutually Exclusive Options</h3>
<div class="paragraph">
<p>Annotate a field or method with <code>@ArgGroup(exclusive = true)</code> to create a group of mutually exclusive options and positional parameters. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"exclusivedemo"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MutuallyExclusiveOptionsDemo</span> <span class="o">{</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span>
    <span class="nc">Exclusive</span> <span class="n">exclusive</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exclusive</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">a</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">b</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"exclusivedemo"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MutuallyExclusiveOptionsDemo</span> <span class="p">{</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">exclusive</span><span class="p">:</span> <span class="nc">Exclusive</span>

    <span class="kd">class</span> <span class="nc">Exclusive</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">c</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example defines a command with mutually exclusive options <code>-a</code>, <code>-b</code> and <code>-c</code>.</p>
</div>
<div class="paragraph">
<p>The group itself has a <code>multiplicity</code> attribute that defines how many times the group may be specified within the command.
The default is <code>multiplicity = "0..1"</code>, meaning that by default a group may be omitted or specified once.
In this example the group has <code>multiplicity = "1"</code>, so the group must occur once: one of the exclusive options must occur on the command line.</p>
</div>
<div class="paragraph">
<p>The synopsis of this command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: exclusivedemo (-a=&lt;a&gt; | -b=&lt;b&gt; | -c=&lt;c&gt;)</pre>
</div>
</div>
<div class="paragraph">
<p>When one of the options in the group is matched, picocli creates an instance of the <code>Exclusive</code> class and assigns it to the <code>@ArgGroup</code>-annotated <code>exclusive</code> field.</p>
</div>
<div class="paragraph">
<p>Note that the options are defined as <code>required = true</code>; this means required <em>within the group</em>, not required within the command.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
As of picocli 4.1.2, all options in an exclusive group are automatically considered required, even if they are not marked as <code>required = true</code> in the annotations. Applications using older versions of picocli should mark all options in exclusive groups as required.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Picocli will validate the arguments and throw a <code>MutuallyExclusiveArgsException</code> if multiple mutually exclusive arguments were specified. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">MutuallyExclusiveOptionsDemo</span> <span class="n">example</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MutuallyExclusiveOptionsDemo</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">example</span><span class="o">);</span>

<span class="k">try</span> <span class="o">{</span>
    <span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-a=1"</span><span class="o">,</span> <span class="s">"-b=2"</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">MutuallyExclusiveArgsException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">assert</span> <span class="s">"Error: -a=&lt;a&gt;, -b=&lt;b&gt; are mutually exclusive (specify only one)"</span>
            <span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">example</span> <span class="p">=</span> <span class="nc">MutuallyExclusiveOptionsDemo</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-a=1"</span><span class="p">,</span> <span class="s">"-b=2"</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">MutuallyExclusiveArgsException</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">assert</span><span class="p">(</span><span class="s">"Error: -a=&lt;a&gt;, -b=&lt;b&gt; are mutually exclusive (specify only one)"</span> <span class="p">==</span> <span class="n">ex</span><span class="p">.</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For the above group, only one of the options can be specified. Any other combination of options, or the absence of options, is invalid.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Picocli will not initialize the <code>@ArgGroup</code>-annotated field
if none of the group options is specified on the command line.
For optional groups (groups with <code>multiplicity = "0..1"</code> - the default) this means that the <code>@ArgGroup</code>-annotated field may remain <code>null</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mutually_dependent_options"><a class="anchor" href="#_mutually_dependent_options"></a>8.2. Mutually Dependent Options</h3>
<div class="sect3">
<h4 id="_overview_2"><a class="anchor" href="#_overview_2"></a>8.2.1. Overview</h4>
<div class="paragraph">
<p>Annotate a field or method with <code>@ArgGroup(exclusive = false)</code> to create a group of dependent options and positional parameters that must co-occur. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"co-occur"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DependentOptionsDemo</span> <span class="o">{</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="nc">Dependent</span> <span class="n">dependent</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Dependent</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">a</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">b</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"co-occur"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">DependentOptionsDemo</span> <span class="p">{</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">dependent</span><span class="p">:</span> <span class="nc">Dependent</span>

    <span class="kd">class</span> <span class="nc">Dependent</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">c</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example defines a command with dependent options <code>-a</code>, <code>-b</code> and <code>-c</code> that must co-occur.</p>
</div>
<div class="paragraph">
<p>The group itself has a <code>multiplicity</code> attribute that defines how many times the group may be specified within the command.
In this example the group uses the default multiplicity, <code>multiplicity = "0..1"</code>, meaning that the group may be omitted or specified once.</p>
</div>
<div class="paragraph">
<p>The synopsis of this command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: co-occur [-a=&lt;a&gt; -b=&lt;b&gt; -c=&lt;c&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>When the first option in the group is matched, picocli creates an instance of the <code>Dependent</code> class and assigns it to the <code>@ArgGroup</code>-annotated <code>dependent</code> field.</p>
</div>
<div class="paragraph">
<p>Note that the options are defined as <code>required = true</code>; this means required <em>within the group</em>, not required within the command.</p>
</div>
<div class="paragraph">
<p>Picocli will validate the arguments and throw a <code>MissingParameterException</code> if not all dependent arguments were specified. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">DependentOptionsDemo</span> <span class="n">example</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DependentOptionsDemo</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">example</span><span class="o">);</span>

<span class="k">try</span> <span class="o">{</span>
    <span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-a=1"</span><span class="o">,</span> <span class="s">"-b=2"</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">MissingParameterException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">assert</span> <span class="s">"Error: Missing required argument(s): -c=&lt;c&gt;"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">example</span> <span class="p">=</span> <span class="nc">DependentOptionsDemo</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-a=1"</span><span class="p">,</span> <span class="s">"-b=2"</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">MissingParameterException</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">assert</span><span class="p">(</span><span class="s">"Error: Missing required argument(s): -c=&lt;c&gt;"</span> <span class="p">==</span> <span class="n">ex</span><span class="p">.</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Picocli will not initialize the <code>@ArgGroup</code>-annotated field
if none of the group options is specified on the command line.
For optional groups (groups with <code>multiplicity = "0..1"</code> - the default) this means that the <code>@ArgGroup</code>-annotated field may remain <code>null</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_non_required_options_in_mutually_dependent_groups"><a class="anchor" href="#_non_required_options_in_mutually_dependent_groups"></a>8.2.2. Non-Required Options in Mutually Dependent Groups</h4>
<div class="paragraph">
<p>In mutually dependent groups it is possible to have one or more options that are not required. This is different from <a href="#_mutually_exclusive_options">exclusive groups</a>, where all options are always required.</p>
</div>
<div class="paragraph">
<p>It is useful to be able to define a co-occurring group as <code>(-a -b [-c])</code> so that both <code>-a -b -c</code> and <code>-a -b</code> are valid on the command line, but not <code>-a -c</code> for example.
This can be implemented by marking the optional option with <code>required = false</code>, as in the below example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"co-occur-with-optional-options"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DependentWithOptionalOptionsDemo</span> <span class="o">{</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span>
    <span class="nc">DependentWithOptionalOptions</span> <span class="n">group</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DependentWithOptionalOptions</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>  <span class="kt">int</span> <span class="n">a</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>  <span class="kt">int</span> <span class="n">b</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="kt">int</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"co-occur-with-optional-options"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">DependentWithOptionalOptionsDemo</span> <span class="p">{</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">group</span><span class="p">:</span> <span class="nc">DependentWithOptionalOptions</span>

    <span class="kd">class</span> <span class="nc">DependentWithOptionalOptions</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>  <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>  <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span> <span class="kd">var</span> <span class="py">c</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>More than one option can be optional in mutually dependent groups, but it is recommended to have at least one required option in the group (or there is not much point in using a mutually dependent group).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_option_sections_in_usage_help"><a class="anchor" href="#_option_sections_in_usage_help"></a>8.3. Option Sections in Usage Help</h3>
<div class="sect3">
<h4 id="_use_heading_to_enable_option_sections"><a class="anchor" href="#_use_heading_to_enable_option_sections"></a>8.3.1. Use Heading to Enable Option Sections</h4>
<div class="paragraph">
<p>The example below uses groups to define options sections in the usage help.
When a group has a non-null <code>heading</code> (or <code>headingKey</code>), the options in the group are given the specified heading in the usage help message.
The <code>headingKey</code> attribute can be used to get the heading text from the command&#8217;s resource bundle.</p>
</div>
<div class="paragraph">
<p>This works for mutually exclusive or co-occurring groups, but it is also possible to define a group that does no validation but only creates an option section in the usage help.</p>
</div>
<div class="paragraph">
<p>Annotate a field or method with <code>@ArgGroup(validate = false)</code> to create a group for display purposes only. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"sectiondemo"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Section demo"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OptionSectionDemo</span> <span class="o">{</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">heading</span> <span class="o">=</span> <span class="s">"This is the first section%n"</span><span class="o">)</span>
    <span class="nc">Section1</span> <span class="n">section1</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Section1</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option A"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">a</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option B"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">b</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option C"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">heading</span> <span class="o">=</span> <span class="s">"This is the second section%n"</span><span class="o">)</span>
    <span class="nc">Section2</span> <span class="n">section2</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Section2</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option X"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option Y"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-z"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Option Z"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">z</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">OptionSectionDemo</span><span class="o">()).</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"sectiondemo"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Section demo"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">OptionSectionDemo</span> <span class="p">{</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">validate</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">heading</span> <span class="p">=</span> <span class="s">"This is the first section%n"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">section1</span><span class="p">:</span> <span class="nc">Section1</span>

    <span class="kd">class</span> <span class="nc">Section1</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option A"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option B"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option C"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">c</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">validate</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">heading</span> <span class="p">=</span> <span class="s">"This is the second section%n"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">section2</span><span class="p">:</span> <span class="nc">Section2</span>

    <span class="kd">class</span> <span class="nc">Section2</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option X"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option Y"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-z"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Option Z"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">z</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">OptionSectionDemo</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This prints the following usage help message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: sectiondemo [-a=&lt;a&gt;] [-b=&lt;b&gt;] [-c=&lt;c&gt;] [-x=&lt;x&gt;] [-y=&lt;y&gt;] [-z=&lt;z&gt;]
Section demo
This is the first section
  -a=&lt;a&gt;    Option A
  -b=&lt;b&gt;    Option B
  -c=&lt;c&gt;    Option C
This is the second section
  -x=&lt;x&gt;    Option X
  -y=&lt;y&gt;    Option Y
  -z=&lt;z&gt;    Option Z</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the heading text must end with <code>%n</code> to insert a newline between the heading text and the first option.
This is for consistency with other headings in the usage help, like <code>@Command(headerHeading = "Usage:%n", optionListHeading = "%nOptions:%n")</code>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Picocli will not initialize the <code>@ArgGroup</code>-annotated field
if none of the group options is specified on the command line.
For optional groups (groups with <code>multiplicity = "0..1"</code> - the default) this means that the <code>@ArgGroup</code>-annotated field may remain <code>null</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_option_section_order"><a class="anchor" href="#_option_section_order"></a>8.3.2. Option Section Order</h4>
<div class="paragraph">
<p>Options that are not in any argument group are always displayed before the option sections.</p>
</div>
<div class="paragraph">
<p>The ordering of option sections can be controlled with the <code>order</code> attribute. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"First%n"</span><span class="o">,</span> <span class="n">order</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span> <span class="nc">Section1</span> <span class="n">section1</span><span class="o">;</span>
<span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"Next%n"</span><span class="o">,</span>  <span class="n">order</span> <span class="o">=</span> <span class="mi">2</span><span class="o">)</span> <span class="nc">Section2</span> <span class="n">section2</span><span class="o">;</span>
<span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">heading</span> <span class="o">=</span> <span class="s">"Last%n"</span><span class="o">,</span>  <span class="n">order</span> <span class="o">=</span> <span class="mi">3</span><span class="o">)</span> <span class="nc">Section3</span> <span class="n">section3</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">heading</span> <span class="p">=</span> <span class="s">"First%n"</span><span class="p">,</span> <span class="n">order</span> <span class="p">=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">section1</span><span class="p">:</span> <span class="nc">Section1</span>
<span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">heading</span> <span class="p">=</span> <span class="s">"Next%n"</span><span class="p">,</span> <span class="n">order</span> <span class="p">=</span> <span class="mi">2</span><span class="p">)</span>  <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">section2</span><span class="p">:</span> <span class="nc">Section2</span>
<span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">heading</span> <span class="p">=</span> <span class="s">"Last%n"</span><span class="p">,</span> <span class="n">order</span> <span class="p">=</span> <span class="mi">3</span><span class="p">)</span>  <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">section3</span><span class="p">:</span> <span class="nc">Section3</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_repeating_composite_argument_groups"><a class="anchor" href="#_repeating_composite_argument_groups"></a>8.4. Repeating Composite Argument Groups</h3>
<div class="paragraph">
<p>The below example shows how groups can be composed of other groups, and how arrays and collections can be used to capture repeating groups (with a <code>multiplicity</code> greater than one):</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"repeating-composite-demo"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeGroupDemo</span> <span class="o">{</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"1..*"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Composite</span><span class="o">&gt;</span> <span class="n">composites</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Composite</span> <span class="o">{</span>
        <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">)</span>
        <span class="nc">Dependent</span> <span class="n">dependent</span><span class="o">;</span>

        <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span>
        <span class="nc">Exclusive</span> <span class="n">exclusive</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Dependent</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-a"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">a</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-b"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">b</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-c"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exclusive</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">x</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">y</span><span class="o">;</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-z"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">z</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"repeating-composite-demo"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">CompositeGroupDemo</span> <span class="p">{</span>
    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"1..*"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">composites</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">Composite</span><span class="p">&gt;</span>

    <span class="kd">class</span> <span class="nc">Composite</span> <span class="p">{</span>
        <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">)</span>
        <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">dependent</span><span class="p">:</span> <span class="nc">Dependent</span>

        <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">)</span>
        <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">exclusive</span><span class="p">:</span> <span class="nc">Exclusive</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">Dependent</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="mi">0</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">c</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">Exclusive</span> <span class="p">{</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="k">false</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="k">false</span>
        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-z"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span> <span class="kd">var</span> <span class="py">z</span> <span class="p">=</span> <span class="k">false</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the annotated <code>composites</code> field defines a composite group that must be specified at least once, and may be specified many times (<code>multiplicity = "1..*"</code>), on the command line. Notice that for multi-value groups the type of the <code>@ArgGroup</code>-annotated field must be a collection or an array to capture the multiple <code>Composite</code> instances that hold the values that were matched on the command line.</p>
</div>
<div class="paragraph">
<p>The synopsis of this command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: repeating-composite-demo ([-a=&lt;a&gt; -b=&lt;b&gt; -c=&lt;c&gt;] (-x | -y | -z))...</pre>
</div>
</div>
<div class="paragraph">
<p>Each time the group is matched, picocli creates an instance of the <code>Composite</code> class and adds it to the <code>composites</code> list.</p>
</div>
<div class="paragraph">
<p>The <code>Composite</code> class itself contains two groups: an optional (<code>multiplicity = "0..1"</code>) group of dependent options that must co-occur, and another group of mutually exclusive options, which is mandatory (<code>multiplicity = "1"</code>).</p>
</div>
<div class="paragraph">
<p>The below example illustrates:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CompositeGroupDemo</span> <span class="n">example</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CompositeGroupDemo</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">example</span><span class="o">);</span>

<span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-x"</span><span class="o">,</span> <span class="s">"-a=1"</span><span class="o">,</span> <span class="s">"-b=1"</span><span class="o">,</span> <span class="s">"-c=1"</span><span class="o">,</span> <span class="s">"-a=2"</span><span class="o">,</span> <span class="s">"-b=2"</span><span class="o">,</span> <span class="s">"-c=2"</span><span class="o">,</span> <span class="s">"-y"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">example</span><span class="o">.</span><span class="na">composites</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">2</span><span class="o">;</span>

<span class="nc">Composite</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="na">composites</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="na">exclusive</span><span class="o">.</span><span class="na">x</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="mi">1</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="mi">1</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">c</span> <span class="o">==</span> <span class="mi">1</span><span class="o">;</span>

<span class="nc">Composite</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="na">composites</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">c2</span><span class="o">.</span><span class="na">exclusive</span><span class="o">.</span><span class="na">y</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c2</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="mi">2</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c2</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="mi">2</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">c2</span><span class="o">.</span><span class="na">dependent</span><span class="o">.</span><span class="na">c</span> <span class="o">==</span> <span class="mi">2</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">example</span> <span class="p">=</span> <span class="nc">CompositeGroupDemo</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>

<span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-x"</span><span class="p">,</span> <span class="s">"-a=1"</span><span class="p">,</span> <span class="s">"-b=1"</span><span class="p">,</span> <span class="s">"-c=1"</span><span class="p">,</span> <span class="s">"-a=2"</span><span class="p">,</span> <span class="s">"-b=2"</span><span class="p">,</span> <span class="s">"-c=2"</span><span class="p">,</span> <span class="s">"-y"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">example</span><span class="p">.</span><span class="n">composites</span><span class="p">.</span><span class="n">size</span> <span class="p">==</span> <span class="mi">2</span><span class="p">)</span>

<span class="kd">val</span> <span class="py">c1</span> <span class="p">=</span> <span class="n">example</span><span class="p">.</span><span class="n">composites</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">exclusive</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">a</span> <span class="p">===</span> <span class="mi">1</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">b</span> <span class="p">===</span> <span class="mi">1</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">c</span> <span class="p">===</span> <span class="mi">1</span><span class="p">)</span>

<span class="kd">val</span> <span class="py">c2</span> <span class="p">=</span> <span class="n">example</span><span class="p">.</span><span class="n">composites</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">exclusive</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">a</span> <span class="p">===</span> <span class="mi">2</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">b</span> <span class="p">===</span> <span class="mi">2</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">dependent</span><span class="p">.</span><span class="n">c</span> <span class="p">===</span> <span class="mi">2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Picocli will not initialize the <code>@ArgGroup</code>-annotated field
if none of the group options is specified on the command line.
For optional groups (groups with <code>multiplicity = "0..1"</code> - the default) this means that the <code>@ArgGroup</code>-annotated field may remain <code>null</code>.
If the application assigned a non-<code>null</code> Collection in the field declaration (e.g., <code>@ArgGroup List&lt;Composite&gt; composites = new ArrayList&lt;&gt;();</code>), then the collection will remain empty if none of the group options is specified on the command line.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_default_values_in_argument_groups"><a class="anchor" href="#_default_values_in_argument_groups"></a>8.5. Default Values in Argument Groups</h3>
<div class="paragraph">
<p>The <a href="#_default_values">default values</a> of options in an argument group are applied when at least one option in the group is matched on the command line and picocli instantiates the user object of the group.</p>
</div>
<div class="paragraph">
<p>Picocli will not initialize the <code>@ArgGroup</code>-annotated field (and so no default values are applied) if none of the group options is specified on the command line.</p>
</div>
<div class="sect3">
<h4 id="_default_values_in_group_usage_help"><a class="anchor" href="#_default_values_in_group_usage_help"></a>8.5.1. Default Values in Group Usage Help</h4>
<div class="paragraph">
<p>When options are used in argument groups, they can only define default values via the <code>@Option(defaultValue = "&#8230;&#8203;")</code> annotation (not in the field declaration).</p>
</div>
<div class="paragraph">
<p>When defined this way, the <code>${DEFAULT-VALUE}</code> variable can be used to <a href="#_show_default_values">show the default value</a> in the description of options in an argument group. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">GoodGroup</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"123"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Default: ${DEFAULT-VALUE}"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"good"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"usage help shows the default value"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">GoodExample</span> <span class="o">{</span>
    <span class="nd">@ArgGroup</span> <span class="nc">GoodGroup</span> <span class="n">goodGroup</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">GoodExample</span><span class="o">()).</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">GoodGroup</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"123"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Default: \${DEFAULT-VALUE}"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"good"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"usage help shows the default value"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">GoodExample</span> <span class="p">{</span>
    <span class="nd">@ArgGroup</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">goodGroup</span><span class="p">:</span> <span class="nc">GoodGroup</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">GoodExample</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the default value is defined in the annotation, the usage help shows the correct default value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: good [[-x=&lt;x&gt;]]
usage help shows the default value
  -x=&lt;x&gt;    Default: 123</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Picocli will not be able to retrieve the default values that are defined by assigning a value in the declaration of an <code>@Option</code>-annotated field in a group. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BadGroup</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Default: ${DEFAULT-VALUE}"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">123</span><span class="o">;</span> <span class="c1">// value not found until `BadGroup` is instantiated</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"bad"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"usage help shows the wrong default value"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">BadExample</span> <span class="o">{</span>
    <span class="nd">@ArgGroup</span> <span class="nc">BadGroup</span> <span class="n">badGroup</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">BadExample</span><span class="o">()).</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">BadGroup</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Default: \${DEFAULT-VALUE}"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">123</span> <span class="c1">// value not found until `BadGroup` is instantiated</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"bad"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"usage help shows wrong default value"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">BadExample</span> <span class="p">{</span>
    <span class="nd">@ArgGroup</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">badGroup</span><span class="p">:</span> <span class="nc">BadGroup</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">BadExample</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the default value is defined in the field declaration and not in the annotation, usage help for the options in the group incorrectly shows <code>null</code> as the default value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: bad [[-x=&lt;x&gt;]]
usage help shows the wrong default value
  -x=&lt;x&gt;    Default: null</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_positional_parameters_2"><a class="anchor" href="#_positional_parameters_2"></a>8.6. Positional Parameters</h3>
<div class="paragraph">
<p>When a <code>@Parameters</code> positional parameter is part of a group, its <code>index</code> is the index <em>within the group</em>, not within the command.</p>
</div>
<div class="paragraph">
<p>Below is an example of an application that uses a repeating group of positional parameters:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"grades"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"grades 1.0"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Grades</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StudentGrade</span> <span class="o">{</span>
        <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
        <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span> <span class="nc">BigDecimal</span> <span class="n">grade</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">exclusive</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="s">"1..*"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">StudentGrade</span><span class="o">&gt;</span> <span class="n">gradeList</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">gradeList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">name</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">grade</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Grades</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"grades"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"grades 1.0"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Grades</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="kd">class</span> <span class="nc">StudentGrade</span> <span class="p">{</span>
        <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span>
        <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">grade</span><span class="p">:</span> <span class="nc">BigDecimal</span>
    <span class="p">}</span>

    <span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">exclusive</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">=</span> <span class="s">"1..*"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">gradeList</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">StudentGrade</span><span class="p">&gt;</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">gradeList</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="n">e</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"${e.name}: ${e.grade}"</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">System</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Grades</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the above program with this input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Alice 3.1 Betty 4.0 "X Ã A-12" 3.5 Zaphod 3.4</pre>
</div>
</div>
<div class="paragraph">
<p>Produces the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Alice: 3.1
Betty: 4.0
X Ã A-12: 3.5
Zaphod: 3.4</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_argument_group_limitations"><a class="anchor" href="#_argument_group_limitations"></a>8.7. Argument Group Limitations</h3>
<div class="ulist">
<ul>
<li>
<p>Options with the same name cannot be defined in multiple groups.
Similarly, it is not possible to define an option outside of a group with the same name as a different option that is part of a group.</p>
</li>
<li>
<p>Positional parameters in a single group work fine, but take care (or avoid) defining positional parameters in multiple groups or positional parameters in a group as well as outside a group.
Positional parameters are matched by index, and while the index of a group is reset when a new group multiple is encountered, the index of positional parameters outside a group only increases and is never reset.</p>
</li>
<li>
<p>Some relationships between options cannot be expressed with picocli argument groups.
In general, picocli argument groups can only express relationship for which you can write a command line synopsis with every option occurring only once.
For example, it is not possible to use argument groups to create a relationship with exclusive options <code>[-a | -b]</code>,
where <code>-a</code> requires another option <code>-c</code>: <code>[[-a] -c]</code>, while at the same time <code>-b</code> is independent of <code>-c</code>: <code>[-b] [-c]</code>.
The application may need to do some programmatic validation in such cases.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="execute"><a class="anchor" href="#execute"></a>9. Executing Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Parsing the command line arguments is the first step. A robust real-world application needs to handle a number of scenarios:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User input was invalid</p>
</li>
<li>
<p>User requested usage help (potentially for a subcommand)</p>
</li>
<li>
<p>User requested version help (potentially for a subcommand)</p>
</li>
<li>
<p>None of the above: we can run the business logic (potentially for a subcommand)</p>
</li>
<li>
<p>The business logic may throw an exception</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Picocli 4.0 introduces an <code>execute</code> method for handling all of the above scenarios in a single line of code. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>execute</code> method, application code can be <strong>extremely compact</strong>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// business logic</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"x=%s%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
        <span class="k">return</span> <span class="mi">123</span><span class="o">;</span> <span class="c1">// exit code</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// bootstrap the application</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"1.0"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span> <span class="c1">// business logic</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"x=$x"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">123</span> <span class="c1">// exit code</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span> <span class="c1">// bootstrap the application</span>
    <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Despite being only 15 lines long, this is a full-fledged application, with <a href="#_mixin_standard_help_options"><code>--help</code> and <code>--version</code></a> options in addition to the <code>-x</code> option.
The <code>execute</code> method will show the usage help or version information if requested by the user, and invalid user input will result
in a helpful <a href="#_handling_errors">error message</a>. If the user input was valid, the business logic is invoked.
Finally, the <code>execute</code> method returns an <a href="#_exit_code">exit status code</a> that can be used to call <code>System.exit</code> if desired.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A command is executable if its user object implements <code>Runnable</code> or <code>Callable</code>, or is a <code>@Command</code>-annotated <code>Method</code>. Examples follow below.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>execute</code> method replaces the older <code>run</code>, <code>call</code>, <code>invoke</code> and <code>parseWithHandlers</code> methods.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="#_diy_command_execution">DIY Command Execution</a> section shows an example of the boilerplate code that can be omitted with the <code>execute</code> method.</p>
</div>
<div class="sect2">
<h3 id="_exit_code"><a class="anchor" href="#_exit_code"></a>9.1. Exit Code</h3>
<div class="paragraph">
<p>Many command line applications return an <a href="https://en.wikipedia.org/wiki/Exit_status">exit code</a> to signify success or failure. Zero often means success, a non-zero exit code is often used for errors, but other than that, meanings differ per application.</p>
</div>
<div class="paragraph">
<p>The <code>CommandLine.execute</code> method introduced in picocli 4.0 returns an <code>int</code>, and applications can use this return value to call <code>System.exit</code> if desired. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
    <span class="nf">exitProcess</span><span class="p">(</span><span class="n">exitCode</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Older versions of picocli had some limited exit code support where picocli would call <code>System.exit</code>, but this is now deprecated.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_generating_an_exit_code"><a class="anchor" href="#_generating_an_exit_code"></a>9.2. Generating an Exit Code</h3>
<div class="paragraph">
<p><code>@Command</code>-annotated classes that implement <code>Callable</code> and <code>@Command</code>-<a href="#command-methods">annotated methods</a> can simply return an <code>int</code> or <code>Integer</code>, and this value will be returned from <code>CommandLine.execute</code>. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"greet"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Greet</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"hi"</span><span class="o">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// define a "shout" subcommand with a @Command-annotated method</span>
    <span class="nd">@Command</span>
    <span class="kt">int</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"HI!"</span><span class="o">);</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">assert</span> <span class="mi">1</span> <span class="o">==</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Greet</span><span class="o">()).</span><span class="na">execute</span><span class="o">();</span>
<span class="k">assert</span> <span class="mi">2</span> <span class="o">==</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Greet</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="s">"shout"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"greet"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Greet</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"hi"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="c1">// define a "shout" subcommand with a @Command-annotated method</span>
    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">shout</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"HI!"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">assert</span><span class="p">(</span><span class="mi">1</span> <span class="p">==</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Greet</span><span class="p">()).</span><span class="nf">execute</span><span class="p">())</span>
<span class="nf">assert</span><span class="p">(</span><span class="mi">2</span> <span class="p">==</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Greet</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(</span><span class="s">"shout"</span><span class="p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Commands with a user object that implements <code>Runnable</code> can implement the <code>IExitCodeGenerator</code> interface to generate an exit code. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"wave"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Gesture</span> <span class="kd">implements</span> <span class="nc">Runnable</span><span class="o">,</span> <span class="nc">IExitCodeGenerator</span> <span class="o">{</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"wave"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getExitCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">3</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">assert</span> <span class="mi">3</span> <span class="o">==</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Gesture</span><span class="o">()).</span><span class="na">execute</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"wave"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Gesture</span> <span class="p">:</span> <span class="nc">Runnable</span><span class="p">,</span> <span class="nc">IExitCodeGenerator</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"wave"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getExitCode</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">assert</span><span class="p">(</span><span class="mi">3</span> <span class="p">==</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Gesture</span><span class="p">()).</span><span class="nf">execute</span><span class="p">())</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exception_exit_codes"><a class="anchor" href="#_exception_exit_codes"></a>9.3. Exception Exit Codes</h3>
<div class="paragraph">
<p>By default, the <code>execute</code> method returns <code>CommandLine.ExitCode.OK</code> (<code>0</code>) on success, <code>CommandLine.ExitCode.SOFTWARE</code> (<code>1</code>) when an exception occurred in the Runnable, Callable or command method, and <code>CommandLine.ExitCode.USAGE</code> (<code>2</code>) for invalid input. (These are common values according to <a href="https://stackoverflow.com/questions/1101957/are-there-any-standard-exit-status-codes-in-linux/40484670#40484670">this StackOverflow answer</a>). This can be customized with the <code>@Command</code> annotation. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">exitCodeOnInvalidInput</span> <span class="o">=</span> <span class="mi">123</span><span class="o">,</span>
   <span class="n">exitCodeOnExecutionException</span> <span class="o">=</span> <span class="mi">456</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, applications can configure a <code>IExitCodeExceptionMapper</code> to map a specific exception to an exit code:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyMapper</span> <span class="kd">implements</span> <span class="nc">IExitCodeExceptionMapper</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getExitCode</span><span class="o">(</span><span class="nc">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">t</span> <span class="k">instanceof</span> <span class="nc">FileNotFoundException</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">74</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyMapper</span> <span class="p">:</span> <span class="nc">IExitCodeExceptionMapper</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getExitCode</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="k">is</span> <span class="nc">FileNotFoundException</span><span class="p">)</span> <span class="p">{</span>
            <span class="mi">74</span>
        <span class="p">}</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the end user specified invalid input, the <code>execute</code> method prints an error message followed by the usage help message of the command, and returns an exit code. This can be <a href="#_invalid_user_input">customized</a> by configuring a <code>IParameterExceptionHandler</code>.</p>
</div>
<div class="paragraph">
<p>If the business logic of the command throws an exception, the <code>execute</code> method prints the stack trace of the exception and returns an exit code. This can be customized by configuring a <code>IExecutionExceptionHandler</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usage_help_exit_code_section"><a class="anchor" href="#_usage_help_exit_code_section"></a>9.4. Usage Help Exit Code Section</h3>
<div class="paragraph">
<p>By default, the usage help message does not include exit code information.
Applications that call <code>System.exit</code> need to configure the usage help message to show exit code details,
either with the <code>exitCodeListHeading</code> and <code>exitCodeList</code> annotation attributes,
or programmatically by calling <code>UsageMessageSpec.exitCodeListHeading</code> and <code>UsageMessageSpec.exitCodeList</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="#_exit_code_list">Exit Code List</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_configuration"><a class="anchor" href="#_execution_configuration"></a>9.5. Execution Configuration</h3>
<div class="paragraph">
<p>The following methods can be used to configure the behaviour of the <code>execute</code> method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>get/setOut</p>
</li>
<li>
<p>get/setErr</p>
</li>
<li>
<p>get/setColorScheme</p>
</li>
<li>
<p>get/setExecutionStrategy</p>
</li>
<li>
<p>get/setParameterExceptionHandler</p>
</li>
<li>
<p>get/setExecutionExceptionHandler</p>
</li>
<li>
<p>get/setExitCodeExceptionMapper</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The above methods are not applicable with (and ignored by) other entry points like <code>parse</code>, <code>parseArgs</code>, <code>populateCommand</code>, <code>run</code>, <code>call</code>, <code>invoke</code>, <code>parseWithHandler</code> and <code>parseWithHandlers</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_migration"><a class="anchor" href="#_migration"></a>9.6. Migration</h3>
<div class="paragraph">
<p>Older versions of picocli supported <code>run</code>, <code>call</code>, <code>invoke</code> and <code>parseWithHandlers</code> convenience methods that were similar to <code>execute</code> but had limited support for parser configuration and and limited support for exit codes.
These methods are deprecated from picocli 4.0.
The sections below show some common usages and how the same can be achieved with the <code>execute</code> API.</p>
</div>
<div class="sect3">
<h4 id="_customizing_output_streams_and_ansi_settings"><a class="anchor" href="#_customizing_output_streams_and_ansi_settings"></a>9.6.1. Customizing Output Streams and ANSI settings</h4>
<div class="paragraph">
<p>Before:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">PrintStream</span> <span class="n">out</span> <span class="o">=</span> <span class="c1">// output stream for user-requested help</span>
<span class="nc">PrintStream</span> <span class="n">err</span> <span class="o">=</span> <span class="c1">// output stream for error messages</span>
<span class="nc">Ansi</span> <span class="n">ansi</span> <span class="o">=</span> <span class="c1">// to use ANSI colors and styles or not</span>
<span class="nc">CommandLine</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyRunnable</span><span class="o">(),</span> <span class="n">out</span><span class="o">,</span> <span class="n">err</span><span class="o">,</span> <span class="n">ansi</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">out</span><span class="p">:</span> <span class="nc">PrintStream</span> <span class="p">=</span> <span class="c1">// output stream for user-requested help</span>
<span class="kd">val</span> <span class="py">err</span><span class="p">:</span> <span class="nc">PrintStream</span> <span class="p">=</span> <span class="c1">// output stream for error messages</span>
<span class="kd">val</span> <span class="py">ansi</span><span class="p">:</span> <span class="nc">Ansi</span> <span class="p">=</span> <span class="c1">// to use ANSI colors and styles or not</span>
<span class="nc">CommandLine</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nc">MyRunnable</span><span class="p">(),</span> <span class="k">out</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">ansi</span><span class="p">,</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="c1">// output stream for user-requested help</span>
<span class="nc">PrintWriter</span> <span class="n">err</span> <span class="o">=</span> <span class="c1">// output stream for error messages</span>
<span class="nc">Ansi</span> <span class="n">ansi</span> <span class="o">=</span> <span class="c1">// to use ANSI colors and styles or not</span>

<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyRunnable</span><span class="o">())</span>
        <span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
        <span class="o">.</span><span class="na">setErr</span><span class="o">(</span><span class="n">err</span><span class="o">);</span>
        <span class="o">.</span><span class="na">setColorScheme</span><span class="o">(</span><span class="nc">Help</span><span class="o">.</span><span class="na">defaultColorScheme</span><span class="o">(</span><span class="n">ansi</span><span class="o">));</span>

<span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">var</span> <span class="py">out</span><span class="p">:</span> <span class="nc">PrintWriter</span> <span class="p">=</span> <span class="c1">// output stream for user-requested help</span>
<span class="kd">var</span> <span class="py">err</span><span class="p">:</span> <span class="nc">PrintWriter</span> <span class="p">=</span> <span class="c1">// output stream for error messages</span>
<span class="kd">val</span> <span class="py">ansi</span><span class="p">:</span> <span class="nc">Ansi</span> <span class="p">=</span> <span class="c1">// to use ANSI colors and styles or not</span>

<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyRunnable</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">setOut</span><span class="p">(</span><span class="k">out</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">setErr</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">setColorScheme</span><span class="p">(</span><span class="nc">Help</span><span class="p">.</span><span class="nf">defaultColorScheme</span><span class="p">(</span><span class="n">ansi</span><span class="p">));</span>

<span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_return_value_from_callable_or_method"><a class="anchor" href="#_return_value_from_callable_or_method"></a>9.6.2. Return Value from Callable or Method</h4>
<div class="paragraph">
<p>Before:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyCallable</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">MyResult</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">MyResult</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="o">}</span>

<span class="nc">MyResult</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">call</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyCallable</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyCallable</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">MyResult</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">MyResult</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">result</span><span class="p">:</span> <span class="nc">MyResult</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="nc">MyCallable</span><span class="p">(),</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyCallable</span><span class="o">());</span>
<span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="nc">MyResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExecutionResult</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyCallable</span><span class="p">())</span>
<span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">result</span><span class="p">:</span> <span class="nc">MyResult</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">getExecutionResult</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_invoking_command_methods"><a class="anchor" href="#_invoking_command_methods"></a>9.6.3. Invoking Command Methods</h4>
<div class="paragraph">
<p>Before:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyCommand</span> <span class="o">{</span>
    <span class="nd">@Command</span>
    <span class="kd">public</span> <span class="nc">MyResult</span> <span class="nf">doit</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="o">}</span>

<span class="nc">MyResult</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="s">"doit"</span><span class="o">,</span> <span class="nc">MyCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyCommand</span> <span class="p">{</span>
    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">doit</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="n">x</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">:</span> <span class="nc">MyResult</span><span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">invoke</span><span class="p">(</span><span class="s">"doit"</span><span class="p">,</span> <span class="nc">MyCommand</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span> <span class="k">as</span> <span class="nc">MyResult</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Method</span> <span class="n">doit</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">getCommandMethods</span><span class="o">(</span><span class="nc">MyCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"doit"</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">doit</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="nc">MyResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExecutionResult</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">doit</span><span class="p">:</span> <span class="nc">Method</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">getCommandMethods</span><span class="p">(</span><span class="nc">MyCommand</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="s">"doit"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">doit</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">result</span><span class="p">:</span> <span class="nc">MyResult</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">getExecutionResult</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_executing_commands_with_subcommands"><a class="anchor" href="#_executing_commands_with_subcommands"></a>9.6.4. Executing Commands with Subcommands</h4>
<div class="paragraph">
<p>The <code>IParseResultHandler2</code> interface has been deprecated in picocli 4.0 in favor of <code>IExecutionStrategy</code>. The existing built-in handlers <code>RunLast</code>, <code>RunAll</code> and <code>RunFirst</code> implement the <code>IExecutionStrategy</code> interface and can still be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>RunLast</code> handler prints help if requested, and otherwise gets the <em>last specified</em> command or subcommand and tries to execute it as a <code>Runnable</code>, <code>Callable</code> or <code>Method</code>. This is the default execution strategy.</p>
</li>
<li>
<p>the <code>RunFirst</code> handler prints help if requested, and otherwise executes the <em>top-level</em> command as a <code>Runnable</code>, <code>Callable</code> or <code>Method</code></p>
</li>
<li>
<p>the <code>RunAll</code> handler prints help if requested, and otherwise executes <em>all</em> commands and subcommands that the user specified on the command line as <code>Runnable</code>, <code>Callable</code> or <code>Method</code> tasks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="nc">MyTopLevelCommand</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"add"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitAdd</span><span class="o">());</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">parseWithHandler</span><span class="o">(</span><span class="k">new</span> <span class="nc">RunAll</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyTopLevelCommand</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span>   <span class="nc">GitStatus</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"commit"</span><span class="p">,</span>   <span class="nc">GitCommit</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"add"</span><span class="p">,</span>      <span class="nc">GitAdd</span><span class="p">())</span>
<span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">parseWithHandler</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;&gt;(</span><span class="nc">CommandLine</span><span class="p">.</span><span class="nc">RunAll</span><span class="p">(),</span> <span class="n">args</span><span class="p">)}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="nc">MyTopLevelCommand</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"add"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitAdd</span><span class="o">());</span>

<span class="c1">// the default is RunLast, this can be customized:</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">setExecutionStrategy</span><span class="o">(</span><span class="k">new</span> <span class="nc">RunAll</span><span class="o">());</span>
<span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyTopLevelCommand</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span>   <span class="nc">GitStatus</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"commit"</span><span class="p">,</span>   <span class="nc">GitCommit</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"add"</span><span class="p">,</span>      <span class="nc">GitAdd</span><span class="p">())</span>

<span class="c1">// the default is RunLast, this can be customized:</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">executionStrategy</span> <span class="p">=</span> <span class="nc">RunAll</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ParseResult</code> can be used to get the return value from a Callable or Method subcommand:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// getting return value from Callable or Method command</span>
<span class="nc">Object</span> <span class="n">topResult</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExecutionResult</span><span class="o">();</span>

<span class="c1">// getting return value from Callable or Method subcommand</span>
<span class="nc">ParseResult</span> <span class="n">parseResult</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getParseResult</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">parseResult</span><span class="o">.</span><span class="na">subcommand</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">CommandLine</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">parseResult</span><span class="o">.</span><span class="na">subcommand</span><span class="o">().</span><span class="na">commandSpec</span><span class="o">().</span><span class="na">commandLine</span><span class="o">();</span>
    <span class="nc">Object</span> <span class="n">subResult</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="na">getExecutionResult</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="c1">// getting return value from Callable or Method command</span>
<span class="kd">val</span> <span class="py">topResult</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">getExecutionResult</span><span class="p">()</span>

<span class="c1">// getting return value from Callable or Method subcommand</span>
<span class="kd">val</span> <span class="py">parseResult</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">parseResult</span>
<span class="k">if</span> <span class="p">(</span><span class="n">parseResult</span><span class="p">.</span><span class="nf">subcommand</span><span class="p">()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">sub</span><span class="p">:</span> <span class="nc">CommandLine</span> <span class="p">=</span> <span class="n">parseResult</span><span class="p">.</span><span class="nf">subcommand</span><span class="p">().</span><span class="nf">commandSpec</span><span class="p">().</span><span class="nf">commandLine</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">subResult</span> <span class="p">=</span> <span class="n">sub</span><span class="p">.</span><span class="n">getExecutionResult</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;()</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_diy_command_execution"><a class="anchor" href="#_diy_command_execution"></a>9.7. DIY Command Execution</h3>
<div class="paragraph">
<p>Alternatively, applications may want to use the <code>parseArgs</code> method directly and write their own "Do It Yourself" command execution logic.</p>
</div>
<div class="paragraph">
<p>The example below covers the following common scenarios:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Handle invalid user input, and report any problems to the user (potentially suggesting alternative options and subcommands for simple typos if we want to get fancy).</p>
</li>
<li>
<p>Check if the user requested usage help, and print this help and abort processing if this was the case.</p>
</li>
<li>
<p>Check if the user requested version information, and print this information and abort processing if this was the case.</p>
</li>
<li>
<p>If none of the above, run the business logic of the application.</p>
</li>
<li>
<p>Handle any errors that occurred in the business logic.</p>
</li>
</ol>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">callable</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyCallable</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">callable</span><span class="o">);</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="nc">ParseResult</span> <span class="n">parseResult</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

    <span class="c1">// Did user request usage help (--help)?</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">isUsageHelpRequested</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getOut</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnUsageHelp</span><span class="o">();</span>

    <span class="c1">// Did user request version help (--version)?</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">isVersionHelpRequested</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">printVersionHelp</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getOut</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnVersionHelp</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="c1">// invoke the business logic</span>
    <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">callable</span><span class="o">.</span><span class="na">call</span><span class="o">();</span>
    <span class="n">cmd</span><span class="o">.</span><span class="na">setExecutionResult</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnSuccess</span><span class="o">();</span>

<span class="c1">// invalid user input: print error message and usage help</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ParameterException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="k">if</span> <span class="o">(!</span><span class="nc">UnmatchedArgumentException</span><span class="o">.</span><span class="na">printSuggestions</span><span class="o">(</span><span class="n">ex</span><span class="o">,</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">()))</span> <span class="o">{</span>
        <span class="n">ex</span><span class="o">.</span><span class="na">getCommandLine</span><span class="o">().</span><span class="na">usage</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnInvalidInput</span><span class="o">();</span>

<span class="c1">// exception occurred in business logic</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">());</span>
    <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnExecutionException</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">callable</span><span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">MyCallable</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">callable</span><span class="p">)</span>
<span class="k">return</span> <span class="k">try</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">parseResult</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>

    <span class="c1">// Did user request usage help (--help)?</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">isUsageHelpRequested</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cmd</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
        <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnUsageHelp</span><span class="p">()</span>

        <span class="c1">// Did user request version help (--version)?</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">isVersionHelpRequested</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cmd</span><span class="p">.</span><span class="nf">printVersionHelp</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnVersionHelp</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="c1">// invoke the business logic</span>
    <span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="n">callable</span><span class="p">.</span><span class="nf">call</span><span class="p">()</span>
    <span class="n">cmd</span><span class="p">.</span><span class="nf">setExecutionResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnSuccess</span><span class="p">()</span>

    <span class="c1">// invalid user input: print error message and usage help</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">ParameterException</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cmd</span><span class="p">.</span><span class="n">err</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(!</span><span class="nc">UnmatchedArgumentException</span><span class="p">.</span><span class="nf">printSuggestions</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">cmd</span><span class="p">.</span><span class="n">err</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ex</span><span class="p">.</span><span class="n">commandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnInvalidInput</span><span class="p">()</span>

    <span class="c1">// exception occurred in business logic</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">Exception</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ex</span><span class="p">.</span><span class="nf">printStackTrace</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">err</span><span class="p">)</span>
    <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnExecutionException</span><span class="p">()</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CommandLine.execute</code> method is equivalent to the above, and additionally handles subcommands correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_handling_errors"><a class="anchor" href="#_handling_errors"></a>9.8. Handling Errors</h3>
<div class="paragraph">
<p>Internally, the <code>execute</code> method parses the specified user input and populates the options and positional parameters defined by the annotations.
When the user specified invalid input, this is handled by the <code>IParameterExceptionHandler</code>.</p>
</div>
<div class="paragraph">
<p>After parsing the user input, the business logic of the command is invoked: the <code>run</code>, <code>call</code> or <code>@Command</code>-annotated method.
When an exception is thrown by the business logic, this is handled by the <code>IExecutionExceptionHandler</code>.</p>
</div>
<div class="paragraph">
<p>In most cases, the default handlers are sufficient, but the sections below show how they can be customized.</p>
</div>
<div class="sect3">
<h4 id="_invalid_user_input"><a class="anchor" href="#_invalid_user_input"></a>9.8.1. Invalid User Input</h4>
<div class="paragraph">
<p>When the user specified invalid input, the parser throws a <code>ParameterException</code>.
In the <code>execute</code> method, such exceptions are caught and passed to the <code>IParameterExceptionHandler</code>.</p>
</div>
<div class="paragraph">
<p>The default parameter exception handler prints an error message describing the problem,
followed by either <a href="https://picocli.info/apidocs/picocli/CommandLine.UnmatchedArgumentException.html#printSuggestions-picocli.CommandLine.ParameterException-java.io.PrintWriter-">suggested alternatives</a>
for mistyped options, or the full usage help message of the problematic command.
Finally, the handler returns an <a href="#_exception_exit_codes">exit code</a>.
This is sufficient for most applications.</p>
</div>
<div class="paragraph">
<p>Sometimes you want to display a shorter message. For example, the <code>grep</code> utility does not show the full usage help when it gets an invalid argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ grep -d recurese "ERROR" logs/*

Error: invalid argument ârecureseâ for â--directoriesâ
Valid arguments are:
  - âreadâ
  - ârecurseâ
  - âskipâ
Usage: grep [OPTION]... PATTERN [FILE]...
Try 'grep --help' for more information.</pre>
</div>
</div>
<div class="paragraph">
<p>You can customize how your application handles invalid user input by setting a custom <code>IParameterExceptionHandler</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
    <span class="o">.</span><span class="na">setParameterExceptionHandler</span><span class="o">(</span><span class="k">new</span> <span class="nc">ShortErrorMessageHandler</span><span class="o">())</span>
    <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">setParameterExceptionHandler</span><span class="p">(</span><span class="nc">ShortErrorMessageHandler</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where the <code>IParameterExceptionHandler</code> implementation could be something like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ShortErrorMessageHandler</span> <span class="kd">implements</span> <span class="nc">IParameterExceptionHandler</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">handleParseException</span><span class="o">(</span><span class="nc">ParameterException</span> <span class="n">ex</span><span class="o">,</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="na">getCommandLine</span><span class="o">();</span>
        <span class="nc">PrintWriter</span> <span class="n">err</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">();</span>

        <span class="c1">// if tracing at DEBUG level, show the location of the issue</span>
        <span class="k">if</span> <span class="o">(</span><span class="s">"DEBUG"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"picocli.trace"</span><span class="o">)))</span> <span class="o">{</span>
            <span class="n">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getColorScheme</span><span class="o">().</span><span class="na">stackTraceText</span><span class="o">(</span><span class="n">ex</span><span class="o">));</span>
        <span class="o">}</span>

        <span class="n">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getColorScheme</span><span class="o">().</span><span class="na">errorText</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()));</span> <span class="c1">// bold red</span>
        <span class="nc">UnmatchedArgumentException</span><span class="o">.</span><span class="na">printSuggestions</span><span class="o">(</span><span class="n">ex</span><span class="o">,</span> <span class="n">err</span><span class="o">);</span>
        <span class="n">err</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getHelp</span><span class="o">().</span><span class="na">fullSynopsis</span><span class="o">());</span>

        <span class="nc">CommandSpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">();</span>
        <span class="n">err</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Try '%s --help' for more information.%n"</span><span class="o">,</span> <span class="n">spec</span><span class="o">.</span><span class="na">qualifiedName</span><span class="o">());</span>

        <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExitCodeExceptionMapper</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span>
                    <span class="o">?</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExitCodeExceptionMapper</span><span class="o">().</span><span class="na">getExitCode</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span>
                    <span class="o">:</span> <span class="n">spec</span><span class="o">.</span><span class="na">exitCodeOnInvalidInput</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">ShortErrorMessageHandler</span> <span class="p">:</span> <span class="nc">IParameterExceptionHandler</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">handleParseException</span><span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">ParameterException</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="n">ex</span><span class="p">.</span><span class="n">commandLine</span>
        <span class="kd">val</span> <span class="py">err</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">err</span>

        <span class="c1">// if tracing at DEBUG level, show the location of the issue</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">"DEBUG"</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="nf">getProperty</span><span class="p">(</span><span class="s">"picocli.trace"</span><span class="p">),</span> <span class="n">ignoreCase</span> <span class="p">=</span> <span class="k">true</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">err</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">colorScheme</span><span class="p">.</span><span class="nf">stackTraceText</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="n">err</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">colorScheme</span><span class="p">.</span><span class="nf">errorText</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">message</span><span class="p">))</span> <span class="c1">// bold red</span>
        <span class="nc">UnmatchedArgumentException</span><span class="p">.</span><span class="nf">printSuggestions</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
        <span class="n">err</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">help</span><span class="p">.</span><span class="nf">fullSynopsis</span><span class="p">())</span>

        <span class="kd">val</span> <span class="py">spec</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span>
        <span class="n">err</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">"Try '${spec.qualifiedName()} --help' for more information.%n"</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exitCodeExceptionMapper</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="n">cmd</span><span class="p">.</span><span class="n">exitCodeExceptionMapper</span><span class="p">.</span><span class="nf">getExitCode</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">spec</span><span class="p">.</span><span class="nf">exitCodeOnInvalidInput</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_business_logic_exceptions"><a class="anchor" href="#_business_logic_exceptions"></a>9.8.2. Business Logic Exceptions</h4>
<div class="paragraph">
<p>When the business logic throws an exception, this exception is caught and passed to the <code>IExecutionExceptionHandler</code>.</p>
</div>
<div class="paragraph">
<p>The default execution exception handling results in the stack trace of the exception being printed and an <a href="#_exception_exit_codes">exit code</a> being returned.
This is sufficient for most applications.</p>
</div>
<div class="paragraph">
<p>If you have designed your business logic to throw exceptions with user-facing error messages, you want to print this error message instead of the stack trace.
This can be accomplished by installing a custom <code>IExecutionExceptionHandler</code>, like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
    <span class="o">.</span><span class="na">setExecutionExceptionHandler</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintExceptionMessageHandler</span><span class="o">())</span>
    <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">setExecutionExceptionHandler</span><span class="p">(</span><span class="nc">PrintExceptionMessageHandler</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where the <code>IExecutionExceptionHandler</code> implementation could look something like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">PrintExceptionMessageHandler</span> <span class="kd">implements</span> <span class="nc">IExecutionExceptionHandler</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">handleExecutionException</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">,</span>
                                        <span class="nc">CommandLine</span> <span class="n">cmd</span><span class="o">,</span>
                                        <span class="nc">ParseResult</span> <span class="n">parseResult</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// bold red error message</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">getErr</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getColorScheme</span><span class="o">().</span><span class="na">errorText</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()));</span>

        <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExitCodeExceptionMapper</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span>
                    <span class="o">?</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getExitCodeExceptionMapper</span><span class="o">().</span><span class="na">getExitCode</span><span class="o">(</span><span class="n">ex</span><span class="o">)</span>
                    <span class="o">:</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommandSpec</span><span class="o">().</span><span class="na">exitCodeOnExecutionException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">PrintExceptionMessageHandler</span> <span class="p">:</span> <span class="nc">IExecutionExceptionHandler</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">handleExecutionException</span><span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">Exception</span><span class="p">,</span>
                                          <span class="n">cmd</span><span class="p">:</span> <span class="nc">CommandLine</span><span class="p">,</span>
                                          <span class="n">parseResult</span><span class="p">:</span> <span class="nc">ParseResult</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>

        <span class="c1">// bold red error message</span>
        <span class="n">cmd</span><span class="p">.</span><span class="n">err</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">colorScheme</span><span class="p">.</span><span class="nf">errorText</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">exitCodeExceptionMapper</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="n">cmd</span><span class="p">.</span><span class="n">exitCodeExceptionMapper</span><span class="p">.</span><span class="nf">getExitCode</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">cmd</span><span class="p">.</span><span class="n">commandSpec</span><span class="p">.</span><span class="nf">exitCodeOnExecutionException</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation"><a class="anchor" href="#_validation"></a>10. Validation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_built_in_validation"><a class="anchor" href="#_built_in_validation"></a>10.1. Built-in Validation</h3>
<div class="paragraph">
<p>Picocli provides some limited form of validation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_required_options">required options</a></p>
</li>
<li>
<p><a href="#_required_parameters">required positional parameters</a></p>
</li>
<li>
<p>options with one or more <a href="#_arity">required parameters</a></p>
</li>
<li>
<p><a href="#_overwriting_single_options">allow/disallow</a> single-value options being specified multiple times</p>
</li>
<li>
<p><a href="#_mutually_dependent_options">mutually dependent</a> options</p>
</li>
<li>
<p><a href="#_mutually_exclusive_options">mutually exclusive</a> options</p>
</li>
<li>
<p><a href="#_repeating_composite_argument_groups">repeating groups</a> of exclusive or dependent options</p>
</li>
<li>
<p><a href="#_required_subcommands">required subcommands</a></p>
</li>
<li>
<p><a href="#_handling_invalid_input">type conversion</a></p>
</li>
<li>
<p><a href="#_unmatched_input">unmatched input</a></p>
</li>
<li>
<p><a href="#_unknown_options">unknown options</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_custom_validation"><a class="anchor" href="#_custom_validation"></a>10.2. Custom Validation</h3>
<div class="paragraph">
<p>Most applications will need to do additional validations to verify some business rules.</p>
</div>
<div class="paragraph">
<p>Applications that use the <a href="#execute"><code>execute</code> API</a> may find it useful to throw a <code>ParameterException</code> when validation fails:
any <code>ParameterExceptions</code> will be caught and handled by picocli&#8217;s built-in <a href="#_invalid_user_input">error handler</a>, which shows the error message in bold red, and is followed by the usage help message.</p>
</div>
<div class="paragraph">
<p>To construct a <code>ParameterException</code>, you need the <code>CommandLine</code> instance where the error occurred.
This can be obtained from the <code>CommandSpec</code>, which in turn can be obtained from a <a href="#spec-annotation"><code>@Spec</code>-annotated</a> field.
The sections below show some examples.</p>
</div>
<div class="sect3">
<h4 id="_single_value_validation"><a class="anchor" href="#_single_value_validation"></a>10.2.1. Single Value Validation</h4>
<div class="paragraph">
<p>Methods annotated with <code>@Option</code> and <code>@Parameters</code> can do simple input validation by throwing a <code>ParameterException</code> when invalid values are specified on the command line.</p>
</div>
<div class="paragraph">
<p>The following example validates that the value specified for the <code>--prime</code> option is a prime number:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">SingleOptionValidationExample</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">prime</span><span class="o">;</span>

    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span> <span class="c1">// injected by picocli</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-p"</span><span class="o">,</span> <span class="s">"--prime"</span><span class="o">},</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"NUMBER"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPrimeNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">invalid</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">invalid</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">invalid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span>
                    <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Invalid value '%s' for option '--prime': "</span> <span class="o">+</span>
                            <span class="s">"value is not a prime number."</span><span class="o">,</span> <span class="n">value</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">prime</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">SingleOptionValidationExample</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">prime</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Spec</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span> <span class="p">:</span> <span class="nc">CommandSpec</span> <span class="c1">// injected by picocli</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-p"</span><span class="p">,</span> <span class="s">"--prime"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"NUMBER"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">setPrimeNumber</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="py">invalid</span> <span class="p">=</span> <span class="k">false</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">2</span><span class="o">..</span><span class="n">value</span> <span class="p">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="p">%</span> <span class="n">i</span> <span class="p">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">invalid</span> <span class="p">=</span> <span class="k">true</span>
                <span class="k">break</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">invalid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">ParameterException</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span>
                <span class="nc">String</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="s">"Invalid value '%s' for option '--prime': "</span> <span class="p">+</span>
                              <span class="s">"value is not a prime number."</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="n">prime</span> <span class="p">=</span> <span class="n">value</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_validating_option_combinations"><a class="anchor" href="#_validating_option_combinations"></a>10.2.2. Validating Option Combinations</h4>
<div class="paragraph">
<p>Another common scenario is that the combination of multiple options and positional parameters is valid.
One way to accomplish this is to perform such validation at the beginning of the business logic.</p>
</div>
<div class="paragraph">
<p>The following example validates that at least one of the <code>--xml</code>, <code>--csv</code>, or <code>--json</code> options is specified:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"myapp 0.1"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MultiOptionValidationExample</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span><span class="o">=</span><span class="s">"--xml"</span><span class="o">)</span>  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">xmlFiles</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span><span class="o">=</span><span class="s">"--csv"</span><span class="o">)</span>  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">csvFiles</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span><span class="o">=</span><span class="s">"--json"</span><span class="o">)</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">jsonFiles</span><span class="o">;</span>

    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span> <span class="c1">// injected by picocli</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MultiOptionValidationExample</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">validate</span><span class="o">();</span>

        <span class="c1">// remaining business logic here</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">missing</span><span class="o">(</span><span class="n">xmlFiles</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">missing</span><span class="o">(</span><span class="n">csvFiles</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">missing</span><span class="o">(</span><span class="n">jsonFiles</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span>
                    <span class="s">"Missing option: at least one of the "</span> <span class="o">+</span>
                    <span class="s">"'--xml', '--csv', or '--json' options must be specified."</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">missing</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"myapp 0.1"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MultiOptionValidationExample</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--xml"</span><span class="p">])</span>  <span class="kd">var</span> <span class="py">xmlFiles</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--csv"</span><span class="p">])</span>  <span class="kd">var</span> <span class="py">csvFiles</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--json"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">jsonFiles</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="nd">@Spec</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span> <span class="p">:</span> <span class="nc">CommandSpec</span> <span class="c1">// injected by picocli</span>

     <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">validate</span><span class="p">()</span>

        <span class="c1">// remaining business logic here</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">validate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">missing</span><span class="p">(</span><span class="n">xmlFiles</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="nf">missing</span><span class="p">(</span><span class="n">csvFiles</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="nf">missing</span><span class="p">(</span><span class="n">jsonFiles</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">ParameterException</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span>
                <span class="s">"Missing option: at least one of the "</span> <span class="p">+</span>
                <span class="s">"'--xml', '--csv', or '--json' options must be specified."</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">missing</span><span class="p">(</span><span class="n">list</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="err">*</span><span class="p">&gt;?):</span> <span class="nc">Boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">list</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">list</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MultiOptionValidationExample</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jsr_380_beanvalidation"><a class="anchor" href="#_jsr_380_beanvalidation"></a>10.2.3. JSR-380 BeanValidation</h4>
<div class="paragraph">
<p>If you want to keep your validation declarative and annotation-based, take a look at <a href="https://jcp.org/en/jsr/detail?id=380">JSR 380</a>.</p>
</div>
<div class="paragraph">
<p>JSR-380 is a specification of the Java API for bean validation, part of JavaEE and JavaSE, which ensures that the properties of a bean meet specific criteria, using annotations such as <code>@NotNull</code>, <code>@Min</code>, and <code>@Max</code>.</p>
</div>
<div class="paragraph">
<p>The picocli wiki has a <a href="https://github.com/remkop/picocli/wiki/JSR-380-BeanValidation">full example</a>, below is a snippet:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Model.CommandSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintViolation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Validation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Validator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>

<span class="c1">// Example inspired by https://www.baeldung.com/javax-validation</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Name cannot be null"</span><span class="o">)</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-n"</span><span class="o">,</span> <span class="s">"--name"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"mandatory"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">18</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"Age should not be less than 18"</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">150</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"Age should not be greater than 150"</span><span class="o">)</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-a"</span><span class="o">,</span> <span class="s">"--age"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"between 18-150"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@Email</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Email should be valid"</span><span class="o">)</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-e"</span><span class="o">,</span> <span class="s">"--email"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"valid email"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">()</span> <span class="o">{</span> <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"User{name='%s', age=%s, email='%s'}"</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">age</span><span class="o">,</span> <span class="n">email</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">validate</span><span class="o">();</span>

        <span class="c1">// remaining business logic here</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="nc">Validation</span><span class="o">.</span><span class="na">buildDefaultValidatorFactory</span><span class="o">().</span><span class="na">getValidator</span><span class="o">();</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;&gt;</span> <span class="n">violations</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">violations</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">errorMsg</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">violation</span> <span class="o">:</span> <span class="n">violations</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">errorMsg</span> <span class="o">+=</span> <span class="s">"ERROR: "</span> <span class="o">+</span> <span class="n">violation</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span> <span class="n">errorMsg</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Model.CommandSpec</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.*</span>

<span class="k">import</span> <span class="nn">javax.validation.ConstraintViolation</span>
<span class="k">import</span> <span class="nn">javax.validation.Validation</span>
<span class="k">import</span> <span class="nn">javax.validation.Validator</span>
<span class="k">import</span> <span class="nn">javax.validation.constraints.*</span>

<span class="c1">// Example inspired by https://www.baeldung.com/javax-validation</span>
<span class="kd">class</span> <span class="nc">User</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span> <span class="p">=</span> <span class="s">"Name cannot be null"</span><span class="p">)</span>
    <span class="nd">@CommandLine</span><span class="p">.</span><span class="nc">Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-n"</span><span class="p">,</span> <span class="s">"--name"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"mandatory"</span><span class="p">])</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span>

    <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="p">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">message</span> <span class="p">=</span> <span class="s">"Age should not be less than 18"</span><span class="p">)</span>
    <span class="nd">@Max</span><span class="p">(</span><span class="n">value</span> <span class="p">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">message</span> <span class="p">=</span> <span class="s">"Age should not be greater than 150"</span><span class="p">)</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">,</span> <span class="s">"--age"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"between 18-150"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">age</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Email</span><span class="p">(</span><span class="n">message</span> <span class="p">=</span> <span class="s">"Email should be valid"</span><span class="p">)</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-e"</span><span class="p">,</span> <span class="s">"--email"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"valid email"</span><span class="p">])</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">email</span><span class="p">:</span> <span class="nc">String</span>

    <span class="nd">@Spec</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">toString</span><span class="p">():</span> <span class="nc">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"User{name=$name, age=$age, email=$email}"</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">validate</span><span class="p">()</span>

        <span class="c1">// remaining business logic here</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">validate</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">validator</span><span class="p">:</span> <span class="nc">Validator</span> <span class="p">=</span> <span class="nc">Validation</span><span class="p">.</span><span class="nf">buildDefaultValidatorFactory</span><span class="p">().</span><span class="n">validator</span>
        <span class="kd">val</span> <span class="py">violations</span><span class="p">:</span> <span class="nc">Set</span><span class="p">&lt;</span><span class="nc">ConstraintViolation</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;&gt;</span> <span class="p">=</span> <span class="n">validator</span><span class="p">.</span><span class="nf">validate</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">violations</span><span class="p">.</span><span class="nf">isNotEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="py">errorMsg</span> <span class="p">=</span> <span class="s">""</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">violation</span> <span class="k">in</span> <span class="n">violations</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">errorMsg</span> <span class="p">+=</span> <span class="s">"ERROR: ${violation.message}\n"</span>
            <span class="p">}</span>
            <span class="k">throw</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">ParameterException</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span> <span class="n">errorMsg</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">User</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_parser_configuration"><a class="anchor" href="#_parser_configuration"></a>11. Parser Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_case_sensitivity"><a class="anchor" href="#_case_sensitivity"></a>11.1. Case Sensitivity</h3>
<div class="paragraph">
<p>By default, all options and subcommands are case sensitive.
From picocli 4.3, case sensitivity is configurable.
Case sensitivity can be switched off globally, as well as on a per-command basis.</p>
</div>
<div class="paragraph">
<p>To toggle case sensitivity for all commands, use the <code>CommandLine::setSubcommandsCaseInsensitive</code> and <code>CommandLine::setOptionsCaseInsensitive</code> methods.
Use the <code>CommandSpec::subcommandsCaseInsensitive</code> and <code>CommandSpec::optionsCaseInsensitive</code> methods to give some commands a different case sensitivity than others.</p>
</div>
<div class="paragraph">
<p>Where possible, picocli will try to prevent ambiguity: when multiple options with the same name are registered in a command, a <code>DuplicateOptionAnnotationsException</code> is thrown.
When multiple subcommands with the same name are registered in a command, a <code>DuplicateNameException</code> is thrown.</p>
</div>
<div class="paragraph">
<p>With case sensitivity switched off, the same principle applies: multiple options whose names differ only in case cannot be registered in a command.
Similarly, multiple subcommands cannot be registered when their names differ only in case.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a combination of POSIX options resembles a long option, picocli will prioritize the long option.
This is the case regardless of case sensitivity, but be aware that with case sensitivity switched off, the chance of such collisions increases.
For example, if a command has POSIX options <code>-a</code>, <code>-b</code>, and <code>-c</code>, and a long option <code>-ABC</code>, then, when the user specifies <code>-abc</code>, picocli will recognize it as the long option <code>-ABC</code>, not as the POSIX options.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/casesensitivity">casesensitivity</a> package in <code>picocli-examples</code> for some examples.</p>
</div>
</div>
<div class="sect2">
<h3 id="_abbreviated_options_and_subcommands"><a class="anchor" href="#_abbreviated_options_and_subcommands"></a>11.2. Abbreviated Options and Subcommands</h3>
<div class="paragraph">
<p>Since picocli 4.4, the parser can recognize abbreviated options and subcommands.
This needs to be enabled explicitly with <code>CommandLine::setAbbreviatedOptionsAllowed</code> and <code>CommandLine::setAbbreviatedSubcommandsAllowed</code>.</p>
</div>
<div class="sect3">
<h4 id="_recognized_abbreviations"><a class="anchor" href="#_recognized_abbreviations"></a>11.2.1. Recognized Abbreviations</h4>
<div class="paragraph">
<p>When abbreviations are enabled, users can specify the initial letter(s) of the first component and optionally of one or more subsequent components of an option or subcommand name.</p>
</div>
<div class="paragraph">
<p>"Components" are separated by <code>-</code> dash characters or by case, so for example, both <code>--CamelCase</code> and <code>--kebab-case</code> have two components.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When case sensitivity is <a href="#_case_sensitivity">disabled</a> only the <code>-</code> dash character can be used to separate components.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Examples of valid abbreviations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option or Subcommand</th>
<th class="tableblock halign-left valign-top">Sample Recognized Abbreviations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--veryLongCamelCase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--very</code>, <code>--vLCC</code>, <code>--vCase</code> (&#8230;&#8203;)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--super-long-option</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--sup</code>, <code>--sLO</code>, <code>--s-l-o</code>, <code>--s-lon</code>, <code>--s-opt</code>, <code>--sOpt</code> (&#8230;&#8203;)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>some-long-command</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>so</code>, <code>sLC</code>, <code>s-l-c</code>, <code>soLoCo</code>, <code>someCom</code> (&#8230;&#8203;)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ambiguous_abbreviations"><a class="anchor" href="#_ambiguous_abbreviations"></a>11.2.2. Ambiguous Abbreviations</h4>
<div class="paragraph">
<p>When the user specifies input that can match multiple options or subcommands, the parser throws a <code>ParameterException</code>.
When applications use the <code>execute</code> method, an error message and the usage help is <a href="#_invalid_user_input">displayed</a> to the user.</p>
</div>
<div class="paragraph">
<p>For example, given a command with subcommands <code>help</code> and <code>hello</code>, then ambiguous user input like <code>hel</code> will show this error message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Error: 'hel' is not unique: it matches 'hello', 'help'</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_abbreviated_long_options_and_posix_clustered_short_options"><a class="anchor" href="#_abbreviated_long_options_and_posix_clustered_short_options"></a>11.2.3. Abbreviated Long Options and POSIX Clustered Short Options</h4>
<div class="paragraph">
<p>When an argument can match both an abbreviated long option and a set of <a href="#_short_posix_options">clustered short options</a>, picocli matches the long option.
This is the case regardless of abbreviations, but be aware that with abbreviated options enabled, the chance of such collisions increases.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">AbbreviationsAndPosix</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-A"</span><span class="o">)</span>      <span class="kt">boolean</span> <span class="n">a</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-B"</span><span class="o">)</span>      <span class="kt">boolean</span> <span class="n">b</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-AaaBbb"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">aaaBbb</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">AbbreviationsAndPosix</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AbbreviationsAndPosix</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">).</span><span class="na">setAbbreviatedOptionsAllowed</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-AB"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">app</span><span class="o">.</span><span class="na">aaaBbb</span> <span class="o">==</span> <span class="kc">true</span><span class="o">;</span> <span class="c1">// the long option is matched from abbreviated input -AB</span>
<span class="k">assert</span> <span class="n">app</span><span class="o">.</span><span class="na">a</span> <span class="o">==</span> <span class="kc">false</span><span class="o">;</span>
<span class="k">assert</span> <span class="n">app</span><span class="o">.</span><span class="na">b</span> <span class="o">==</span> <span class="kc">false</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">AbbreviationsAndPosix</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-A"</span><span class="p">])</span>       <span class="kd">var</span> <span class="py">a</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-B"</span><span class="p">])</span>       <span class="kd">var</span> <span class="py">b</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-AaaBbb"</span><span class="p">])</span>  <span class="kd">var</span> <span class="py">aaaBbb</span> <span class="p">=</span> <span class="k">false</span>
<span class="p">}</span>

<span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">AbbreviationsAndPosix</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">).</span><span class="nf">setAbbreviatedOptionsAllowed</span><span class="p">(</span><span class="k">true</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-AB"</span><span class="p">)</span>
<span class="nf">assertTrue</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">aaaBbb</span><span class="p">)</span> <span class="c1">// the long option is matched from abbreviated input -AB</span>
<span class="nf">assertFalse</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">a</span><span class="p">)</span>
<span class="nf">assertFalse</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">b</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When abbreviated options are enabled, user input <code>-AB</code> will match the long <code>-AaaBbb</code> option, but not the <code>-A</code> and <code>-B</code> options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overwriting_single_options"><a class="anchor" href="#_overwriting_single_options"></a>11.3. Overwriting Single Options</h3>
<div class="paragraph">
<p>When a single-value option is specified multiple times on the command line, the default parser behaviour is to throw an <code>OverwrittenOptionException</code>.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-p"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">port</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-p"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">port</span> <span class="p">=</span> <span class="mi">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following input results in an <code>OverwrittenOptionException</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -p 80 -p 8080</pre>
</div>
</div>
<div class="paragraph">
<p>Applications can change this by calling <code>CommandLine::setOverwrittenOptionsAllowed</code> with <code>true</code> before parsing the input.
When overwritten options are allowed, the last specified value takes effect (the above input will set the <code>port</code> field to <code>8080</code>)
and a WARN level message is printed to the console. (See <a href="#_tracing">Tracing</a> for how to switch off the warnings.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_stop_at_positional"><a class="anchor" href="#_stop_at_positional"></a>11.4. Stop At Positional</h3>
<div class="paragraph">
<p>By default, positional parameters can be mixed with options on the command line, but this is not always desirable.
From picocli 2.3, applications can call <code>CommandLine::setStopAtPositional</code> with <code>true</code>
to force the parser to treat all values following the first positional parameter as positional parameters.</p>
</div>
<div class="paragraph">
<p>When this flag is set, the first positional parameter effectively serves as an "<a href="#_double_dash">end of options</a>" marker.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stop_at_unmatched"><a class="anchor" href="#_stop_at_unmatched"></a>11.5. Stop At Unmatched</h3>
<div class="paragraph">
<p>From picocli 2.3, applications can call <code>CommandLine::setStopAtUnmatched</code> with <code>true</code> to force the parser to stop interpreting
options and positional parameters as soon as it encounters an unmatched argument.</p>
</div>
<div class="paragraph">
<p>When this flag is set, the first unmatched argument and all subsequent command line arguments are added to the
unmatched arguments list returned by <code>CommandLine::getUnmatchedArguments</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_unmatched_input"><a class="anchor" href="#_unmatched_input"></a>11.6. Unmatched Input</h3>
<div class="paragraph">
<p>By default, an <code>UnmatchedArgumentException</code> is thrown when a command line argument cannot be assigned to an option or positional parameter.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">OnlyThree</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">arity</span> <span class="o">=</span> <span class="s">"3"</span><span class="o">)</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">OnlyThree</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">arity</span> <span class="p">=</span> <span class="s">"3"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">values</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The command has only one annotated field, <code>values</code>, and it expects exactly three arguments,
so the following input results in an <code>UnmatchedArgumentException</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java OnlyThree 1 2 3 4 5</pre>
</div>
</div>
<div class="paragraph">
<p>Applications can change this by calling <code>CommandLine::setUnmatchedArgumentsAllowed</code> with <code>true</code> before parsing the input.
When unmatched arguments are allowed, the above input will be accepted and a WARN level message is printed to the console.
(See <a href="#_tracing">Tracing</a> for how to switch off the warnings.)</p>
</div>
<div class="paragraph">
<p>The unmatched argument values can be obtained with the <code>CommandLine::getUnmatchedArguments</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="unmatched-annotation"><a class="anchor" href="#unmatched-annotation"></a>11.7. <code>@Unmatched</code> annotation</h3>
<div class="paragraph">
<p>As of picocli 3.0, fields annotated with <code>@Unmatched</code> will be populated with the unmatched arguments.
The field must be of type <code>String[]</code> or <code>List&lt;String&gt;</code>.</p>
</div>
<div class="paragraph">
<p>If picocli finds a field annotated with <code>@Unmatched</code>, it automatically sets <code>unmatchedArgumentsAllowed</code> to <code>true</code>
so no <code>UnmatchedArgumentException</code> is thrown when a command line argument cannot be assigned to an option or positional parameter.
If no unmatched arguments are found, the value of the field annotated with <code>@Unmatched</code> is unchanged.</p>
</div>
</div>
<div class="sect2">
<h3 id="_unknown_options"><a class="anchor" href="#_unknown_options"></a>11.8. Unknown Options</h3>
<div class="sect3">
<h4 id="_unknown_options_definition"><a class="anchor" href="#_unknown_options_definition"></a>11.8.1. Unknown Options Definition</h4>
<div class="paragraph">
<p>A special case of unmatched input are arguments that resemble options but don&#8217;t match any of the defined options.
Picocli determines if a value "resembles an option" by comparing its leading characters to the prefix characters of the known options.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Negative numbers are not considered to be unknown options, so values like <code>-123</code>, <code>-NaN</code>, <code>-Infinity</code>, <code>-#ABC</code> and <code>-0xCAFEBABE</code> will not be treated specially for resembling an option name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the value <code>-z</code> is considered an unknown option when we have a command that only defines options <code>-x</code> and <code>-y</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">x</span><span class="o">;</span>
<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">y</span><span class="o">;</span>
<span class="nd">@Parameters</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">remainder</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">x</span><span class="p">:</span> <span class="nc">String</span>
<span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">y</span><span class="p">:</span> <span class="nc">String</span>
<span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">remainder</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above defines options <code>-x</code> and <code>-y</code>, but no option <code>-z</code>. So what should the parser do when the user gives input like this?</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -z -x XXX</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_positional_parameters_resembling_options"><a class="anchor" href="#_positional_parameters_resembling_options"></a>11.8.2. Positional Parameters Resembling Options</h4>
<div class="paragraph">
<p>One possibility is to silently accept such values as positional parameters, but this is often not desirable.</p>
</div>
<div class="paragraph">
<p>By default, when the value resembles an option, picocli throws an <code>UnmatchedArgumentException</code> rather than treating it as a positional parameter.</p>
</div>
<div class="paragraph">
<p>Picocli 3.0 introduced the <code>CommandLine::setUnmatchedOptionsArePositionalParams</code> method that can be used to force the parser to treat arguments resembling an option as positional parameters.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -z -x XXX</pre>
</div>
</div>
<div class="paragraph">
<p>When <code>unmatchedOptionsArePositionalParams</code> is set to <code>true</code>, the unknown option <code>-z</code> is treated as a positional parameter.
The next argument <code>-x</code> is recognized and processed as a known option like you would expect.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An alternative is to call <code>CommandLine::setUnmatchedArgumentsAllowed</code> with <code>true</code>, this will accept and store such values separately as described in <a href="#_unmatched_input">Unmatched Input</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_option_parameters_resembling_options"><a class="anchor" href="#_option_parameters_resembling_options"></a>11.8.3. Option Parameters Resembling Options</h4>
<div class="paragraph">
<p>By default, options accept parameter values that "resemble" (but don&#8217;t exactly match) an option.</p>
</div>
<div class="paragraph">
<p>Picocli 4.4 introduced a <code>CommandLine::setUnmatchedOptionsAllowedAsOptionParameters</code> method that makes it possible to configure the parser to reject values that resemble options as option parameters.
Setting this to <code>false</code> will result in values resembling option names being rejected as option values.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">x</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">x</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, a value like <code>-z</code>, which resembles an option, is accepted as the parameter for <code>-x</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">MyApp</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyApp</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-x"</span><span class="o">,</span> <span class="s">"-z"</span><span class="o">);</span>
<span class="k">assert</span> <span class="s">"-z"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">app</span><span class="o">.</span><span class="na">x</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">MyApp</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-x"</span><span class="p">,</span> <span class="s">"-z"</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"-z"</span><span class="p">,</span> <span class="n">app</span><span class="p">.</span><span class="n">x</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After setting the <code>unmatchedOptionsAllowedAsOptionParameters</code> parser option to <code>false</code>, values resembling an option are rejected as parameter for <code>-x</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
        <span class="o">.</span><span class="na">setUnmatchedOptionsAllowedAsOptionParameters</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
        <span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-x"</span><span class="o">,</span> <span class="s">"-z"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">setUnmatchedOptionsAllowedAsOptionParameters</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-x"</span><span class="p">,</span> <span class="s">"-z"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will throw an <code>UnmatchedArgumentException</code> with message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"Unknown option: '-z'; Expected parameter for option '-x' but found '-z'"</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_option_names_as_option_values"><a class="anchor" href="#_option_names_as_option_values"></a>11.9. Option Names as Option Values</h3>
<div class="paragraph">
<p>Since picocli 4.4, the parser will no longer assign values that match an option name to options that take a parameter, unless the value is in quotes.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">x</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">y</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">App</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">App</span><span class="o">();</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">).</span><span class="na">setTrimQuotes</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"x='%s', y='%s'%n"</span><span class="o">,</span> <span class="n">app</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">app</span><span class="o">.</span><span class="na">y</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">y</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">App</span><span class="p">()</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">).</span><span class="nf">setTrimQuotes</span><span class="p">(</span><span class="k">true</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"x='${app.x}', y='${app.y}'"</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In previous versions of picocli, the above command would accept input <code>-x -y</code>, and the value <code>-y</code> would be assigned to the <code>x</code> String field.
As of picocli 4.4, the above input will be rejected with an error message indicating that the <code>-x</code> option requires a parameter.</p>
</div>
<div class="paragraph">
<p>If it is necessary to accept values that match option names, such values need to be quoted.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java App <span class="nt">-x</span><span class="o">=</span><span class="s2">"-y"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will print the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">x</span><span class="o">=</span><span class="s1">'-y'</span>, <span class="nv">y</span><span class="o">=</span><span class="s1">'null'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_toggle_boolean_flags"><a class="anchor" href="#_toggle_boolean_flags"></a>11.10. Toggle Boolean Flags</h3>
<div class="paragraph">
<p>When a flag option is specified on the command line picocli will set its value to the opposite of its <em>default</em> value.</p>
</div>
<div class="paragraph">
<p>Prior to 4.0, the default was to "toggle" boolean flags to the opposite of their <em>current</em> value:
if the previous value was <code>true</code> it is set to <code>false</code>, and when the value was <code>false</code> it is set to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Applications can call <code>CommandLine::setToggleBooleanFlags</code> with <code>true</code> to enable toggling.
Note that when toggling is enabled, specifying a flag option twice on the command line will have no effect because they cancel each other out.</p>
</div>
</div>
<div class="sect2">
<h3 id="_posix_clustered_short_options"><a class="anchor" href="#_posix_clustered_short_options"></a>11.11. POSIX Clustered Short Options</h3>
<div class="paragraph">
<p>By default, the picocli parser allows POSIX clustered short options, so short options like <code>-x -v -f SomeFile</code> can be clustered together like <code>-xvfSomeFile</code>.
From picocli 3.0, applications can call <code>CommandLine::setPosixClusteredShortOptionsAllowed</code> with <code>false</code> to enforce that options must be separated with whitespace on the command line.
(This also means that option parameters must be separated from the option name by whitespace or the <code>=</code> <a href="#_option_parameter_separators">separator</a> character, so <code>-D key=value</code> and <code>-D=key=value</code> will be recognized but <code>-Dkey=value</code> will not.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_lenient_mode"><a class="anchor" href="#_lenient_mode"></a>11.12. Lenient Mode</h3>
<div class="paragraph">
<p>From picocli 3.2, the parser can be configured to continue parsing invalid input to the end.
When <code>collectErrors</code> is set to <code>true</code>, and a problem occurs during parsing, an <code>Exception</code> is added to the list returned by <code>ParseResult::errors</code> and parsing continues. The default behaviour (when <code>collectErrors</code> is <code>false</code>) is to abort parsing by throwing the <code>Exception</code>.</p>
</div>
<div class="paragraph">
<p>This is useful when generating completion candidates on partial input, and is also useful when using picocli in
languages like Clojure where idiomatic error handling does not involve throwing and catching exceptions.</p>
</div>
<div class="paragraph">
<p>When using this feature, applications are responsible for actively verifying that no errors occurred before executing the business logic. Use with care!</p>
</div>
</div>
<div class="sect2">
<h3 id="_quoted_values"><a class="anchor" href="#_quoted_values"></a>11.13. Quoted Values</h3>
<div class="sect3">
<h4 id="_trimming_quotes"><a class="anchor" href="#_trimming_quotes"></a>11.13.1. Trimming Quotes</h4>
<div class="paragraph">
<p>From picocli 3.7, quotes around command line parameters are preserved by default (previously they were removed). This can be configured with <code>CommandLine::setTrimQuotes</code>, or the parser configuration <code>trimQuotes</code>. From picocli 4.0, quoted arguments can contain nested quoted substrings, to give end users fine-grained control over how values are split.</p>
</div>
<div class="paragraph">
<p>If <code>CommandLine::setTrimQuotes</code>, or the parser configuration <code>trimQuotes</code> is set to <code>true</code>, picocli will remove quotes from the command line arguments, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>As each command line argument is processed, the below <a href="#_smart_unquote">smart unquote</a> procedure is used to trim the outermost quotes.</p>
</li>
<li>
<p>Next, if the option or positional parameter has a <code>split</code> regex defined, the parameter value is split while respecting quotes: the <code>split</code> regex is not matched if it occurs in a quoted substring of the parameter value. Each of the parts found by the splitting process will have its quotes removed using the below "smart unquote" procedure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="#_splitting_quoted_parameters">Splitting Quoted Parameters</a> section below for examples.</p>
</div>
<div class="sect4">
<h5 id="_smart_unquote"><a class="anchor" href="#_smart_unquote"></a>Smart Unquote</h5>
<div class="ulist">
<ul>
<li>
<p>If the command line argument contains just the leading and trailing quote, these quotes are removed.</p>
</li>
<li>
<p>If the command line argument contains unescaped quotes, other than the leading and trailing quote, the argument is unchanged (the leading and trailing quotes remain).</p>
</li>
<li>
<p>If a quoted command line argument contains backslash-escaped quotes, the leading and trailing quotes are removed, backslash-escaped quotes are converted to unescaped quotes, and backslash-escaped backslashes are converted to unescaped backslashes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command Line Argument</th>
<th class="tableblock halign-left valign-top">After Trimming Quotes</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"-x=abc"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-x=abc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quotes removed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"a,b","x,y"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"a,b","x,y"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left unchanged</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"-x=a,b,\"c,d,e\",f"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-x=a,b,"c,d,e",f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Splitting will find 4 values: <code>a</code>; <code>b</code>; <code>c,d,e</code>; and <code>f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"-x=\"a,b,\\"c,d,e\\",f\""</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-x="a,b,\"c,d,e\",f"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Splitting will find 1 value: <code>a,b,"c,d,e",f</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_splitting_quoted_parameters"><a class="anchor" href="#_splitting_quoted_parameters"></a>11.13.2. Splitting Quoted Parameters</h4>
<div class="paragraph">
<p>By default, if the option or positional parameter has a <a href="#_split_regex"><code>split</code></a> regex defined, parameter values are split into parts while respecting quotes: the <code>split</code> regular expression is not matched inside a quoted region.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">split</span> <span class="o">=</span> <span class="s">","</span><span class="o">)</span>
<span class="nc">String</span><span class="o">[]</span> <span class="n">parts</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">split</span> <span class="p">=</span> <span class="s">","</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">parts</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given input like below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>&lt;command&gt; -x "-Dvalues=a,b,c","-Dother=1,2"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This results in the <code>parts</code> array having the following values, assuming the parser configuration <code>trimQuotes</code> is <code>false</code> (the default):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>"-Dvalues=a,b,c"
"-Dother=1,2"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the parser configuration <code>trimQuotes</code> is <code>true</code>, the above example would be split into the following values (with quotes trimmed from the resulting parts):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>-Dvalues=a,b,c
-Dother=1,2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given input like below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>&lt;command&gt; -x a,b,"c,d,e",f,"xxx,yyy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This results in the <code>parts</code> array having the following values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>a
b
"c,d,e"
f
"xxx,yyy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if the parser configuration <code>trimQuotes</code> is <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>a
b
c,d,e
f
xxx,yyy</code></pre>
</div>
</div>
<div class="paragraph">
<p>To preserve quotes when <code>trimQuotes</code> is <code>true</code>, specify additional nested quotes on the command line. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>&lt;command&gt; "-x=\"a,b,\\"c,d,e\\",f\"" "x,y,z" "\"1,2,3\"" "\\"1,2,3\\""</code></pre>
</div>
</div>
<div class="paragraph">
<p>With parser configuration <code>trimQuotes</code> set to <code>true</code>, the above input gives the following values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>a,b,"c,d,e",f
x
y
z
1,2,3
"1,2,3"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This "smart splitting" (respecting quotes) can be switched off with <code>CommandLine::setSplitQuotedStrings</code>:
setting the <code>splitQuotedStrings</code> parser attribute to <code>true</code> switches off smart splitting,
and the <code>split</code> regex is applied to the parameter value regardless of quotes.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>splitQuotedStrings</code> is mostly for backwards compatibility, for applications that want the pre-3.7 behaviour of simply splitting regardless of quotes.
Most applications should leave this setting to the default (<code>false</code>).
When this setting is <code>true</code>, the above input is parsed as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>a
b
"c
d
e"
f
"xxx
yyy"</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_negatable_options"><a class="anchor" href="#_customizing_negatable_options"></a>11.14. Customizing Negatable Options</h3>
<div class="paragraph">
<p><a href="#_negatable_options">Negatable options</a> can be customized via the <code>INegatableOptionTransformer</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">interface</span> <span class="nc">INegatableOptionTransformer</span> <span class="o">{</span>
    <span class="cm">/**
     * Returns the negative form of the specified option name for the parser to recognize
     * when parsing command line arguments.
     * @param optionName the option name to create a negative form for,
     *                   for example {@code --force}
     * @param cmd the command that the option is part of
     * @return the negative form of the specified option name, for example {@code --no-force}
     */</span>
    <span class="nc">String</span> <span class="nf">makeNegative</span><span class="o">(</span><span class="nc">String</span> <span class="n">optionName</span><span class="o">,</span> <span class="nc">CommandSpec</span> <span class="n">cmd</span><span class="o">);</span>

    <span class="cm">/**
     * Returns the documentation string to show in the synopsis and usage help message for
     * the specified option. The returned value should be concise and clearly suggest that
     * both the positive and the negative form are valid option names.
     * @param optionName the option name to create a documentation string for,
     *                   for example {@code --force}, or {@code -XX:+&lt;option&gt;}
     * @param cmd the command that the option is part of
     * @return the documentation string for the negatable option,
     *         for example {@code --[no-]force}, or {@code -XX:(+|-)&lt;option&gt;}
     */</span>
    <span class="nc">String</span> <span class="nf">makeSynopsis</span><span class="o">(</span><span class="nc">String</span> <span class="n">optionName</span><span class="o">,</span> <span class="nc">CommandSpec</span> <span class="n">cmd</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows you to control:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>which option names should have a negative form</p>
</li>
<li>
<p>the negative form recognized by the parser while parsing the command line</p>
</li>
<li>
<p>the documentation string showing both the positive and the negative form in the usage help message</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, a set of <a href="https://picocli.info/apidocs/picocli/CommandLine.RegexTransformer.html#createDefault--">regular expressions</a> is used to control the above.
Use <code>CommandLine::setNegatableOptionTransformer</code> to replace the <a href="https://picocli.info/apidocs/picocli/CommandLine.INegatableOptionTransformer"><code>INegatableOptionTransformer</code></a> with a custom version.
See the javadoc for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_parameter_processing"><a class="anchor" href="#_custom_parameter_processing"></a>11.15. Custom Parameter Processing</h3>
<div class="paragraph">
<p>As of version 4.6, picocli offers two different parser plugins for custom parameter processing: while the <code>IParameterPreprocessor</code> is a powerful and flexible tool, the <code>IParameterConsumer</code> serves as a simpler alternative.</p>
</div>
<div class="sect3">
<h4 id="_iparameterconsumer_parser_plugin"><a class="anchor" href="#_iparameterconsumer_parser_plugin"></a>11.15.1. <code>IParameterConsumer</code> Parser Plugin</h4>
<div class="paragraph">
<p>Options or positional parameters can be assigned a <code>IParameterConsumer</code> that implements
custom logic to process the parameters for this option or this position.
When an option or positional parameter with a custom <code>IParameterConsumer</code>
is matched on the command line, picocli&#8217;s internal parser is temporarily suspended,
and the custom parameter consumer becomes responsible for consuming and processing as many
command line arguments as needed.</p>
</div>
<div class="paragraph">
<p>This can be useful when passing options through to another command.</p>
</div>
<div class="paragraph">
<p>For example, the unix <a href="https://en.wikipedia.org/wiki/Find_(Unix)"><code>find</code></a> command
has a <a href="https://en.wikipedia.org/wiki/Find_(Unix)#Execute_an_action"><code>-exec</code></a>
option to execute some action for each file found.
Any arguments following the <code>-exec</code> option until a <code>;</code> or <code>+</code> argument are not
options for the <code>find</code> command itself, but are interpreted as a separate command and its options.</p>
</div>
<div class="paragraph">
<p>The example below demonstrates how to implement <code>find -exec</code> using this API:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"find"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Find</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-exec"</span><span class="o">,</span> <span class="n">parameterConsumer</span> <span class="o">=</span> <span class="nc">ExecParameterConsumer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">ExecParameterConsumer</span> <span class="kd">implements</span> <span class="nc">IParameterConsumer</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consumeParameters</span><span class="o">(</span><span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">args</span><span class="o">,</span> <span class="nc">ArgSpec</span> <span class="n">argSpec</span><span class="o">,</span> <span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">argSpec</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">args</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">arg</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>

            <span class="c1">// `find -exec` semantics: stop processing after a ';' or '+' argument</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">";"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">arg</span><span class="o">)</span> <span class="o">||</span> <span class="s">"+"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">arg</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"find"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Find</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-exec"</span><span class="p">],</span> <span class="n">parameterConsumer</span> <span class="p">=</span> <span class="nc">ExecParameterConsumer</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="kd">var</span> <span class="py">list</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ExecParameterConsumer</span> <span class="p">:</span> <span class="nc">IParameterConsumer</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">consumeParameters</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Stack</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span> <span class="n">argSpec</span><span class="p">:</span> <span class="nc">ArgSpec</span><span class="p">,</span> <span class="n">commandSpec</span><span class="p">:</span> <span class="nc">CommandSpec</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">list</span> <span class="p">=</span> <span class="n">argSpec</span><span class="p">.</span><span class="n">getValue</span><span class="p">&lt;</span><span class="nc">MutableList</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;()</span>
        <span class="k">while</span> <span class="p">(!</span><span class="n">args</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">arg</span> <span class="p">=</span> <span class="n">args</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
            <span class="n">list</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

            <span class="c1">// `find -exec` semantics: stop processing after a ';' or '+' argument</span>
            <span class="k">if</span> <span class="p">(</span><span class="s">";"</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">||</span> <span class="s">"+"</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">break</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Make sure any nested classes are <code>static</code>, or picocli will not be able to instantiate them.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="IParameterPreprocessor_Parser_Plugin"><a class="anchor" href="#IParameterPreprocessor_Parser_Plugin"></a>11.15.2. <code>IParameterPreprocessor</code> Parser Plugin</h4>
<div class="paragraph">
<p>Introduced in picocli 4.6, the <code>IParameterPreprocessor</code> is also a parser plugin, similar to <code>IParameterConsumer</code>, but more flexible.</p>
</div>
<div class="paragraph">
<p>Options, positional parameters and commands can be assigned a <code>IParameterPreprocessor</code> that implements custom logic to preprocess the parameters for this option, position or command.
When an option, positional parameter or command with a custom <code>IParameterPreprocessor</code> is matched on the command line, picocli&#8217;s internal parser is temporarily suspended, and this custom logic is invoked.</p>
</div>
<div class="paragraph">
<p>This custom logic may completely replace picocli&#8217;s internal parsing for this option, positional parameter or command, or augment it by doing some preprocessing before picocli&#8217;s internal parsing is resumed for this option, positional parameter or command.</p>
</div>
<div class="paragraph">
<p>The "preprocessing" actions can include modifying the stack of command line parameters, or modifying the model.</p>
</div>
<div class="sect4">
<h5 id="_example_use_case"><a class="anchor" href="#_example_use_case"></a>Example use case</h5>
<div class="paragraph">
<p>This may be useful when disambiguating input for commands that have both a positional parameter and an option with an optional parameter.
For example, suppose we have a command with the following synopsis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>edit [--open[=&lt;editor&gt;]] &lt;file&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>One of the <a href="#_optional_parameter_limitations">limitations of options with an optional parameter</a> is that they are difficult to combine with positional parameters.</p>
</div>
<div class="paragraph">
<p>With a custom parser plugin, we can customize the parser, such that <code>VALUE</code> in <code>--option=VALUE</code> is interpreted as the option parameter, and in <code>--option VALUE</code> (without the <code>=</code> separator), VALUE is interpreted as the positional parameter.
The code below demonstrates this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"edit"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Edit</span> <span class="o">{</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">,</span> <span class="n">arity</span><span class="o">=</span><span class="s">"0..1"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"The file to edit."</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="kd">enum</span> <span class="nc">Editor</span> <span class="o">{</span> <span class="n">defaultEditor</span><span class="o">,</span> <span class="n">eclipse</span><span class="o">,</span> <span class="n">idea</span><span class="o">,</span> <span class="n">netbeans</span> <span class="o">}</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--open"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">,</span> <span class="n">preprocessor</span> <span class="o">=</span> <span class="nc">Edit</span><span class="o">.</span><span class="na">MyPreprocessor</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="o">{</span>
           <span class="s">"Optionally specify the editor to use (${COMPLETION-CANDIDATES}). "</span> <span class="o">+</span>
           <span class="s">"If omitted the default editor is used. "</span><span class="o">,</span>
           <span class="s">"Example: edit --open=idea FILE opens IntelliJ IDEA (notice the '=' separator)"</span><span class="o">,</span>
           <span class="s">"         edit --open FILE opens the specified file in the default editor"</span>
        <span class="o">})</span>
    <span class="nc">Editor</span> <span class="n">editor</span> <span class="o">=</span> <span class="nc">Editor</span><span class="o">.</span><span class="na">defaultEditor</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyPreprocessor</span> <span class="kd">implements</span> <span class="nc">IParameterPreprocessor</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">preprocess</span><span class="o">(</span><span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">args</span><span class="o">,</span>
                                  <span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">,</span>
                                  <span class="nc">ArgSpec</span> <span class="n">argSpec</span><span class="o">,</span>
                                  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">info</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// we need to decide whether the next arg is the file to edit</span>
            <span class="c1">// or the name of the editor to use...</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">" "</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">info</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"separator"</span><span class="o">)))</span> <span class="o">{</span> <span class="c1">// parameter was not attached to option</span>

                <span class="c1">// act as if the user specified --open=defaultEditor</span>
                <span class="n">args</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="nc">Editor</span><span class="o">.</span><span class="na">defaultEditor</span><span class="o">.</span><span class="na">name</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span> <span class="c1">// picocli's internal parsing is resumed for this option</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Edit</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">,</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"The file to edit."</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="k">enum</span> <span class="kd">class</span> <span class="nc">Editor</span> <span class="p">{</span> <span class="n">defaultEditor</span><span class="p">,</span> <span class="n">eclipse</span><span class="p">,</span> <span class="n">idea</span><span class="p">,</span> <span class="n">netbeans</span> <span class="p">}</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--open"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span> <span class="n">preprocessor</span> <span class="p">=</span> <span class="nc">MyPreprocessor</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Optionally specify the editor to use (\${COMPLETION-CANDIDATES}). "</span> <span class="p">+</span>
            <span class="s">"If omitted the default editor is used. "</span><span class="p">,</span>
            <span class="s">"Example: edit --open=idea FILE "</span><span class="p">,</span>
            <span class="s">"  opens file in IntelliJ IDEA (notice the '=' separator)"</span><span class="p">,</span>
            <span class="s">"         edit --open FILE"</span><span class="p">,</span>
            <span class="s">"  opens the specified file in the default editor"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">editor</span> <span class="p">=</span> <span class="nc">Editor</span><span class="p">.</span><span class="n">defaultEditor</span>

    <span class="kd">class</span> <span class="nc">MyPreprocessor</span> <span class="p">:</span> <span class="nc">IParameterPreprocessor</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Stack</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span>
                                <span class="n">commandSpec</span><span class="p">:</span> <span class="nc">CommandSpec</span><span class="p">,</span>
                                <span class="n">argSpec</span><span class="p">:</span> <span class="nc">ArgSpec</span><span class="p">,</span>
                                <span class="n">info</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">Any</span><span class="p">&gt;):</span> <span class="nc">Boolean</span> <span class="p">{</span>
            <span class="c1">// we need to decide whether the next arg is the file to edit</span>
            <span class="c1">// or the name of the editor to use ...</span>
            <span class="k">if</span> <span class="p">(</span><span class="s">" "</span> <span class="p">==</span> <span class="n">info</span><span class="p">[</span><span class="s">"separator"</span><span class="p">])</span> <span class="p">{</span> <span class="c1">// parameter was not attached to option</span>

                <span class="c1">// act as if the user specified --open=defaultEditor</span>
                <span class="n">args</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nc">Editor</span><span class="p">.</span><span class="n">defaultEditor</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span> <span class="c1">// picocli's internal parsing is resumed for this option</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Make sure any nested classes are <code>static</code>, or picocli will not be able to instantiate them.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With this preprocessor in place the user can now specify his editor of choice (e.g. <code>--open=idea</code>). If no editor is given, the default editor is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># User input # Command State
# --------------------------
--open A B   # editor: defaultEditor, file: A,    unmatched: [B]
--open A     # editor: defaultEditor, file: A,    unmatched: []
--open=A B   # editor: A,             file: B,    unmatched: []
--open=A     # editor: A,             file: null, unmatched: []</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parser_plugin_comparison"><a class="anchor" href="#_parser_plugin_comparison"></a>11.15.3. Parser Plugin Comparison</h4>
<table class="tableblock frame-all grid-cols stretch">
<caption class="title">Table 4. Comparison of <code>IParameterPreprocessor</code> and <code>IParameterConsumer</code> parser plugins.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><strong><code>IParameterPreprocessor</code></strong></th>
<th class="tableblock halign-left valign-top"><strong><code>IParameterConsumer</code></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Summary</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either augment (return <code>false</code>) or replace (return <code>true</code>) picocli parsing logic for the matched element.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces picocli parsing logic for the matched element.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Scope</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commands as well as options and positional parameters.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Options and positional parameters only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Read parser state</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes, information may received via the <code>info</code> Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Modify parser state</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes, via modifying the <code>info</code> Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_help"><a class="anchor" href="#_help"></a>12. Help</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_help_options"><a class="anchor" href="#_help_options"></a>12.1. Help Options</h3>
<div class="paragraph">
<p>Applications can define help options by setting attribute <code>versionHelp = true</code>, <code>usageHelp = true</code> or <code>help = true</code>.
If one of the arguments specified on the command line is a "help" option, picocli will not throw a <code>MissingParameterException</code> when required options are missing.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-V"</span><span class="o">,</span> <span class="s">"--version"</span><span class="o">},</span> <span class="n">versionHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"display version info"</span><span class="o">)</span>
<span class="kt">boolean</span> <span class="n">versionInfoRequested</span><span class="o">;</span>

<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-h"</span><span class="o">,</span> <span class="s">"--help"</span><span class="o">},</span> <span class="n">usageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"display this help message"</span><span class="o">)</span>
<span class="kt">boolean</span> <span class="n">usageHelpRequested</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-V"</span><span class="p">,</span> <span class="s">"--version"</span><span class="p">],</span> <span class="n">versionHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"display version info"</span><span class="p">])</span>
<span class="kd">var</span> <span class="py">versionInfoRequested</span> <span class="p">=</span> <span class="k">false</span>

<span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-h"</span><span class="p">,</span> <span class="s">"--help"</span><span class="p">],</span> <span class="n">usageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"display this help message"</span><span class="p">])</span>
<span class="kd">var</span> <span class="py">usageHelpRequested</span> <span class="p">=</span> <span class="k">false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use these attributes for options that request the usage help message or version information to be shown on the console.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">App</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">populateCommand</span><span class="o">(</span><span class="k">new</span> <span class="nc">App</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">app</span><span class="o">.</span><span class="na">usageHelpRequested</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="k">new</span> <span class="nc">App</span><span class="o">(),</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">app</span><span class="p">:</span> <span class="nc">App</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">populateCommand</span><span class="p">(</span><span class="nc">App</span><span class="p">(),</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">usageHelpRequested</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">App</span><span class="p">(),</span> <span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CommandLine</code> class offers two methods that allow external components to detect whether
usage help or version information was requested (without inspecting the annotated domain object):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CommandLine::isUsageHelpRequested</code> returns <code>true</code> if the parser matched an option annotated with <code>usageHelp=true</code></p>
</li>
<li>
<p><code>CommandLine::isVersionHelpRequested</code> returns <code>true</code> if the parser matched an option annotated with <code>versionHelp=true</code></p>
</li>
</ul>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">App</span><span class="o">());</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">commandLine</span><span class="o">.</span><span class="na">isUsageHelpRequested</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">commandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">commandLine</span><span class="o">.</span><span class="na">isVersionHelpRequested</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">commandLine</span><span class="o">.</span><span class="na">printVersionHelp</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// ... run App's business logic</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">App</span><span class="p">())</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="n">isUsageHelpRequested</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">commandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="n">isVersionHelpRequested</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">commandLine</span><span class="p">.</span><span class="nf">printVersionHelp</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span>
<span class="c1">// ... run App's business logic</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#_printing_help_automatically">Printing Help Automatically</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mixin_standard_help_options"><a class="anchor" href="#_mixin_standard_help_options"></a>12.2. Mixin Standard Help Options</h3>
<div class="paragraph">
<p>Picocli 3.0 introduced the <code>mixinStandardHelpOptions</code> command attribute. When this attribute is set to <code>true</code>, picocli adds a <a href="#_mixins">mixin</a> to the
command that adds <a href="#_help_options"><code>usageHelp</code></a> and <a href="#_help_options"><code>versionHelp</code></a> options to the command. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"auto help demo - picocli 3.0"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">AutoHelpDemo</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--option"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Some option."</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">option</span><span class="o">;</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"auto help demo - picocli 3.0"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">AutoHelpDemo</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--option"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Some option."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">option</span><span class="p">:</span> <span class="nc">String</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Commands with <code>mixinStandardHelpOptions</code> do not need to explicitly declare fields annotated with <code>@Option(usageHelp = true)</code> and <code>@Option(versionHelp = true)</code> any more.
The usage help message for the above example looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [-hV] [--option=&lt;option&gt;]
      --option=&lt;option&gt;   Some option.
  -h, --help              Show this help message and exit.
  -V, --version           Print version information and exit.</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_built_in_help_subcommand"><a class="anchor" href="#_built_in_help_subcommand"></a>12.3. Built-in Help Subcommand</h3>
<div class="paragraph">
<p>As of version 3.0, picocli provides a <code>help</code> subcommand (<code>picocli.CommandLine.HelpCommand</code>) that can be installed as a subcommand
on any application command. It prints usage help for the parent command or sibling subcommands. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine.HelpCommand</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span><span class="nc">HelpCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Subcommand</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">MyCommand</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.HelpCommand</span>
<span class="c1">// ...</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">HelpCommand</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Subcommand</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyCommand</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, the following command prints usage help for a subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">myapp <span class="nb">help </span>subcommand</code></pre>
</div>
</div>
<div class="paragraph">
<p>To print usage help for the main command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">myapp <span class="nb">help</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_help_subcommands"><a class="anchor" href="#_custom_help_subcommands"></a>12.4. Custom Help Subcommands</h3>
<div class="paragraph">
<p>Custom help subcommands should mark themselves as a <a href="#_help_subcommands">help command</a> to tell picocli not to throw a <code>MissingParameterException</code> when required options are missing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">helpCommand</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Picocli 4.0 introduced a new interface <code>picocli.CommandLine.IHelpCommandInitializable2</code> that provides custom help
commands with access to the parent command and sibling commands, whether to use Ansi colors or not, and the streams to print the usage help message to.</p>
</div>
<div class="paragraph">
<p>The <code>IHelpCommandInitializable2</code> interface replaces the <code>IHelpCommandInitializable</code> interface which was introduced in picocli 3.0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IHelpCommandInitializable2</span> <span class="o">{</span>
    <span class="cm">/**
     * Initializes this object with the information needed to implement a help command that
     * provides usage help for other commands.
     *
     * @param helpCommandLine the {@code CommandLine} object associated with this help command.
      *                       Implementors can use this to walk the command hierarchy and
      *                       get access to the help command's parent and sibling commands.
     * @param colorScheme the color scheme to use when printing help, including whether
     *                    to use Ansi colors or not
     * @param outWriter the output writer to print the usage help message to
     * @param errWriter the error writer to print any diagnostic messages to,
     *                  in addition to the output from the exception handler
     */</span>
    <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">CommandLine</span> <span class="n">helpCommandLine</span><span class="o">,</span>
              <span class="nc">Help</span><span class="o">.</span><span class="na">ColorScheme</span> <span class="n">colorScheme</span><span class="o">,</span>
              <span class="nc">PrintWriter</span> <span class="n">outWriter</span><span class="o">,</span>
              <span class="nc">PrintWriter</span> <span class="n">errWriter</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_printing_help_automatically"><a class="anchor" href="#_printing_help_automatically"></a>12.5. Printing Help Automatically</h3>
<div class="paragraph">
<p>As of picocli 2.0, the <a href="#execute">convenience methods</a> will automatically print usage help and version information
when a help option was specified on the command line (options annotated with the <code>versionHelp</code> or <code>usageHelp</code> attribute - but not the <code>help</code> attribute).</p>
</div>
<div class="paragraph">
<p>The same holds for the <code>mixinStandardHelpOptions</code> attribute, the built-in <code>HelpCommand</code> and any custom help subcommands marked as a <a href="#_help_subcommands">help command</a>.</p>
</div>
<div class="paragraph">
<p>The following <a href="#execute">convenience methods</a> automatically print help:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CommandLine::execute</code></p>
</li>
<li>
<p><code>CommandLine::call</code></p>
</li>
<li>
<p><code>CommandLine::run</code></p>
</li>
<li>
<p><code>CommandLine::invoke</code></p>
</li>
<li>
<p><code>CommandLine::parseWithHandler</code> (with the built-in <code>Run&#8230;&#8203;</code> handlers)</p>
</li>
<li>
<p><code>CommandLine::parseWithHandlers</code> (with the built-in <code>Run&#8230;&#8203;</code> handlers)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following methods <strong>do not</strong> automatically print help:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CommandLine::parse</code></p>
</li>
<li>
<p><code>CommandLine::parseArgs</code></p>
</li>
<li>
<p><code>CommandLine::populateCommand</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When using the last three methods, applications need to query the parse result to detect whether usage help or version help
was requested, and invoke <code>CommandLine::usage</code> or <code>CommandLine::printVersionHelp</code> to actually print the requested help message.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version_help"><a class="anchor" href="#_version_help"></a>13. Version Help</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_static_version_information"><a class="anchor" href="#_static_version_information"></a>13.1. Static Version Information</h3>
<div class="sect3">
<h4 id="_command_version_attribute"><a class="anchor" href="#_command_version_attribute"></a>13.1.1. Command <code>version</code> Attribute</h4>
<div class="paragraph">
<p>As of picocli 0.9.8, applications can specify version information in the <code>version</code> attribute of the <code>@Command</code> annotation.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">version</span> <span class="o">=</span> <span class="s">"1.0"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-V"</span><span class="o">,</span> <span class="s">"--version"</span> <span class="o">},</span> <span class="n">versionHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"print version information and exit"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">versionRequested</span><span class="o">;</span>
    <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"1.0"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-V"</span><span class="p">,</span> <span class="s">"--version"</span><span class="p">],</span> <span class="n">versionHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"print version information and exit"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">versionRequested</span> <span class="p">=</span> <span class="k">false</span>
    <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CommandLine.printVersionHelp(PrintStream)</code> method extracts the version information from this
annotation and prints it to the specified <code>PrintStream</code>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">VersionedCommand</span><span class="o">());</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">commandLine</span><span class="o">.</span><span class="na">isVersionHelpRequested</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">commandLine</span><span class="o">.</span><span class="na">printVersionHelp</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">VersionedCommand</span><span class="p">())</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="n">isVersionHelpRequested</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">commandLine</span><span class="p">.</span><span class="nf">printVersionHelp</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multi_line_version_info"><a class="anchor" href="#_multi_line_version_info"></a>13.1.2. Multi-line Version Info</h4>
<div class="paragraph">
<p>The <code>version</code> may specify multiple Strings. Each will be printed on a separate line.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">version</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"Versioned Command 1.0"</span><span class="o">,</span> <span class="s">"Build 12345"</span><span class="o">,</span> <span class="s">"(c) 2017"</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Versioned Command 1.0"</span><span class="p">,</span> <span class="s">"Build 12345"</span><span class="p">,</span> <span class="s">"(c) 2017"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="p">{</span> <span class="cm">/* */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CommandLine.printVersionHelp(PrintStream)</code> method will print the above as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Versioned Command 1.0
Build 12345
(c) 2017</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_info_with_variables"><a class="anchor" href="#_version_info_with_variables"></a>13.1.3. Version Info With Variables</h4>
<div class="paragraph">
<p>As of picocli 4.0, the version strings may contain <a href="#_variable_interpolation">system properties and environment variables</a>. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">version</span> <span class="o">=</span> <span class="o">{</span>
    <span class="s">"Versioned Command 1.0"</span><span class="o">,</span>
    <span class="s">"Picocli "</span> <span class="o">+</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">VERSION</span><span class="o">,</span>
    <span class="s">"JVM: ${java.version} (${java.vendor} ${java.vm.name} ${java.vm.version})"</span><span class="o">,</span>
    <span class="s">"OS: ${os.name} ${os.version} ${os.arch}"</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">version</span> <span class="p">=</span> <span class="p">[</span>
    <span class="s">"Versioned Command 1.0"</span><span class="p">,</span>
    <span class="s">"Picocli "</span> <span class="p">+</span> <span class="n">picocli</span><span class="p">.</span><span class="nc">CommandLine</span><span class="p">.</span><span class="nc">VERSION</span><span class="p">,</span>
    <span class="s">"JVM: \${java.version} (\${java.vendor} \${java.vm.name} \${java.vm.version})"</span><span class="p">,</span>
    <span class="s">"OS: \${os.name} \${os.version} \${os.arch}"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="p">{</span> <span class="cm">/* */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on your environment, that may print something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Versioned Command 1.0
Picocli 4.0.0
JVM: 1.8.0_202 (Oracle Corporation Substrate VM GraalVM 1.0.0-rc15 CE)
OS: Linux 4.4.0-17134-Microsoft amd64</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_info_with_colors"><a class="anchor" href="#_version_info_with_colors"></a>13.1.4. Version Info With Colors</h4>
<div class="paragraph">
<p>The version strings may contain <a href="#_usage_help_with_styles_and_colors">markup</a> to show ANSI styles and colors. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">version</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"@|yellow Versioned Command 1.0|@"</span><span class="o">,</span>
        <span class="s">"@|blue Build 12345|@"</span><span class="o">,</span>
        <span class="s">"@|red,bg(white) (c) 2017|@"</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">version</span> <span class="p">=</span> <span class="p">[</span>
        <span class="s">"@|yellow Versioned Command 1.0|@"</span><span class="p">,</span>
        <span class="s">"@|blue Build 12345|@"</span><span class="p">,</span>
        <span class="s">"@|red,bg(white) (c) 2017|@"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="p">{</span> <span class="cm">/* */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The markup will be rendered as ANSI escape codes on supported systems.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/VersionInfoWithColors.png" alt="Screenshot of version information containing markup with Ansi styles and colors"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_info_with_format_specifiers"><a class="anchor" href="#_version_info_with_format_specifiers"></a>13.1.5. Version Info With Format Specifiers</h4>
<div class="paragraph">
<p>As of picocli 1.0, the <code>version</code> may contain <a href="#_format_specifiers">format specifiers</a>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">version</span> <span class="o">=</span> <span class="o">{</span>
    <span class="s">"Versioned Command 1.0"</span><span class="o">,</span>
    <span class="s">"Build %1$s"</span><span class="o">,</span>
    <span class="s">"(c) 2017, licensed to %2$s"</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">version</span> <span class="p">=</span> <span class="p">[</span>
        <span class="s">"Versioned Command 1.0"</span><span class="p">,</span>
        <span class="s">"Build %1\$s"</span><span class="p">,</span>
        <span class="s">"(c) 2017, licensed to %2\$s"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">VersionedCommand</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Format argument values can be passed to the <code>printVersionHelp</code> method:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span><span class="s">"1234"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"user.name"</span><span class="o">)};</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">VersionedCommand</span><span class="o">())</span>
    <span class="o">.</span><span class="na">printVersionHelp</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">,</span> <span class="nc">Help</span><span class="o">.</span><span class="na">Ansi</span><span class="o">.</span><span class="na">AUTO</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"1234"</span><span class="p">,</span> <span class="nc">System</span><span class="p">.</span><span class="nf">getProperty</span><span class="p">(</span><span class="s">"user.name"</span><span class="p">))</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="nc">VersionedCommand</span><span class="p">()).</span><span class="nf">printVersionHelp</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">,</span> <span class="nc">Help</span><span class="p">.</span><span class="nc">Ansi</span><span class="p">.</span><span class="nc">AUTO</span><span class="p">,</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_version_information"><a class="anchor" href="#_dynamic_version_information"></a>13.2. Dynamic Version Information</h3>
<div class="sect3">
<h4 id="_command_versionprovider_attribute"><a class="anchor" href="#_command_versionprovider_attribute"></a>13.2.1. Command <code>versionProvider</code> Attribute</h4>
<div class="paragraph">
<p>As of picocli 2.2, the <code>@Command</code> annotation supports a <code>versionProvider</code> attribute.
Applications may specify a <code>IVersionProvider</code> implementation in this attribute, and picocli will instantiate this class
and invoke it to collect version information.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">versionProvider</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="na">my</span><span class="o">.</span><span class="na">custom</span><span class="o">.</span><span class="na">ManifestVersionProvider</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">versionProvider</span> <span class="p">=</span> <span class="n">com</span><span class="p">.</span><span class="n">my</span><span class="p">.</span><span class="n">custom</span><span class="p">.</span><span class="nc">ManifestVersionProvider</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is useful when the version of an application should be detected dynamically at runtime.
For example, an implementation may return version information obtained from the JAR manifest, a properties file or some other source.</p>
</div>
</div>
<div class="sect3">
<h4 id="_iversionprovider_interface"><a class="anchor" href="#_iversionprovider_interface"></a>13.2.2. <code>IVersionProvider</code> Interface</h4>
<div class="paragraph">
<p>Custom version providers need to implement the <code>picocli.CommandLine.IVersionProvider</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IVersionProvider</span> <span class="o">{</span>
    <span class="cm">/**
     * Returns version information for a command.
     * @return version information (each string in the array is displayed on a separate line)
     * @throws Exception an exception detailing what went wrong when obtaining version information
     */</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="nf">getVersion</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Version providers declared with the <code>versionProvider</code> attribute need to have a public no-argument constructor to be instantiated, unless a <a href="#_custom_factory">Custom Factory</a> is installed to instantiate classes.</p>
</div>
<div class="paragraph">
<p>The GitHub project has a manifest file-based
<a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/VersionProviderDemo2.java">example</a>
and a build-generated version properties file-based
<a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/VersionProviderDemo1.java">example</a> version provider implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dynamic_version_info_with_variables"><a class="anchor" href="#_dynamic_version_info_with_variables"></a>13.2.3. Dynamic Version Info with Variables</h4>
<div class="paragraph">
<p>The version strings returned from the <code>IVersionProvider</code> may contain <a href="#_variable_interpolation">system properties and environment variables</a>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">VersionProviderWithVariables</span> <span class="kd">implements</span> <span class="nc">IVersionProvider</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span><span class="o">[]</span> <span class="nf">getVersion</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]</span> <span class="o">{</span> <span class="s">"${COMMAND-FULL-NAME} version 1.0"</span> <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">VersionProviderWithVariables</span> <span class="p">:</span> <span class="nc">IVersionProvider</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getVersion</span><span class="p">():</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"\${COMMAND-FULL-NAME} version 1.0"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example version provider will show the fully qualified command name (that is, preceded by its parent fully qualified command name)
of any command that uses this version provider.</p>
</div>
<div class="paragraph">
<p>This is one way to create a version provider that can be reused across multiple commands.</p>
</div>
</div>
<div class="sect3">
<h4 id="_injecting_commandspec_into_a_iversionprovider"><a class="anchor" href="#_injecting_commandspec_into_a_iversionprovider"></a>13.2.4. Injecting <code>CommandSpec</code> Into a <code>IVersionProvider</code></h4>
<div class="paragraph">
<p>As of picocli 4.2.0, <code>IVersionProvider</code> implementations can have <code>@Spec</code>-annotated fields. If such a field
exists, picocli will inject the <code>CommandSpec</code> of the command that uses this version provider.
This gives the version provider access to the full command hierarchy,
and may make it easier to implement version providers that can be reused among multiple commands.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyVersionProvider</span> <span class="kd">implements</span> <span class="nc">IVersionProvider</span> <span class="o">{</span>
    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span><span class="o">[]</span> <span class="nf">getVersion</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]</span> <span class="o">{</span> <span class="s">"Version info for "</span> <span class="o">+</span> <span class="n">spec</span><span class="o">.</span><span class="na">qualifiedName</span><span class="o">()</span> <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyVersionProvider</span> <span class="p">:</span> <span class="nc">IVersionProvider</span> <span class="p">{</span>
    <span class="nd">@Spec</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getVersion</span><span class="p">():</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"Version info for "</span> <span class="p">+</span> <span class="n">spec</span><span class="p">.</span><span class="nf">qualifiedName</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage_help"><a class="anchor" href="#_usage_help"></a>14. Usage Help</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_compact_example"><a class="anchor" href="#_compact_example"></a>14.1. Compact Example</h3>
<div class="paragraph">
<p>A default picocli usage help message looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: cat [-AbeEnstTuv] [--help] [--version] [FILE...]
Concatenate FILE(s), or standard input, to standard output.
      FILE                 Files whose contents to display
  -A, --show-all           equivalent to -vET
  -b, --number-nonblank    number nonempty output lines, overrides -n
  -e                       equivalent to -vE
  -E, --show-ends          display $ at end of each line
  -n, --number             number all output lines
  -s, --squeeze-blank      suppress repeated empty output lines
  -t                       equivalent to -vT
  -T, --show-tabs          display TAB characters as ^I
  -u                       (ignored)
  -v, --show-nonprinting   use ^ and M- notation, except for LFD and TAB
      --help               display this help and exit
      --version            output version information and exit
Copyright(c) 2017</pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message is generated from annotation attributes, like below:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"cat"</span><span class="o">,</span> <span class="n">footer</span> <span class="o">=</span> <span class="s">"Copyright(c) 2017"</span><span class="o">,</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s">"Concatenate FILE(s), or standard input, to standard output."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"FILE"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Files whose contents to display"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--help"</span><span class="o">,</span> <span class="n">usageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"display this help and exit"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">help</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-t"</span><span class="o">,</span>                 <span class="n">description</span> <span class="o">=</span> <span class="s">"equivalent to -vT"</span><span class="o">)</span>  <span class="kt">boolean</span> <span class="n">t</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-e"</span><span class="o">,</span>                 <span class="n">description</span> <span class="o">=</span> <span class="s">"equivalent to -vE"</span><span class="o">)</span>  <span class="kt">boolean</span> <span class="n">e</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-A"</span><span class="o">,</span> <span class="s">"--show-all"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"equivalent to -vET"</span><span class="o">)</span> <span class="kt">boolean</span> <span class="n">all</span><span class="o">;</span>

    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"cat"</span><span class="p">,</span> <span class="n">footer</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Copyright(c) 2017"</span><span class="p">],</span>
         <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Concatenate FILE(s), or standard input, to standard output."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="p">{</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"FILE"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Files whose contents to display"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--help"</span><span class="p">],</span> <span class="n">usageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"display this help and exit"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">help</span> <span class="p">=</span> <span class="k">false</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-t"</span><span class="p">],</span>               <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"equivalent to -vT"</span><span class="p">])</span>  <span class="kd">var</span> <span class="py">t</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-e"</span><span class="p">],</span>               <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"equivalent to -vE"</span><span class="p">])</span>  <span class="kd">var</span> <span class="py">e</span> <span class="p">=</span> <span class="k">false</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-A"</span><span class="p">,</span> <span class="s">"--show-all"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"equivalent to -vET"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">all</span> <span class="p">=</span> <span class="k">false</span>

    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_command_name"><a class="anchor" href="#_command_name"></a>14.2. Command Name</h3>
<div class="paragraph">
<p>In the above example, the program name is taken from the <code>name</code> attribute of the <code>Command</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"cat"</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without a <code>name</code> attribute, picocli will show a generic <code>&lt;main class&gt;</code> in the synopsis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [-AbeEnstTuv] [--help] [--version] [FILE...]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parameter_labels"><a class="anchor" href="#_parameter_labels"></a>14.3. Parameter Labels</h3>
<div class="paragraph">
<p>Non-boolean options require a value. The usage help should explain this, and picocli shows the option parameter
in the synopsis and in the option list. By default, the field name is shown in <code>&lt;</code> and <code>&gt;</code> fish brackets.
Use the <code>paramLabel</code> attribute to display a different name. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [-f=FILE] [-n=&lt;number&gt;] NUM &lt;host&gt;
      NUM        number param
      host       the host parameter
  -f= FILE       a file
  -n= &lt;number&gt;   a number option</pre>
</div>
</div>
<div class="paragraph">
<p>Some annotated fields in the below example class have a <code>paramLabel</code> attribute and others don&#8217;t:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">()</span>
<span class="kd">class</span> <span class="nc">ParamLabels</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-f"</span><span class="o">,</span>    <span class="n">description</span> <span class="o">=</span> <span class="s">"a file"</span><span class="o">,</span>       <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"FILE"</span><span class="o">)</span> <span class="nc">File</span> <span class="n">f</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-n"</span><span class="o">,</span>    <span class="n">description</span> <span class="o">=</span> <span class="s">"a number option"</span><span class="o">)</span>                   <span class="kt">int</span> <span class="n">number</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"number param"</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"NUM"</span><span class="o">)</span>  <span class="kt">int</span> <span class="n">n</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"the host parameter"</span><span class="o">)</span>                <span class="nc">InetAddress</span> <span class="n">host</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">ParamLabels</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"a file"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"FILE"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">f</span><span class="p">:</span> <span class="nc">File</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-n"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"a number option"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">number</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"number param"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"NUM"</span><span class="p">)</span>
    <span class="kd">var</span> <span class="py">n</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the host parameter"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">host</span><span class="p">:</span> <span class="nc">InetAddress</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For demonstration purposes the above example mixes the all-uppercase (e.g., <code>NUM</code>) style label and the fish bracket (e.g., <code>&lt;number&gt;</code>) style labels. For real applications, mixing these label styles should be avoided. An application should consistently use only one style.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_option_list"><a class="anchor" href="#_option_list"></a>14.4. Option List</h3>
<div class="sect3">
<h4 id="_unsorted_option_list"><a class="anchor" href="#_unsorted_option_list"></a>14.4.1. Unsorted Option List</h4>
<div class="paragraph">
<p>By default the options list displays options in alphabetical order. Use the <code>sortOptions = false</code> attribute to display options in the order they are declared in your class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">sortOptions</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_reordering_options"><a class="anchor" href="#_reordering_options"></a>14.4.2. Reordering Options</h4>
<div class="paragraph">
<p>When mixing <code>@Option</code> methods and <code>@Option</code> fields, options do not reliably appear in declaration order.</p>
</div>
<div class="paragraph">
<p>The <code>@Option(order = &lt;int&gt;)</code> attribute can be used to explicitly control the position in the usage help message at which the option should be shown.
Options with a lower number are shown before options with a higher number.</p>
</div>
</div>
<div class="sect3">
<h4 id="_required_option_marker"><a class="anchor" href="#_required_option_marker"></a>14.4.3. Required-Option Marker</h4>
<div class="paragraph">
<p>Required options can be marked in the option list by the character specified with the <code>requiredOptionMarker</code> attribute. By default options are not marked because the synopsis shows users which options are required and which are optional. This feature may be useful in combination with the <a href="#_abbreviated_synopsis"><code>abbreviateSynopsis</code></a> attribute. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">requiredOptionMarker</span> <span class="o">=</span> <span class="sc">'*'</span><span class="o">,</span> <span class="n">abbreviateSynopsis</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-a"</span><span class="o">,</span> <span class="s">"--alpha"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"optional alpha"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">alpha</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-b"</span><span class="o">,</span> <span class="s">"--beta"</span><span class="o">},</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"mandatory beta"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">beta</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">requiredOptionMarker</span> <span class="p">=</span> <span class="sc">'*'</span><span class="p">,</span> <span class="n">abbreviateSynopsis</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-a"</span><span class="p">,</span> <span class="s">"--alpha"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"optional alpha"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">alpha</span><span class="p">:</span> <span class="nc">String</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-b"</span><span class="p">,</span> <span class="s">"--beta"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"mandatory beta"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">beta</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Produces the following usage help message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [OPTIONS]
  -a, --alpha=&lt;alpha&gt;   optional alpha
* -b, --beta=&lt;beta&gt;     mandatory beta</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_short_and_long_option_columns"><a class="anchor" href="#_short_and_long_option_columns"></a>14.4.4. Short and Long Option Columns</h4>
<div class="paragraph">
<p>The default layout shows short options and long options in separate columns, followed by the description column.</p>
</div>
<div class="paragraph">
<p>Only <a href="#_short_posix_options">POSIX short options</a> are shown in the first column, that is, options that start with a single <code>-</code> dash and are one character long.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Options with two characters are not considered short options and are shown in the long option column.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is a common layout for Unix utilities, and can enhance usability:
applications can give a subtle hint to end users that an option is common and encouraged by providing both a short and a long name for the option.
Conversely, the absence of a short option can signal that the option is unusual or perhaps should be used with care.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is possible to left-align all options by using a custom layout.
See <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/leftalign/LeftAlignOptions.java">LeftAlignOptions.java</a> in the <code>picocli-examples</code> module for an example.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_long_option_column_width"><a class="anchor" href="#_long_option_column_width"></a>14.4.5. Long Option Column Width</h4>
<div class="paragraph">
<p>The default layout shows short options and long options in separate columns, followed by the description column.
The width of the long options column shrinks automatically if all long options are very short,
but by default this column does not grow larger than 20 characters.</p>
</div>
<div class="paragraph">
<p>If the long option with its option parameter is longer than 20 characters
(for example: <code>--output=&lt;outputFolder&gt;</code>), the long option overflows into the description column, and the option description is shown on the next line.</p>
</div>
<div class="paragraph">
<p>This (the default) looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [-o=&lt;outputFolder&gt;]
  -h, --help      Show this help message and exit.
  -o, --output=&lt;outputFolder&gt;
                  Output location full path.
  -V, --version   Print version information and exit.</pre>
</div>
</div>
<div class="paragraph">
<p>As of picocli 4.2, there is programmatic API to change this via the <code>CommandLine::setUsageHelpLongOptionsMaxWidth</code> and <code>UsageMessageSpec::longOptionsMaxWidth</code> methods.</p>
</div>
<div class="paragraph">
<p>In the above example, if we call <code>commandLine.setUsageHelpLongOptionsMaxWidth(23)</code> before printing the usage help, we get this result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [-o=&lt;outputFolder&gt;]
  -h, --help                    Show this help message and exit.
  -o, --output=&lt;outputFolder&gt;   Output location full path.
  -V, --version                 Print version information and exit.</pre>
</div>
</div>
<div class="paragraph">
<p>The minimum value that can be specified for <code>longOptionsMaxWidth</code> is 20, the maximum value is the <a href="#_usage_width">usage width</a> minus <code>20</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage_width"><a class="anchor" href="#_usage_width"></a>14.5. Usage Width</h3>
<div class="paragraph">
<p>The default width of the usage help message is 80 characters.
Commands defined with <code>@Command(usageHelpWidth = NUMBER)</code> in the annotations will use the specified width.</p>
</div>
<div class="paragraph">
<p>Picocli 3.0 also introduced programmatic API for this via the <code>CommandLine::setUsageHelpWidth</code> and <code>UsageMessageSpec::width</code> methods.</p>
</div>
<div class="paragraph">
<p>End users can use system property <code>picocli.usage.width</code> to specify a custom width that overrides the programmatically set value.</p>
</div>
<div class="paragraph">
<p>The minimum width that can be configured is 55 characters.</p>
</div>
</div>
<div class="sect2">
<h3 id="_auto_terminal_width"><a class="anchor" href="#_auto_terminal_width"></a>14.6. Auto (Terminal) Width</h3>
<div class="paragraph">
<p>As of picocli 4.0, commands defined with <code>@Command(usageHelpAutoWidth = true)</code> will try to adjust the usage message help layout to the terminal width.
There is also programmatic API to control this via the <code>CommandLine::setUsageHelpAutoWidth</code> and <code>UsageMessageSpec::autoWidth</code> methods.</p>
</div>
<div class="paragraph">
<p>End users may enable this by setting system property <code>picocli.usage.width</code> to <code>AUTO</code>, and may disable this by setting this system property to a numeric value.</p>
</div>
<div class="paragraph">
<p>This feature requires Java 7.</p>
</div>
</div>
<div class="sect2">
<h3 id="_split_synopsis_label"><a class="anchor" href="#_split_synopsis_label"></a>14.7. Split Synopsis Label</h3>
<div class="paragraph">
<p>Options and parameters may have a <a href="#_split_regex"><code>split</code></a> attribute to split each parameter into smaller substrings.
Regular expressions may contain literal text, but may also contain <a href="https://www.regular-expressions.info/characters.html">special characters</a>.
The regular expression in the <code>split</code> attribute may be quite different from what end users need to type.</p>
</div>
<div class="paragraph">
<p>The example below uses the plus (<code>+</code>) character as a separator.
The regular expression in the <code>split</code> attribute uses backslash (<code>\</code>) characters to make sure that the plus character is treated as a literal.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Parameters</span><span class="o">(</span><span class="n">split</span> <span class="o">=</span> <span class="s">"\\+"</span><span class="o">,</span> <span class="n">splitSynopsisLabel</span> <span class="o">=</span> <span class="s">"+"</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"VALUE"</span><span class="o">)</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">values</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Parameters</span><span class="p">(</span><span class="n">split</span> <span class="p">=</span> <span class="s">"\\+"</span><span class="p">,</span> <span class="n">splitSynopsisLabel</span> <span class="p">=</span> <span class="s">"+"</span><span class="p">,</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"VALUE"</span><span class="p">)</span>
<span class="k">lateinit</span> <span class="kd">var</span> <span class="py">values</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, end users can type simply  <code>A+B+C</code> (using the plus character separator), not  <code>A\+B\+C</code>.
We want the usage help message to show this.</p>
</div>
<div class="paragraph">
<p>The <code>splitSynopsisLabel</code> attribute, introduced in picocli 4.3, controls what is shown in the synopsis of the usage help message.</p>
</div>
<div class="paragraph">
<p>With the example above, the synopsis of the usage help looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: cmd [VALUE[+VALUE...]...]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_abbreviated_synopsis"><a class="anchor" href="#_abbreviated_synopsis"></a>14.8. Abbreviated Synopsis</h3>
<div class="paragraph">
<p>If a command is very complex and has many options, it is sometimes desirable to suppress details from the synopsis with the <code>abbreviateSynopsis</code> attribute. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [OPTIONS] [&lt;files&gt;...]</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the positional parameters are not abbreviated.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">abbreviateSynopsis</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Parameters</span> <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"--count"</span><span class="o">,</span> <span class="s">"-c"</span><span class="o">})</span> <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">abbreviateSynopsis</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--count"</span><span class="p">,</span> <span class="s">"-c"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_synopsis"><a class="anchor" href="#_custom_synopsis"></a>14.9. Custom Synopsis</h3>
<div class="paragraph">
<p>For even more control of the synopsis, use the <code>customSynopsis</code> attribute to specify one ore more synopsis lines. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: ln [OPTION]... [-T] TARGET LINK_NAME   (1st form)
  or:  ln [OPTION]... TARGET                  (2nd form)
  or:  ln [OPTION]... TARGET... DIRECTORY     (3rd form)
  or:  ln [OPTION]... -t DIRECTORY TARGET...  (4th form)</pre>
</div>
</div>
<div class="paragraph">
<p>To produce a synopsis like the above, specify the literal text in the <code>customSynopsis</code> attribute:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">synopsisHeading</span> <span class="o">=</span> <span class="s">""</span><span class="o">,</span> <span class="n">customSynopsis</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"Usage: ln [OPTION]... [-T] TARGET LINK_NAME   (1st form)"</span><span class="o">,</span>
        <span class="s">"  or:  ln [OPTION]... TARGET                  (2nd form)"</span><span class="o">,</span>
        <span class="s">"  or:  ln [OPTION]... TARGET... DIRECTORY     (3rd form)"</span><span class="o">,</span>
        <span class="s">"  or:  ln [OPTION]... -t DIRECTORY TARGET...  (4th form)"</span><span class="o">,</span>
<span class="o">})</span>
<span class="kd">class</span> <span class="nc">Ln</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">synopsisHeading</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">customSynopsis</span> <span class="p">=</span> <span class="p">[</span><span class="s">"""
Usage: ln [OPTION]... [-T] TARGET LINK_NAME   (1st form)
   or: ln [OPTION]... TARGET                  (2nd form)
   or: ln [OPTION]... TARGET... DIRECTORY     (3rd form)
   or:  ln [OPTION]... -t DIRECTORY TARGET...  (4th form)"""</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Ln</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_synopsis_subcommand_label"><a class="anchor" href="#_synopsis_subcommand_label"></a>14.10. Synopsis Subcommand Label</h3>
<div class="paragraph">
<p>For commands with <a href="#_usage_help_for_subcommands">subcommands</a>, the string <code>[COMMAND]</code> is appended to the end of the synopsis (whether the synopsis is <a href="#_abbreviated_synopsis">abbreviated</a> or not). This looks something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;cmd&gt; [OPTIONS] FILES [COMMAND]</pre>
</div>
</div>
<div class="paragraph">
<p>As of picocli 4.0, this can be customized with the <code>synopsisSubcommandLabel</code> attribute.</p>
</div>
<div class="paragraph">
<p>For example, to clarify that a <a href="#_required_subcommands">subcommand is mandatory</a>, an application may specify <code>COMMAND</code>, without the <code>[</code> and <code>]</code> brackets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git"</span><span class="o">,</span> <span class="n">synopsisSubcommandLabel</span> <span class="o">=</span> <span class="s">"COMMAND"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An application with a limited number of subcommands may want to show them all in the synopsis, for example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"fs"</span><span class="o">,</span> <span class="n">synopsisSubcommandLabel</span> <span class="o">=</span> <span class="s">"(list | add | delete)"</span><span class="o">,</span>
         <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span><span class="nc">List</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Add</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Delete</span><span class="o">.</span><span class="na">class</span><span class="o">},</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Fs</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"fs"</span><span class="p">,</span> <span class="n">synopsisSubcommandLabel</span> <span class="p">=</span> <span class="s">"(list | add | delete)"</span><span class="p">,</span>
         <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">List</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Add</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Delete</span><span class="o">::</span><span class="k">class</span><span class="p">],</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Fs</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will show the following synopsis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: fs [-hV] (list | add | delete)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_header_and_footer"><a class="anchor" href="#_header_and_footer"></a>14.11. Header and Footer</h3>
<div class="paragraph">
<p>The <code>header</code> will be shown at the top of the usage help message (before the synopsis). The first header line is also the line shown in the subcommand list if your command has subcommands (see <a href="#_usage_help_for_subcommands">Usage Help for Subcommands</a>).</p>
</div>
<div class="paragraph">
<p>Use the <code>footer</code> attribute to specify one or more lines to show below the generated usage help message.</p>
</div>
<div class="paragraph">
<p>Each element of the attribute String array is displayed on a separate line.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exit_code_list"><a class="anchor" href="#_exit_code_list"></a>14.12. Exit Code List</h3>
<div class="paragraph">
<p>By default, the usage help message does not display <a href="#_generating_an_exit_code">exit code</a> information.
Applications that call <code>System.exit</code> need to configure the <code>exitCodeListHeading</code> and <code>exitCodeList</code> annotation attributes.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
         <span class="n">exitCodeListHeading</span> <span class="o">=</span> <span class="s">"Exit Codes:%n"</span><span class="o">,</span>
         <span class="n">exitCodeList</span> <span class="o">=</span> <span class="o">{</span>
             <span class="s">" 0:Successful program execution"</span><span class="o">,</span>
             <span class="s">"64:Usage error: user input for the command was incorrect, "</span> <span class="o">+</span>
                     <span class="s">"e.g., the wrong number of arguments, a bad flag, "</span> <span class="o">+</span>
                     <span class="s">"a bad syntax in a parameter, etc."</span><span class="o">,</span>
             <span class="s">"70:Internal software error: an exception occurred when invoking "</span> <span class="o">+</span>
                     <span class="s">"the business logic of this command."</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{}</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">App</span><span class="o">()).</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">exitCodeListHeading</span> <span class="p">=</span> <span class="s">"Exit Codes:%n"</span><span class="p">,</span>
         <span class="n">exitCodeList</span> <span class="p">=</span> <span class="p">[</span>
             <span class="s">" 0:Successful program execution"</span><span class="p">,</span>
             <span class="s">"64:Usage error: user input for the command was incorrect,"</span>  <span class="p">+</span>
                    <span class="s">"e.g., the wrong number of arguments, a bad flag, "</span> <span class="p">+</span>
                    <span class="s">"a bad syntax in a parameter, etc."</span><span class="p">,</span>
             <span class="s">"70:Internal software error: an exception occurred when invoking "</span> <span class="p">+</span>
                    <span class="s">"the business logic of this command."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{}</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">:</span> <span class="nc">Unit</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">App</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will print the following usage help message to the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Usage: &lt;main class&gt;
Exit Codes:
   0   Successful program execution
  64   Usage error: user input for the command was incorrect, e.g., the wrong
         number of arguments, a bad flag, a bad syntax in a parameter, etc.
  70   Internal software error: an exception occurred when invoking the
         business logic of this command.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_format_specifiers"><a class="anchor" href="#_format_specifiers"></a>14.13. Format Specifiers</h3>
<div class="paragraph">
<p>All usage help message elements can have embedded line separator (<code>%n</code>) format specifiers.
These are converted to the platform-specific line separator when the usage help message is printed.</p>
</div>
<div class="paragraph">
<p><a href="#_static_version_information">Version help</a> may have format specifiers that format additional arguments passed to the <code>printVersionHelp</code> method.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html">java.util.Formatter javadoc</a> for details.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Note that to show percent <code>'%'</code> characters in the usage help message, they need to be escaped with another <code>%</code>. For example: <code>@Parameters(description = "%%-age of the total")</code> is rendered as <code>%-age of the total</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An alternative way to control the layout of the usage help message is that some sections (<code>header</code>, <code>footer</code>, and <code>description</code>) can be specified as an array of Strings,
where each element of the array is displayed on a separate line in the usage help message.</p>
</div>
</div>
<div class="sect2">
<h3 id="_section_headings"><a class="anchor" href="#_section_headings"></a>14.14. Section Headings</h3>
<div class="paragraph">
<p>Section headers can be used to make usage message layout appear more spacious. The example below demonstrates the use of embedded line separator (<code>%n</code>) format specifiers:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"commit"</span><span class="o">,</span>
         <span class="n">sortOptions</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
         <span class="n">headerHeading</span> <span class="o">=</span> <span class="s">"Usage:%n%n"</span><span class="o">,</span>
         <span class="n">synopsisHeading</span> <span class="o">=</span> <span class="s">"%n"</span><span class="o">,</span>
         <span class="n">descriptionHeading</span> <span class="o">=</span> <span class="s">"%nDescription:%n%n"</span><span class="o">,</span>
         <span class="n">parameterListHeading</span> <span class="o">=</span> <span class="s">"%nParameters:%n"</span><span class="o">,</span>
         <span class="n">optionListHeading</span> <span class="o">=</span> <span class="s">"%nOptions:%n"</span><span class="o">,</span>
         <span class="n">header</span> <span class="o">=</span> <span class="s">"Record changes to the repository."</span><span class="o">,</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s">"Stores the current contents of the index in a new commit "</span> <span class="o">+</span>
                 <span class="s">"along with a log message from the user describing the changes."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">GitCommit</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"commit"</span><span class="p">,</span>
         <span class="n">sortOptions</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
         <span class="n">headerHeading</span> <span class="p">=</span> <span class="s">"Usage:%n%n"</span><span class="p">,</span>
         <span class="n">synopsisHeading</span> <span class="p">=</span> <span class="s">"%n"</span><span class="p">,</span>
         <span class="n">descriptionHeading</span> <span class="p">=</span> <span class="s">"%nDescription:%n%n"</span><span class="p">,</span>
         <span class="n">parameterListHeading</span> <span class="p">=</span> <span class="s">"%nParameters:%n"</span><span class="p">,</span>
         <span class="n">optionListHeading</span> <span class="p">=</span> <span class="s">"%nOptions:%n"</span><span class="p">,</span>
         <span class="n">header</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Record changes to the repository."</span><span class="p">],</span>
         <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Stores the current contents of the index in a new commit "</span> <span class="p">+</span>
                 <span class="s">"along with a log message from the user describing the changes."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">GitCommit</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message generated from this class is shown below in <a href="#_expanded_example">Expanded Example</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_expanded_example"><a class="anchor" href="#_expanded_example"></a>14.15. Expanded Example</h3>
<div class="paragraph">
<p>The below example demonstrates what a customized usage message can look like.
Note how section headings with line separators can create a more spacious usage message,
and also that options are listed in declaration order (instead of in alphabetic order).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage:

Record changes to the repository.

git commit [-ap] [--fixup=&lt;commit&gt;] [--squash=&lt;commit&gt;] [-c=&lt;commit&gt;]
           [-C=&lt;commit&gt;] [-F=&lt;file&gt;] [-m[=&lt;msg&gt;...]] [&lt;files&gt;...]

Description:

Stores the current contents of the index in a new commit along with a log
message from the user describing the changes.

Parameters:
      &lt;files&gt;                 the files to commit

Options:
  -a, --all                   Tell the command to automatically stage files
                                that have been modified and deleted, but new
                                files you have not told Git about are not
                                affected.
  -p, --patch                 Use the interactive patch selection interface to
                                chose which changes to commit
  -C, --reuse-message=&lt;commit&gt;
                              Take an existing commit object, and reuse the log
                                message and the authorship information
                                (including the timestamp) when creating the
                                commit.
  -c, --reedit-message=&lt;commit&gt;
                              Like -C, but with -c the editor is invoked, so
                                that the user can further edit the commit
                                message.
      --fixup=&lt;commit&gt;        Construct a commit message for use with rebase
                                --autosquash.
      --squash=&lt;commit&gt;        Construct a commit message for use with rebase
                                --autosquash. The commit message subject line is
                                taken from the specified commit with a prefix
                                of "squash! ". Can be used with additional
                                commit message options (-m/-c/-C/-F).
  -F, --file=&lt;file&gt;           Take the commit message from the given file. Use
                                - to read the message from the standard input.
  -m, --message[=&lt;msg&gt;...]     Use the given &lt;msg&gt; as the commit message. If
                                multiple -m options are given, their values are
                                concatenated as separate paragraphs.</pre>
</div>
</div>
<div class="paragraph">
<p>The annotated class that this usage help message is generated from is shown in <a href="#_section_headings">Section Headings</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_option_parameter_separators"><a class="anchor" href="#_option_parameter_separators"></a>14.16. Option-Parameter Separators</h3>
<div class="paragraph">
<p>The separator displayed between options and option parameters (<code>=</code> by default)
in the synopsis and the option list can be configured with the <code>separator</code> attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">separator</span> <span class="o">=</span> <span class="s">" "</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>@Command(separator = " ")</code> annotation also affects how picocli parses the command line.  See also <a href="#_custom_separators">Custom Separators</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_hidden_options_and_parameters"><a class="anchor" href="#_hidden_options_and_parameters"></a>14.17. Hidden Options and Parameters</h3>
<div class="paragraph">
<p>Options and Parameters with the <code>hidden</code> attribute set to <code>true</code> will not be shown in the usage help message.
This is useful for example when a parameter at some index is captured into multiple fields:
by default each of these fields would be shown in the usage message, which would be confusing for users.</p>
</div>
<div class="paragraph">
<p>For example, the <code>all</code> field below is annotated as <code>hidden = true</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">()</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">,</span>    <span class="n">description</span> <span class="o">=</span> <span class="s">"destination host"</span><span class="o">)</span>  <span class="nc">InetAddress</span> <span class="n">host</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">,</span>    <span class="n">description</span> <span class="o">=</span> <span class="s">"destination port"</span><span class="o">)</span>  <span class="kt">int</span> <span class="n">port</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"2..*"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"files to transfer"</span><span class="o">)</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">hidden</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">all</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">,</span>    <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"destination host"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">host</span><span class="p">:</span> <span class="nc">InetAddress</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">,</span>    <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"destination port"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">port</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"2..*"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"files to transfer"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">hidden</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">all</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above will generate the following usage help message, where the <code>all</code> field is not shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; &lt;host&gt; &lt;port&gt; [&lt;files&gt;...]
      host    destination host
      port    destination port
      files   files to transfer</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_at_files"><a class="anchor" href="#_show_at_files"></a>14.18. Show At Files</h3>
<div class="paragraph">
<p>As of picocli 4.2, an entry for <code>@&lt;filename&gt;</code> can be shown in the options and parameters list of the usage help message of a command with the <code>@Command(showAtFileInUsageHelp = true)</code> annotation.</p>
</div>
<div class="sect3">
<h4 id="_example_2"><a class="anchor" href="#_example_2"></a>14.18.1. Example</h4>
<div class="paragraph">
<p>Example command:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">showAtFileInUsageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example command."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"A file."</span><span class="o">)</span> <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">showAtFileInUsageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example command."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"A file."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message for this command looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [@&lt;filename&gt;...] &lt;file&gt;
Example command.
      [@&lt;filename&gt;...]   One or more argument files containing options.
      &lt;file&gt;             A file.
  -h, --help             Show this help message and exit.
  -V, --version          Print version information and exit.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_at_file_entry_location"><a class="anchor" href="#_changing_the_at_file_entry_location"></a>14.18.2. Changing the At File Entry Location</h4>
<div class="paragraph">
<p>By default, the <code>@&lt;filename&gt;</code> entry is shown before the positional parameters in the synopsis as well as in the parameters list.</p>
</div>
<div class="paragraph">
<p>This can be changed with the <a href="#_usage_help_api">Help API</a> for reordering sections. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.</span><span class="na">SECTION_KEY_AT_FILE_PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.</span><span class="na">SECTION_KEY_COMMAND_LIST_HEADING</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">showAtFileInUsageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example command."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"A file."</span><span class="o">)</span> <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">());</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getHelpSectionKeys</span><span class="o">());</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="no">SECTION_KEY_AT_FILE_PARAMETER</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">copy</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="no">SECTION_KEY_COMMAND_LIST_HEADING</span><span class="o">),</span> <span class="no">SECTION_KEY_AT_FILE_PARAMETER</span><span class="o">);</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">setHelpSectionKeys</span><span class="o">(</span><span class="n">copy</span><span class="o">);</span>

        <span class="n">cmd</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.Model.UsageMessageSpec.SECTION_KEY_COMMAND_LIST_HEADING</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Model.UsageMessageSpec.SECTION_KEY_AT_FILE_PARAMETER</span>
<span class="c1">// ...</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">showAtFileInUsageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example command."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"A file."</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
            <span class="kd">val</span> <span class="py">copy</span><span class="p">:</span> <span class="nc">MutableList</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">ArrayList</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span><span class="p">)</span>
            <span class="n">copy</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="nc">SECTION_KEY_AT_FILE_PARAMETER</span><span class="p">)</span>
            <span class="n">copy</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="nc">SECTION_KEY_COMMAND_LIST_HEADING</span><span class="p">),</span> <span class="nc">SECTION_KEY_AT_FILE_PARAMETER</span><span class="p">)</span>
            <span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span> <span class="p">=</span> <span class="n">copy</span>
            <span class="n">cmd</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting usage help message shows the <code>@&lt;filename&gt;</code> entry has moved to the bottom, following the options list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [@&lt;filename&gt;...] &lt;file&gt;
Example command.
      &lt;file&gt;             A file.
  -h, --help             Show this help message and exit.
  -V, --version          Print version information and exit.
      [@&lt;filename&gt;...]   One or more argument files containing options.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_at_file_entry_text"><a class="anchor" href="#_changing_the_at_file_entry_text"></a>14.18.3. Changing the At File Entry Text</h4>
<div class="paragraph">
<p>Both the label and the description of the <code>@&lt;filename&gt;</code> entry have been defined with <a href="#_custom_variables">custom variables</a>, to allow applications to change the text. The variables are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>picocli.atfile.label</code></p>
</li>
<li>
<p><code>picocli.atfile.description</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By setting the above variables in either system properties, environment variables or the <a href="#_internationalization">resource bundle</a> for a command, the text can be customized.</p>
</div>
<div class="paragraph">
<p>For example, if we define these system properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"picocli.atfile.label"</span><span class="o">,</span> <span class="s">"my@@@@file"</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"picocli.atfile.description"</span><span class="o">,</span> <span class="s">"@files rock!"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>then the usage help for our above example changes to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [my@@@@file...] &lt;file&gt;
Example command.
      [my@@@@file...]   @files rock!
      &lt;file&gt;            A file.
  -h, --help            Show this help message and exit.
  -V, --version         Print version information and exit.</pre>
</div>
</div>
<div class="paragraph">
<p>The description of the <code>@&lt;filename&gt;</code> entry can also be specified in a <a href="#_internationalization">resource bundle</a> for internationalization and localization.
The <code>descriptionKey</code> for the <code>@&lt;filename&gt;</code> entry in resource bundles is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>picocli.atfile</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_end_of_options"><a class="anchor" href="#_show_end_of_options"></a>14.19. Show End of Options</h3>
<div class="paragraph">
<p>As of picocli 4.3, an entry for the <code>--</code> <a href="#_double_dash">End of Options delimiter</a> can be shown in the options list of the usage help message of a command with the <code>@Command(showEndOfOptionsDelimiterInUsageHelp = true)</code> annotation.</p>
</div>
<div class="sect3">
<h4 id="_example_3"><a class="anchor" href="#_example_3"></a>14.19.1. Example</h4>
<div class="paragraph">
<p>Example command:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">showEndOfOptionsDelimiterInUsageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example command."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"A file."</span><span class="o">)</span> <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">showEndOfOptionsDelimiterInUsageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example command."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"A file."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message for this command looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [--] &lt;file&gt;
Example command.
      &lt;file&gt;      A file.
  -h, --help      Show this help message and exit.
  -V, --version   Print version information and exit.
  --              This option can be used to separate command-line options from
                    the list of positional parameters.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_end_of_options_entry_location"><a class="anchor" href="#_changing_the_end_of_options_entry_location"></a>14.19.2. Changing the End of Options Entry Location</h4>
<div class="paragraph">
<p>By default, the <code>--</code> End of Options entry is shown between the options and the positional parameters in the synopsis, and at the end of the options list.</p>
</div>
<div class="paragraph">
<p>This can be changed with the <a href="#_usage_help_api">Help API</a> for reordering sections. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.</span><span class="na">SECTION_KEY_END_OF_OPTIONS</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.</span><span class="na">SECTION_KEY_OPTION_LIST</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">showEndOfOptionsDelimiterInUsageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example command."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"A file."</span><span class="o">)</span> <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">());</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getHelpSectionKeys</span><span class="o">());</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="no">SECTION_KEY_END_OF_OPTIONS</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">copy</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="no">SECTION_KEY_OPTION_LIST</span><span class="o">),</span> <span class="no">SECTION_KEY_END_OF_OPTIONS</span><span class="o">);</span>
        <span class="n">cmd</span><span class="o">.</span><span class="na">setHelpSectionKeys</span><span class="o">(</span><span class="n">copy</span><span class="o">);</span>

        <span class="n">cmd</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.Model.UsageMessageSpec.SECTION_KEY_OPTION_LIST</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Model.UsageMessageSpec.SECTION_KEY_END_OF_OPTIONS</span>
<span class="c1">// ...</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">showEndOfOptionsDelimiterInUsageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example command."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"A file."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
            <span class="kd">val</span> <span class="py">copy</span><span class="p">:</span> <span class="nc">MutableList</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">ArrayList</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span><span class="p">)</span>
            <span class="n">copy</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="nc">SECTION_KEY_END_OF_OPTIONS</span><span class="p">)</span>
            <span class="n">copy</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="nc">SECTION_KEY_OPTION_LIST</span><span class="p">),</span> <span class="nc">SECTION_KEY_END_OF_OPTIONS</span><span class="p">)</span>
            <span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span> <span class="p">=</span> <span class="n">copy</span>

            <span class="n">cmd</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting usage help message shows the <code>--</code> End of Options entry has moved up, to the beginning the options list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [--] &lt;file&gt;
Example command.
      &lt;file&gt;      A file.
  --              This option can be used to separate command-line options from
                    the list of positional parameters.
  -h, --help      Show this help message and exit.
  -V, --version   Print version information and exit.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_end_of_options_entry_text"><a class="anchor" href="#_changing_the_end_of_options_entry_text"></a>14.19.3. Changing the End of Options Entry Text</h4>
<div class="paragraph">
<p>The description of the <code>--</code> End of Options delimiter entry has been defined with a <a href="#_custom_variables">custom variable</a>, to allow applications to change the text. The variable is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>picocli.endofoptions.description</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By setting the above variable in either system properties, environment variables or the <a href="#_internationalization">resource bundle</a> for a command, the text can be customized.</p>
</div>
<div class="paragraph">
<p>For example, if we define this system property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"picocli.endofoptions.description"</span><span class="o">,</span> <span class="s">"End of options. Remainder are positional parameters."</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>then the usage help for our above example changes to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: myapp [-hV] [--] &lt;file&gt;
Example command.
      &lt;file&gt;      A file.
  -h, --help      Show this help message and exit.
  -V, --version   Print version information and exit.
  --              End of options. Remainder are positional parameters.</pre>
</div>
</div>
<div class="paragraph">
<p>The description of the End of Options delimiter entry can also be specified in a <a href="#_internationalization">resource bundle</a> for internationalization and localization.
The <code>descriptionKey</code> for the End of Options delimiter entry in resource bundles is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>picocli.endofoptions</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_default_values"><a class="anchor" href="#_show_default_values"></a>14.20. Show Default Values</h3>
<div class="sect3">
<h4 id="_default_value_variable"><a class="anchor" href="#_default_value_variable"></a>14.20.1. <code>${DEFAULT-VALUE}</code> Variable</h4>
<div class="paragraph">
<p>From picocli 3.2, it is possible to embed the <a href="#_default_values">default values</a> in the description for an option or positional parameter by
specifying the <a href="#_variable_interpolation">variable</a> <code>${DEFAULT-VALUE}</code> in the description text.
Picocli uses reflection to get the default values from the annotated fields.</p>
</div>
<div class="paragraph">
<p>The <a href="#_variable_interpolation">variable</a> is replaced with the default value regardless of the <code>@Command(showDefaultValues)</code> attribute
and regardless of the <code>@Option(showDefaultValues)</code> or <code>@Parameters(showDefaultValues)</code> attribute.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">DefaultValues</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-f"</span><span class="o">,</span> <span class="s">"--file"</span><span class="o">},</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"config.xml"</span><span class="o">,</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"the file to use (default: ${DEFAULT-VALUE})"</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">file</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultValues</span><span class="o">(),</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">DefaultValues</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">,</span> <span class="s">"--file"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"config.xml"</span><span class="p">,</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the file to use (default: \${DEFAULT-VALUE})"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">File</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">DefaultValues</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This produces the following usage help:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [-f=&lt;file&gt;]
  -f, --file=&lt;file&gt;   the file to use (default: config.xml)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_completion_candidates_variable"><a class="anchor" href="#_completion_candidates_variable"></a>14.20.2. <code>${COMPLETION-CANDIDATES}</code> Variable</h4>
<div class="paragraph">
<p>Similarly, it is possible to embed the completion candidates in the description for an option or positional parameter by
specifying the <a href="#_variable_interpolation">variable</a> <code>${COMPLETION-CANDIDATES}</code> in the description text.</p>
</div>
<div class="paragraph">
<p>This works for java <code>enum</code> classes and for options or positional parameters of non-enum types for which completion candidates are specified.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">enum</span> <span class="nc">Lang</span> <span class="o">{</span> <span class="n">java</span><span class="o">,</span> <span class="n">groovy</span><span class="o">,</span> <span class="n">kotlin</span><span class="o">,</span> <span class="n">javascript</span><span class="o">,</span> <span class="n">frege</span><span class="o">,</span> <span class="n">clojure</span> <span class="o">}</span>

<span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyAbcCandidates</span> <span class="kd">extends</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">MyAbcCandidates</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">));</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">ValidValuesDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-l"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Enum values: ${COMPLETION-CANDIDATES}"</span><span class="o">)</span>
    <span class="nc">Lang</span> <span class="n">lang</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-o"</span><span class="o">,</span> <span class="n">completionCandidates</span> <span class="o">=</span> <span class="nc">MyAbcCandidates</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"Candidates: ${COMPLETION-CANDIDATES}"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">option</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="k">new</span> <span class="nc">ValidValuesDemo</span><span class="o">(),</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">enum</span> <span class="kd">class</span> <span class="nc">Lang</span> <span class="p">{</span> <span class="n">java</span><span class="p">,</span> <span class="n">groovy</span><span class="p">,</span> <span class="n">kotlin</span><span class="p">,</span> <span class="n">javascript</span><span class="p">,</span> <span class="n">frege</span><span class="p">,</span> <span class="n">clojure</span> <span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyAbcCandidates</span> <span class="p">:</span> <span class="nc">ArrayList</span><span class="p">&lt;</span><span class="nc">String</span><span class="err">?</span><span class="p">&gt;(</span><span class="nf">listOf</span><span class="p">(</span><span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">,</span> <span class="s">"C"</span><span class="p">))</span>

<span class="kd">class</span> <span class="nc">ValidValuesDemo</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-l"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Enum values: \${COMPLETION-CANDIDATES}"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">lang</span><span class="p">:</span> <span class="nc">Lang</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-o"</span><span class="p">],</span> <span class="n">completionCandidates</span> <span class="p">=</span> <span class="nc">MyAbcCandidates</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Candidates: \${COMPLETION-CANDIDATES}"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">option</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">ValidValuesDemo</span><span class="p">()).</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This produces the following usage help:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: &lt;main class&gt; [-l=&lt;lang&gt;] [-o=&lt;option&gt;]
  -l=&lt;lang&gt;     Enum values: java, groovy, kotlin, javascript, frege, clojure
  -o=&lt;option&gt;   Candidates: A, B, C</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_legacy_configuration_for_displaying_default_values"><a class="anchor" href="#_legacy_configuration_for_displaying_default_values"></a>14.20.3. Legacy Configuration for Displaying Default Values</h4>
<div class="paragraph">
<p>Prior to picocli 3.2, you need to use the <code>@Command(showDefaultValues = true)</code> attribute to append the default value of
 all non-<code>null</code> options and positional parameters to the description column.</p>
</div>
<div class="paragraph">
<p>Additionally, picocli 3.0 introduced a <code>showDefaultValue</code> attribute to the <code>@Option</code> and <code>@Parameters</code> annotation.
This allows you to specify for each individual option and positional parameter whether its default value should be shown in the usage help.
This attribute accepts three values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ALWAYS</code> - always display the default value of this option or positional parameter, even <code>null</code> values, regardless what value of <code>showDefaultValues</code> was specified on the command</p>
</li>
<li>
<p><code>NEVER</code> - don&#8217;t show the default value for this option or positional parameter, regardless what value of <code>showDefaultValues</code> was specified on the command</p>
</li>
<li>
<p><code>ON_DEMAND</code> - (this is the default) only show the default value for this option or positional parameter if <code>showDefaultValues</code> was specified on the command</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These legacy mechanisms still work but for maximum flexibility use the variables explained above.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ansi_colors_and_styles"><a class="anchor" href="#_ansi_colors_and_styles"></a>15. ANSI Colors and Styles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using colors in your command&#8217;s output does not just look good: by <strong>contrasting</strong> important elements like option names from the rest of the message, it <strong>reduces the cognitive load</strong> on the user.</p>
</div>
<div class="sect2">
<h3 id="_colorized_example"><a class="anchor" href="#_colorized_example"></a>15.1. Colorized Example</h3>
<div class="paragraph">
<p>Below shows the same usage help message as shown in <a href="#_expanded_example">Expanded Example</a>, with ANSI escape codes enabled.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/UsageHelpWithStyle.png" alt="Screenshot of usage help with Ansi codes enabled"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_usage_help_with_styles_and_colors"><a class="anchor" href="#_usage_help_with_styles_and_colors"></a>15.2. Usage Help with Styles and Colors</h3>
<div class="paragraph">
<p>You can use colors and styles in the descriptions, header and footer
of the usage help message.</p>
</div>
<div class="paragraph">
<p>Picocli supports a custom markup notation for mixing colors and styles in text,
following a convention introduced by <a href="https://github.com/fusesource/jansi">Jansi</a>, where
<code>@|</code> starts a styled section, and <code>|@</code> ends it.
Immediately following the <code>@|</code> is a comma-separated list of colors and styles, so <code>@|STYLE1[,STYLE2]&#8230;&#8203; text|@</code>.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Custom @|bold,underline styles|@ and @|fg(red) colors|@."</span><span class="o">)</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Custom @|bold,underline styles|@ and @|fg(red) colors|@."</span><span class="p">])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/DescriptionWithColors.png" alt="Description with Ansi styles and colors"></span></p>
</div>
<table class="tableblock frame-all grid-cols stretch">
<caption class="title">Table 5. Pre-defined styles and colors that can be used in descriptions and headers using the <code>@|STYLE1[,STYLE2]&#8230;&#8203; text|@</code> notation</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pre-defined Styles</th>
<th class="tableblock halign-left valign-top">Pre-defined Colors</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">black</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">faint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">red</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">underline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">green</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">italic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yellow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">blink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">blue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reverse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magenta</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cyan</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">white</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Colors are applied as <em>foreground</em> colors by default.
You can set <em>background</em> colors by specifying <code>bg(&lt;color&gt;)</code>.
For example, <code>@|bg(red) text with red background|@</code>.
Similarly, <code>fg(&lt;color&gt;)</code> explicitly sets the foreground color.</p>
</div>
<div class="paragraph">
<p>The example below shows how this markup can be used to add colors and styles to the headings and descriptions of a usage help message:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"commit"</span><span class="o">,</span>
        <span class="n">sortOptions</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
        <span class="n">headerHeading</span> <span class="o">=</span> <span class="s">"@|bold,underline Usage|@:%n%n"</span><span class="o">,</span>
        <span class="n">synopsisHeading</span> <span class="o">=</span> <span class="s">"%n"</span><span class="o">,</span>
        <span class="n">descriptionHeading</span> <span class="o">=</span> <span class="s">"%n@|bold,underline Description|@:%n%n"</span><span class="o">,</span>
        <span class="n">parameterListHeading</span> <span class="o">=</span> <span class="s">"%n@|bold,underline Parameters|@:%n"</span><span class="o">,</span>
        <span class="n">optionListHeading</span> <span class="o">=</span> <span class="s">"%n@|bold,underline Options|@:%n"</span><span class="o">,</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s">"Record changes to the repository."</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"Stores the current contents of the index in a new commit "</span> <span class="o">+</span>
                <span class="s">"along with a log message from the user describing the changes."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">GitCommit</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"commit"</span><span class="p">,</span>
        <span class="n">sortOptions</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
        <span class="n">headerHeading</span> <span class="p">=</span> <span class="s">"@|bold,underline Usage|@:%n%n"</span><span class="p">,</span>
        <span class="n">synopsisHeading</span> <span class="p">=</span> <span class="s">"%n"</span><span class="p">,</span>
        <span class="n">descriptionHeading</span> <span class="p">=</span> <span class="s">"%n@|bold,underline Description|@:%n%n"</span><span class="p">,</span>
        <span class="n">parameterListHeading</span> <span class="p">=</span> <span class="s">"%n@|bold,underline Parameters|@:%n"</span><span class="p">,</span>
        <span class="n">optionListHeading</span> <span class="p">=</span> <span class="s">"%n@|bold,underline Options|@:%n"</span><span class="p">,</span>
        <span class="n">header</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Record changes to the repository."</span><span class="p">],</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Stores the current contents of the index in a new commit "</span> <span class="p">+</span>
                <span class="s">"along with a log message from the user describing the changes."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">GitCommit</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Markup styles cannot be nested, for example: <code>@|bold this @|underline that|@|@</code> will not work. You can achieve the same by combining styles, for example: <code>@|bold this|@ @|bold,underline that|@</code> will work fine.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As of picocli 4.2, custom markup like <code>@|bold mytext|@</code>, <code>@|italic mytext|@</code> etc. can also be converted to custom markup like <code>&lt;b&gt;mytext&lt;/b&gt;</code> and <code>&lt;i&gt;mytext&lt;/i&gt;</code> in HTML, or <code>*mytext*</code> and <code>_mytext_</code> in lightweight markup languages like AsciiDoc.
Applications can control this by setting a <code>ColorScheme</code> with a custom markup map.
This feature is used to generate man page documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_styles_and_colors_in_application_output"><a class="anchor" href="#_styles_and_colors_in_application_output"></a>15.3. Styles and Colors in Application Output</h3>
<div class="paragraph">
<p>The use of ANSI colors and styles is not limited to the <a href="#_usage_help_with_styles_and_colors">usage help</a>
and <a href="#_static_version_information">version information</a>.</p>
</div>
<div class="paragraph">
<p>Applications can use the picocli <code>Ansi</code> class directly to create colored output.
By using the <code>Ansi.AUTO</code> enum value, picocli will  <a href="#_heuristics_for_enabling_ansi">auto-detect</a> whether it can emit ANSI escape codes or only the plain text.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine.Help.Ansi</span><span class="o">;</span>
<span class="c1">// ...</span>
<span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">Ansi</span><span class="o">.</span><span class="na">AUTO</span><span class="o">.</span><span class="na">string</span><span class="o">(</span><span class="s">"@|bold,green,underline Hello, colored world!|@"</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.Help.Ansi;</span>
<span class="c1">// ...</span>
<span class="kd">val</span> <span class="py">str</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="nc">Ansi</span><span class="p">.</span><span class="nc">AUTO</span><span class="p">.</span><span class="nf">string</span><span class="p">(</span><span class="s">"@|bold,green,underline Hello, colored world!|@"</span><span class="p">)</span>
<span class="nf">println</span><span class="p">(</span><span class="n">str</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_more_colors"><a class="anchor" href="#_more_colors"></a>15.4. More Colors</h3>
<div class="paragraph">
<p>Most terminals support a <a href="https://en.wikipedia.org/wiki/ANSI_escape_code#Colors">256 color indexed palette</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0x00-0x07:  standard colors (the named colors)
0x08-0x0F:  high intensity colors (often similar to named colors + bold style)
0x10-0xE7:  6 Ã 6 Ã 6 cube (216 colors): 16 + 36 Ã r + 6 Ã g + b (0 â¤ r, g, b â¤ 5)
0xE8-0xFF:  grayscale from black to white in 24 steps</pre>
</div>
</div>
<div class="paragraph">
<p>Colors from the 256 color palette can be specified by their index values or by their RGB components.
RGB components must be separated by a semicolon <code>;</code> and each component must be between <code>0</code> and <code>5</code>, inclusive.</p>
</div>
<div class="paragraph">
<p>For example, <code>@|bg(0;5;0) text with red=0, green=5, blue=0 background|@</code>,
or <code>@|fg(46) the same color by index, as foreground color|@</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/256colors.png" alt="256 color indexed palette"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_fixed_elements"><a class="anchor" href="#_configuring_fixed_elements"></a>15.5. Configuring Fixed Elements</h3>
<div class="sect3">
<h4 id="_color_scheme"><a class="anchor" href="#_color_scheme"></a>15.5.1. Color Scheme</h4>
<div class="paragraph">
<p>Picocli uses a default color scheme for options, parameters and commands.
There are no annotations to modify this color scheme, but it can be changed programmatically.</p>
</div>
<div class="paragraph">
<p>The below code snippet shows how a custom color scheme can be specified to configure the usage help message style:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// see also CommandLine.Help.defaultColorScheme()</span>
<span class="nc">ColorScheme</span> <span class="n">colorScheme</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ColorScheme</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">commands</span>    <span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">bold</span><span class="o">,</span> <span class="nc">Style</span><span class="o">.</span><span class="na">underline</span><span class="o">)</span>    <span class="c1">// combine multiple styles</span>
        <span class="o">.</span><span class="na">options</span>     <span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">fg_yellow</span><span class="o">)</span>                <span class="c1">// yellow foreground color</span>
        <span class="o">.</span><span class="na">parameters</span>  <span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">fg_yellow</span><span class="o">)</span>
        <span class="o">.</span><span class="na">optionParams</span><span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">italic</span><span class="o">)</span>
        <span class="o">.</span><span class="na">errors</span>      <span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">fg_red</span><span class="o">,</span> <span class="nc">Style</span><span class="o">.</span><span class="na">bold</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stackTraces</span> <span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">italic</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="n">annotatedObject</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">,</span> <span class="n">colorScheme</span><span class="o">);</span>
<span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="c1">// see also CommandLine.Help.defaultColorScheme()</span>
<span class="kd">val</span> <span class="py">colorScheme</span><span class="p">:</span> <span class="nc">Help</span><span class="p">.</span><span class="nc">ColorScheme</span> <span class="p">=</span> <span class="nc">ColorScheme</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">commands</span>    <span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span> <span class="nc">Style</span><span class="p">.</span><span class="n">underline</span><span class="p">)</span>    <span class="c1">// combine multiple styles</span>
        <span class="p">.</span><span class="nf">options</span>     <span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">fg_yellow</span><span class="p">)</span>                <span class="c1">// yellow foreground color</span>
        <span class="p">.</span><span class="nf">parameters</span>  <span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">fg_yellow</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">optionParams</span><span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">italic</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">errors</span>      <span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">fg_red</span><span class="p">,</span> <span class="nc">Style</span><span class="p">.</span><span class="n">bold</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">stackTraces</span> <span class="p">(</span><span class="nc">Style</span><span class="p">.</span><span class="n">italic</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">build</span><span class="p">()</span>

<span class="nc">CommandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="n">annotatedObject</span><span class="p">,</span> <span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">,</span> <span class="n">colorScheme</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the <a href="#execute"><code>execute</code></a> API, you can configure a <code>ColorScheme</code> like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">ColorScheme</span> <span class="n">colorScheme</span> <span class="o">=</span> <span class="n">createColorScheme</span><span class="o">();</span>

    <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
            <span class="o">.</span><span class="na">setColorScheme</span><span class="o">(</span><span class="n">colorScheme</span><span class="o">)</span> <span class="c1">// use this color scheme in the usage help message</span>
            <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">colorScheme</span><span class="p">:</span> <span class="nc">ColorScheme</span> <span class="p">=</span> <span class="nf">createColorScheme</span><span class="p">()</span>

    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
            <span class="p">.</span><span class="nf">setColorScheme</span><span class="p">(</span><span class="n">colorScheme</span><span class="p">)</span> <span class="c1">// use this color scheme in the usage help message</span>
            <span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_color_scheme_overrides"><a class="anchor" href="#_color_scheme_overrides"></a>15.5.2. Color Scheme Overrides</h4>
<div class="paragraph">
<p>The following system properties override the color scheme styles. This allows end users to adjust for their individual terminal color setup.</p>
</div>
<div class="listingblock">
<div class="title">System Properties to Override the Color Scheme</div>
<div class="content">
<pre>picocli.color.commands
picocli.color.options
picocli.color.parameters
picocli.color.optionParams
picocli.color.errors
picocli.color.stackTraces</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>java -Dpicocli.color.options=blink,blue -Dpicocli.color.parameters=reverse com.app.Main</code></pre>
</div>
</div>
<div class="paragraph">
<p>System property values may specify multiple comma separated styles.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_supported_platforms"><a class="anchor" href="#_supported_platforms"></a>15.6. Supported Platforms</h3>
<div class="paragraph">
<p>Picocli will only emit ANSI escape codes on supported platforms.
For details, see <a href="#_heuristics_for_enabling_ansi">Heuristics for Enabling ANSI</a>.</p>
</div>
<div class="sect3">
<h4 id="_unix_and_linux"><a class="anchor" href="#_unix_and_linux"></a>15.6.1. Unix and Linux</h4>
<div class="paragraph">
<p>Most Unix and Linux platforms support ANSI colors natively.
On Windows, when picocli detects it is running under a Unix variant like Cygwin or MSYS(2) on Windows
 it will display ANSI colors and styles, otherwise it will not emit ANSI codes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_windows"><a class="anchor" href="#_windows"></a>15.6.2. Windows</h4>
<div class="paragraph">
<p>Displaying colors on Windows Command Console and PowerShell requires a bit of extra work.</p>
</div>
<div class="paragraph">
<p>The easiest way to accomplish this is to use the <a href="http://fusesource.github.io/jansi/">Jansi</a> library in your application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
None of the below is mandatory. If not supported, picocli will simply not emit ANSI escape codes, and everything will work without colors.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_jansi"><a class="anchor" href="#_jansi"></a>Jansi</h5>
<div class="paragraph">
<p>To use Jansi, you need to enable it in your application. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.fusesource.jansi.AnsiConsole</span><span class="o">;</span>
<span class="c1">// ...</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">AnsiConsole</span><span class="o">.</span><span class="na">systemInstall</span><span class="o">();</span> <span class="c1">// enable colors on Windows</span>
    <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">WindowsJansiDemo</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="nc">AnsiConsole</span><span class="o">.</span><span class="na">systemUninstall</span><span class="o">();</span> <span class="c1">// cleanup when done</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">org.fusesource.jansi.AnsiConsole;</span>
<span class="c1">// ...</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">AnsiConsole</span><span class="p">.</span><span class="nf">systemInstall</span><span class="p">()</span> <span class="c1">// enable colors on Windows</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">WindowsJansiDemo</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
    <span class="nc">AnsiConsole</span><span class="p">.</span><span class="nf">systemUninstall</span><span class="p">()</span> <span class="c1">// cleanup when done</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_jansi_in_graalvm_native_images"><a class="anchor" href="#_jansi_in_graalvm_native_images"></a>Jansi in GraalVM Native Images</h5>
<div class="paragraph">
<p>In Java applications compiled to a GraalVM native image for Windows, Jansi by itself is <a href="https://github.com/fusesource/jansi/issues/162">insufficient</a> to show colors.
This is partly because GraalVM requires configuration and partly because Jansi internally depends on non-standard system properties, without a graceful fallback if these properties are absent (as is the case in GraalVM).</p>
</div>
<div class="paragraph">
<p>Users may be interested in combining Jansi with <a href="https://github.com/remkop/picocli-jansi-graalvm">picocli-jansi-graalvm</a> until this issue is fixed. Example usage:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.jansi.graalvm.AnsiConsole</span><span class="o">;</span> <span class="c1">// not org.fusesource.jansi.AnsiConsole</span>
<span class="c1">// ...</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">exitCode</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">AnsiConsole</span> <span class="n">ansi</span> <span class="o">=</span> <span class="nc">AnsiConsole</span><span class="o">.</span><span class="na">windowsInstall</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.jansi.graalvm.AnsiConsole</span> <span class="c1">// not org.fusesource.jansi.AnsiConsole</span>
<span class="c1">// ...</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">exitCode</span><span class="p">:</span> <span class="nc">Int</span>
    <span class="nc">AnsiConsole</span><span class="p">.</span><span class="nf">windowsInstall</span><span class="p">().</span><span class="nf">use</span>
        <span class="p">{</span> <span class="n">exitCode</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span> <span class="p">}</span>
    <span class="nc">System</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="n">exitCode</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_for_reference_without_jansi_on_windows_10_command_console_and_powershell"><a class="anchor" href="#_for_reference_without_jansi_on_windows_10_command_console_and_powershell"></a>For Reference: Without Jansi on Windows 10 Command Console and PowerShell</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of this writing, the practical way to get colors in Command Console and PowerShell is to use Jansi. The below is just for reference.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Starting from Windows 10, the Windows Console <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/mt638032(v=vs.85).aspx">supports ANSI escape sequences</a>,
but <a href="https://github.com/Microsoft/WSL/issues/1173#issuecomment-254250445">it&#8217;s not enabled by default</a>.
Unless the specific software you&#8217;re using (e.g. java) enables ANSI processing by calling the <a href="https://docs.microsoft.com/en-us/windows/console/setconsolemode">SetConsoleMode</a> API with the <code>ENABLE_VIRTUAL_TERMINAL_PROCESSING</code> (<code>0x0400</code>) flag (java doesn&#8217;t), you won&#8217;t see colors or get ANSI processing for that application.</p>
</div>
<div class="paragraph">
<p>Note that there is a registry setting to <a href="https://superuser.com/questions/413073/windows-console-with-ansi-colors-handling/1300251#1300251">change the global default</a> from <em>opt in</em> to <em>opt out</em>.
This <a href="https://stackoverflow.com/a/51681675/1446916">Stack Overflow answer</a> has more details.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Note that picocli&#8217;s <a href="#_heuristics_for_enabling_ansi">heuristics for enabling ANSI</a> currently do not include detecting whether support for Virtual Terminal / ANSI escape sequences has been turned on or off via <code>SetConsoleMode</code> or a registry change.
So just making these changes is not sufficient to let a picocli-based application show colors.
Applications that enabled colors via <code>SetConsoleMode</code> may want to set system property <code>picocli.ansi</code> to <code>tty</code>.
Environments that enabled colors via a Windows Registry change may want to set environment variable <code>CLICOLOR=1</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_for_reference_windows_subsystem_for_linux_wsl"><a class="anchor" href="#_for_reference_windows_subsystem_for_linux_wsl"></a>For Reference: Windows Subsystem for Linux (WSL)</h5>
<div class="paragraph">
<p>You may want to recommend your users to try <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">getting</a> <a href="https://docs.microsoft.com/en-us/windows/wsl/about">Windows Subsystem for Linux</a> (WSL).
This lets them run a GNU/Linux environment&#8201;&#8212;&#8201;including most command-line tools, utilities, and applications&#8201;&#8212;&#8201;directly on Windows, unmodified, without the overhead of a virtual machine.
Picocli-based applications will show ANSI colors in WSL by default.</p>
</div>
</div>
<div class="sect4">
<h5 id="_for_reference_3rd_party_software"><a class="anchor" href="#_for_reference_3rd_party_software"></a>For Reference: 3rd Party Software</h5>
<div class="paragraph">
<p>In Windows version prior to 10, the Windows command console doesn&#8217;t support output coloring by default.
One option is for end users to install either <a href="http://cmder.net/">Cmder</a>, <a href="http://sourceforge.net/projects/conemu/">ConEmu</a>, <a href="https://github.com/adoxa/ansicon/">ANSICON</a> or <a href="https://mintty.github.io/">Mintty</a> (used by default in GitBash and Cygwin) to add coloring support to their Windows command console.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_forcing_ansi_onoff"><a class="anchor" href="#_forcing_ansi_onoff"></a>15.7. Forcing ANSI On/Off</h3>
<div class="paragraph">
<p>You can force picocli to either always use ANSI codes or never use ANSI codes regardless of the platform:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting system property <code>picocli.ansi</code> to <code>true</code> forces picocli to use ANSI codes; setting <code>picocli.ansi</code> to <code>false</code> forces picocli to <strong>not</strong> use ANSI codes. It may be useful for your users to mention this system property in the documentation for your command line application.</p>
</li>
<li>
<p>Setting system property <code>picocli.ansi</code> to <code>tty</code> (case-insensitive) forces picocli to use ANSI codes only if picocli guesses that the process is using an interactive console: either <code>System.console() != null</code> or picocli guesses the application is running in a pseudo-terminal pty on a Linux emulator in Windows. Otherwise the <a href="#_heuristics_for_enabling_ansi">below heuristics</a> are used to determine whether to output ANSI escape codes.</p>
</li>
<li>
<p>You can decide to force disable or force enable ANSI escape codes programmatically by specifying <code>Ansi.ON</code> or <code>Ansi.OFF</code> when invoking <code>CommandLine.usage</code>.
This overrides the value of system property <code>picocli.ansi</code>. For example:</p>
</li>
</ul>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.CommandLine.Help.Ansi</span><span class="o">;</span>

<span class="c1">// print usage help message to STDOUT without ANSI escape codes</span>
<span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="k">new</span> <span class="nc">App</span><span class="o">(),</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">,</span> <span class="nc">Ansi</span><span class="o">.</span><span class="na">OFF</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.Help.Ansi</span>

<span class="c1">// print usage help message to STDOUT without ANSI escape codes</span>
<span class="nc">CommandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">App</span><span class="p">(),</span> <span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">,</span> <span class="nc">Ansi</span><span class="p">.</span><span class="nc">OFF</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_heuristics_for_enabling_ansi"><a class="anchor" href="#_heuristics_for_enabling_ansi"></a>15.8. Heuristics for Enabling ANSI</h3>
<div class="paragraph">
<p>Below is the exact sequence of steps picocli uses to determine whether or not to emit ANSI escape codes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>Ansi.ON</code> or <code>Ansi.OFF</code> is <a href="#_forcing_ansi_onoff">explicitly specified</a>, either via system property <code>picocli.ansi</code> or programmatically, this value is used.</p>
</li>
<li>
<p>ANSI is disabled when environment variable <a href="https://no-color.org/"><code>NO_COLOR</code></a> is defined (regardless of its value).</p>
</li>
<li>
<p>ANSI is enabled when environment variable <a href="https://bixense.com/clicolors/"><code>CLICOLOR_FORCE</code></a> is defined and has any value other than <code>0</code> (zero).</p>
</li>
<li>
<p>ANSI is enabled when system property <code>os.name</code> starts with <code>"Windows"</code> and JAnsi Console is <a href="https://github.com/fusesource/jansi">installed</a>.</p>
</li>
<li>
<p>ANSI is disabled when environment variable <a href="https://bixense.com/clicolors/"><code>CLICOLOR == 0</code></a>.</p>
</li>
<li>
<p>ANSI is disabled when environment variable <a href="https://conemu.github.io/en/AnsiEscapeCodes.html#Environment_variable"><code>ConEmuANSI == OFF</code></a>.</p>
</li>
<li>
<p>ANSI is disabled when Picocli <a href="https://stackoverflow.com/questions/1403772/how-can-i-check-if-a-java-programs-input-output-streams-are-connected-to-a-term"><em>guesses</em></a> the program&#8217;s output stream is not connected to a terminal: when <code>System.console()</code> returns <code>null</code>. This check is omitted if picocli <em>guesses</em> the program is running in a Windows <a href="https://www.cygwin.com/">Cygwin</a>, <a href="http://www.mingw.org/wiki/MSYS">MSYS</a> or <a href="https://www.msys2.org/">MSYS2</a> environment: when system property <code>os.name</code> starts with <code>"Windows"</code> and either environment variable <code>TERM</code> contains <code>cygwin</code> or starts with <code>xterm</code> or environment variable <code>OSTYPE</code> is defined.</p>
</li>
<li>
<p>ANSI is enabled when environment variable <a href="https://github.com/adoxa/ansicon/blob/master/readme.txt"><code>ANSICON</code></a> is defined.</p>
</li>
<li>
<p>ANSI is enabled when environment variable <a href="https://bixense.com/clicolors/"><code>CLICOLOR == 1</code></a>.</p>
</li>
<li>
<p>ANSI is enabled when environment variable <a href="https://conemu.github.io/en/AnsiEscapeCodes.html#Environment_variable"><code>ConEmuANSI == ON</code></a>.</p>
</li>
<li>
<p>ANSI is enabled when picocli detects the program is running in a non-Windows OS (system property <code>os.name</code> does not start with <code>"Windows"</code>).</p>
</li>
<li>
<p>ANSI is enabled when picocli <em>guesses</em> the program is running in a <a href="https://www.cygwin.com/">Cygwin</a>, <a href="http://www.mingw.org/wiki/MSYS">MSYS</a> or <a href="https://www.msys2.org/">MSYS2</a> environment (either environment variable <code>TERM</code> contains <code>cygwin</code> or starts with <code>xterm</code> or environment variable <code>OSTYPE</code> is defined).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ANSI escape codes are not emitted if none of the above apply.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage_help_api"><a class="anchor" href="#_usage_help_api"></a>16. Usage Help API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For further customization of the usage help message, picocli has a Help API.
The <code>Help</code> class provides a number of high-level operations, and a set of components like <code>Layout</code>, <code>TextTable</code>, <code>IOptionRenderer</code>, etc., that can be used to build custom help messages.
Details of the Help API are out of scope for this document, but the following sections give some idea of what is possible.</p>
</div>
<div class="sect2">
<h3 id="_reordering_sections"><a class="anchor" href="#_reordering_sections"></a>16.1. Reordering Sections</h3>
<div class="paragraph">
<p>One thing you may want to do is reorder sections of the usage message or add custom sections.</p>
</div>
<div class="paragraph">
<p>Picocli 3.9 introduces new API to facilitate customizing the usage help message:
<code>IHelpFactory</code> allows applications to plug in <code>Help</code> subclasses, and
<code>IHelpSectionRenderer</code> allows applications to add custom sections to the usage help message, or redefine existing sections.</p>
</div>
<div class="paragraph">
<p>The usage help message is no longer hard-coded, but is now constructed from the section renderers defined in <code>CommandLine::getHelpSectionMap</code> (or <code>UsageMessageSpec::sectionMap</code> for a single <code>CommandSpec</code>).
By default this map contains the predefined section renderers:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.*;</span>
<span class="c1">// ...</span>

<span class="c1">// The default section renderers delegate to methods in Help for their implementation</span>
<span class="c1">// (using Java 8 lambda notation for brevity):</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">IHelpSectionRenderer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_HEADER_HEADING</span><span class="o">,</span>         <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">headerHeading</span><span class="o">());</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_HEADER</span><span class="o">,</span>                 <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">header</span><span class="o">());</span>

<span class="c1">//e.g. Usage:</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_SYNOPSIS_HEADING</span><span class="o">,</span>       <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">synopsisHeading</span><span class="o">());</span>

<span class="c1">//e.g. &lt;cmd&gt; [OPTIONS] &lt;subcmd&gt; [COMMAND-OPTIONS] [ARGUMENTS]</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_SYNOPSIS</span><span class="o">,</span>               <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">synopsis</span><span class="o">(</span><span class="n">help</span><span class="o">.</span><span class="na">synopsisHeadingLength</span><span class="o">()));</span>

<span class="c1">//e.g. %nDescription:%n%n</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_DESCRIPTION_HEADING</span><span class="o">,</span>    <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">descriptionHeading</span><span class="o">());</span>

<span class="c1">//e.g. {"Converts foos to bars.", "Use options to control conversion mode."}</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_DESCRIPTION</span><span class="o">,</span>            <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">description</span><span class="o">());</span>

<span class="c1">//e.g. %nPositional parameters:%n%n</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_PARAMETER_LIST_HEADING</span><span class="o">,</span> <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">parameterListHeading</span><span class="o">());</span>

<span class="c1">//e.g. [FILE...] the files to convert</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_PARAMETER_LIST</span><span class="o">,</span>         <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">parameterList</span><span class="o">());</span>

<span class="c1">//e.g. %nOptions:%n%n</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_OPTION_LIST_HEADING</span><span class="o">,</span>    <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">optionListHeading</span><span class="o">());</span>

<span class="c1">//e.g. -h, --help   displays this help and exits</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_OPTION_LIST</span><span class="o">,</span>            <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">optionList</span><span class="o">());</span>

<span class="c1">//e.g. %nCommands:%n%n</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_COMMAND_LIST_HEADING</span><span class="o">,</span>   <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">commandListHeading</span><span class="o">());</span>

<span class="c1">//e.g.    add       this command adds the frup to the frooble</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_COMMAND_LIST</span><span class="o">,</span>           <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">commandList</span><span class="o">());</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_EXIT_CODE_LIST_HEADING</span><span class="o">,</span> <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">exitCodeListHeading</span><span class="o">());</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_EXIT_CODE_LIST</span><span class="o">,</span>         <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">exitCodeList</span><span class="o">());</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_FOOTER_HEADING</span><span class="o">,</span>         <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">footerHeading</span><span class="o">());</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_FOOTER</span><span class="o">,</span>                 <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">footer</span><span class="o">());</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine.Model.UsageMessageSpec.*</span>
<span class="c1">// ...</span>

<span class="c1">// The default section renderers delegate to methods in Help for their implementation</span>
<span class="c1">// (using lambda expressions for brevity):</span>
<span class="kd">val</span> <span class="py">map</span><span class="p">:</span> <span class="nc">MutableMap</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">IHelpSectionRenderer</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">HashMap</span><span class="p">()</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_HEADER_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">headerHeading</span><span class="p">()</span> <span class="p">}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_HEADER</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">header</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. Usage:</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_SYNOPSIS_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">synopsisHeading</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. &lt;cmd&gt; [OPTIONS] &lt;subcmd&gt; [COMMAND-OPTIONS] [ARGUMENTS]</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_SYNOPSIS</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">synopsis</span><span class="p">(</span><span class="n">help</span><span class="p">.</span><span class="nf">synopsisHeadingLength</span><span class="p">())</span> <span class="p">}</span>

<span class="c1">//e.g. %nDescription:%n%n</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_DESCRIPTION_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">descriptionHeading</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. {"Converts foos to bars.", "Use options to control conversion mode."}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_DESCRIPTION</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span>  <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">description</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. %nPositional parameters:%n%n</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_PARAMETER_LIST_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">parameterListHeading</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. [FILE...] the files to convert</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_PARAMETER_LIST</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">parameterList</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. %nOptions:%n%n</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_OPTION_LIST_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">optionListHeading</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. -h, --help   displays this help and exits</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_OPTION_LIST</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">optionList</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g. %nCommands:%n%n</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_COMMAND_LIST_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">commandListHeading</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">//e.g.    add       this command adds the frup to the frooble</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_COMMAND_LIST</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">commandList</span><span class="p">()</span> <span class="p">}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_EXIT_CODE_LIST_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">exitCodeListHeading</span><span class="p">()</span> <span class="p">}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_EXIT_CODE_LIST</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">exitCodeList</span><span class="p">()</span> <span class="p">}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_FOOTER_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">footerHeading</span><span class="p">()</span> <span class="p">}</span>
<span class="n">map</span><span class="p">[</span><span class="nc">SECTION_KEY_FOOTER</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">footer</span><span class="p">()</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Applications can add, remove or replace sections in this map. The <code>CommandLine::getHelpSectionKeys</code> method (or <code>UsageMessageSpec::sectionKeys</code> for a single <code>CommandSpec</code>) returns the section keys in the order that the usage help message should render the sections. The default keys are (in order):</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="0">
<li>
<p>SECTION_KEY_HEADER_HEADING</p>
</li>
<li>
<p>SECTION_KEY_HEADER</p>
</li>
<li>
<p>SECTION_KEY_SYNOPSIS_HEADING</p>
</li>
<li>
<p>SECTION_KEY_SYNOPSIS</p>
</li>
<li>
<p>SECTION_KEY_DESCRIPTION_HEADING</p>
</li>
<li>
<p>SECTION_KEY_DESCRIPTION</p>
</li>
<li>
<p>SECTION_KEY_PARAMETER_LIST_HEADING</p>
</li>
<li>
<p>SECTION_KEY_AT_FILE_PARAMETER</p>
</li>
<li>
<p>SECTION_KEY_PARAMETER_LIST</p>
</li>
<li>
<p>SECTION_KEY_OPTION_LIST_HEADING</p>
</li>
<li>
<p>SECTION_KEY_OPTION_LIST</p>
</li>
<li>
<p>SECTION_KEY_COMMAND_LIST_HEADING</p>
</li>
<li>
<p>SECTION_KEY_COMMAND_LIST</p>
</li>
<li>
<p>SECTION_KEY_EXIT_CODE_LIST_HEADING</p>
</li>
<li>
<p>SECTION_KEY_EXIT_CODE_LIST</p>
</li>
<li>
<p>SECTION_KEY_FOOTER_HEADING</p>
</li>
<li>
<p>SECTION_KEY_FOOTER</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This ordering may be modified with the <code>CommandLine::setHelpSectionKeys</code> setter method (or <code>UsageMessageSpec::sectionKeys(List)</code> for a single <code>CommandSpec</code>).</p>
</div>
<div class="sect3">
<h4 id="_custom_help_section_example"><a class="anchor" href="#_custom_help_section_example"></a>16.1.1. Custom Help Section Example</h4>
<div class="paragraph">
<p>The below example shows how to add a custom Environment Variables section to the usage help message.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// help section keys</span>
<span class="kd">final</span> <span class="nc">String</span> <span class="no">SECTION_KEY_ENV_HEADING</span> <span class="o">=</span> <span class="s">"environmentVariablesHeading"</span><span class="o">;</span>
<span class="kd">final</span> <span class="nc">String</span> <span class="no">SECTION_KEY_ENV_DETAILS</span> <span class="o">=</span> <span class="s">"environmentVariables"</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="c1">// the data to display</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">env</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">env</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"FOO"</span><span class="o">,</span> <span class="s">"explanation of foo"</span><span class="o">);</span>
<span class="n">env</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"BAR"</span><span class="o">,</span> <span class="s">"explanation of bar"</span><span class="o">);</span>
<span class="n">env</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"XYZ"</span><span class="o">,</span> <span class="s">"xxxx yyyy zzz"</span><span class="o">);</span>

<span class="c1">// register the custom section renderers</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">());</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">getHelpSectionMap</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_ENV_HEADING</span><span class="o">,</span>
                            <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">createHeading</span><span class="o">(</span><span class="s">"Environment Variables:%n"</span><span class="o">));</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">getHelpSectionMap</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="no">SECTION_KEY_ENV_DETAILS</span><span class="o">,</span>
                            <span class="n">help</span> <span class="o">-&gt;</span> <span class="n">help</span><span class="o">.</span><span class="na">createTextTable</span><span class="o">(</span><span class="n">env</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>

<span class="c1">// specify the location of the new sections</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getHelpSectionKeys</span><span class="o">());</span>
<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="nc">CommandLine</span><span class="o">.</span><span class="na">Model</span><span class="o">.</span><span class="na">UsageMessageSpec</span><span class="o">.</span><span class="na">SECTION_KEY_FOOTER_HEADING</span><span class="o">);</span>
<span class="n">keys</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="no">SECTION_KEY_ENV_HEADING</span><span class="o">);</span>
<span class="n">keys</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="no">SECTION_KEY_ENV_DETAILS</span><span class="o">);</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">setHelpSectionKeys</span><span class="o">(</span><span class="n">keys</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="c1">// help section keys</span>
<span class="kd">val</span> <span class="py">SECTION_KEY_ENV_HEADING</span> <span class="p">=</span> <span class="s">"environmentVariablesHeading"</span>
<span class="kd">val</span> <span class="py">SECTION_KEY_ENV_DETAILS</span> <span class="p">=</span> <span class="s">"environmentVariables"</span>
<span class="c1">// ...</span>

<span class="c1">// the data to display</span>
<span class="kd">val</span> <span class="py">env</span><span class="p">:</span> <span class="nc">MutableMap</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">LinkedHashMap</span><span class="p">()</span>
<span class="n">env</span><span class="p">[</span><span class="s">"FOO"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"explanation of foo"</span>
<span class="n">env</span><span class="p">[</span><span class="s">"BAR"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"explanation of bar"</span>
<span class="n">env</span><span class="p">[</span><span class="s">"XYZ"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"xxxx yyyy zzz"</span>

<span class="c1">// register the custom section renderers</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">())</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionMap</span><span class="p">[</span><span class="nc">SECTION_KEY_ENV_HEADING</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">createHeading</span><span class="p">(</span><span class="s">"Environment Variables:%n"</span><span class="p">)</span> <span class="p">}</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionMap</span><span class="p">[</span><span class="nc">SECTION_KEY_ENV_DETAILS</span><span class="p">]</span> <span class="p">=</span>
    <span class="nc">IHelpSectionRenderer</span> <span class="p">{</span> <span class="n">help</span><span class="p">:</span> <span class="nc">Help</span> <span class="p">-&gt;</span> <span class="n">help</span><span class="p">.</span><span class="nf">createTextTable</span><span class="p">(</span><span class="n">env</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">// specify the location of the new sections</span>
<span class="kd">val</span> <span class="py">keys</span> <span class="p">=</span> <span class="nc">ArrayList</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">index</span> <span class="p">=</span> <span class="n">keys</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="nc">SECTION_KEY_FOOTER_HEADING</span><span class="p">)</span>
<span class="n">keys</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nc">SECTION_KEY_ENV_HEADING</span><span class="p">)</span>
<span class="n">keys</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">index</span> <span class="p">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nc">SECTION_KEY_ENV_DETAILS</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">helpSectionKeys</span> <span class="p">=</span> <span class="n">keys</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>More examples for customizing the usage help message are <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/customhelp">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_layout"><a class="anchor" href="#_custom_layout"></a>16.2. Custom Layout</h3>
<div class="paragraph">
<p>Picocli also supports unconventional option list layouts. An example of an unconventional layout is the <code>zip</code> application, which shows multiple options per row:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="k">new</span> <span class="nc">ZipHelpDemo</span><span class="o">(),</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">ZipHelpDemo</span><span class="p">(),</span> <span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Copyright (c) 1990-2008 Info-ZIP - Type 'zip "-L"' for software license.
Zip 3.0 (July 5th 2008). Command:
zip [-options] [-b path] [-t mmddyyyy] [-n suffixes] [zipfile list] [-xi list]
  The default action is to add or replace zipfile entries from list, which
  can include the special name - to compress standard input.
  If zipfile and list are omitted, zip compresses stdin to stdout.
  -f   freshen: only changed files  -u   update: only changed or new files
  -d   delete entries in zipfile    -m   move into zipfile (delete OS files)
  -r   recurse into directories     -j   junk (don't record) directory names
  -0   store only                   -l   convert LF to CR LF (-ll CR LF to LF)
  -1   compress faster              -9   compress better
  -q   quiet operation              -v   verbose operation/print version info
  -c   add one-line comments        -z   add zipfile comment
  -@   read names from stdin        -o   make zipfile as old as latest entry
  -x   exclude the following names  -i   include only the following names
  -F   fix zipfile (-FF try harder) -D   do not add directory entries
  -A   adjust self-extracting exe   -J   junk zipfile prefix (unzipsfx)
  -T   test zipfile integrity       -X   eXclude eXtra file attributes
  -y   store symbolic links as the link instead of the referenced file
  -e   encrypt                      -n   don't compress these suffixes
  -h2  show more help</pre>
</div>
</div>
<div class="paragraph">
<p>This can be achieved in picocli by subclassing the Help.Layout class.
See the <a href="https://github.com/remkop/picocli/blob/master/src/test/java/picocli/CustomLayoutDemo.java">CustomLayoutDemo</a> class in the picocli tests for how to achieve this.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_subcommands"><a class="anchor" href="#_subcommands"></a>17. Subcommands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sophisticated command-line tools, like the prominent <code>git</code> tool, have many subcommands (e.g., <code>commit</code>, <code>push</code>, â¦), each with its own set of options and positional parameters.
Picocli makes it very easy to have commands with subcommands, and sub-subcommands, to any level of depth.</p>
</div>
<div class="sect2">
<h3 id="_subcommand_examples"><a class="anchor" href="#_subcommand_examples"></a>17.1. Subcommand Examples</h3>
<div class="paragraph">
<p>If you want to jump ahead and see some examples first, these resources may be helpful:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#_executing_subcommands">Executing Subcommands</a> section below has an example that uses both the <code>@Command(subcommands = &lt;class&gt;)</code> syntax and the <code>@Command</code>-annotated method syntax.</p>
</li>
<li>
<p>The Quick Guide has an <a href="https://picocli.info/quick-guide.html#_subcommands_example_iso_code_resolver">example application</a> featuring subcommands, with a detailed explanation.</p>
</li>
<li>
<p>The <code>picocli-examples</code> code module has a <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/subcommands">subcommand section</a> with several minimal code samples, explaining the use of subcommands both via <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/subcommands/SubCmdsViaMethods.java">methods</a> and when defined in their own <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/subcommands/SubcommandDemo.java">class</a>.</p>
</li>
<li>
<p>The <code>picocli-examples</code> code module also shows subcommand examples in other languages, like <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/scala/picocli/examples/scala/subcommands">Scala</a> and <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin/subcommands">Kotlin</a>, as well as <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/subcommands">Java</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_registering_subcommands_declaratively"><a class="anchor" href="#_registering_subcommands_declaratively"></a>17.2. Registering Subcommands Declaratively</h3>
<div class="paragraph">
<p>Subcommands can be registered declaratively with the <code>@Command</code> annotation&#8217;s <code>subcommands</code> attribute since picocli 0.9.8.
This is the recommended way when you want to use the picocli <a href="#_annotation_processor">annotation processor</a> to <a href="#_generate_man_page_documentation">generate documentation</a>, <a href="#_tab_autocomplete">autocompletion scripts</a> or <a href="#_graalvm_native_image">GraalVM configuration files</a>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nc">GitStatus</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitCommit</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitAdd</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitBranch</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitCheckout</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitClone</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitDiff</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitMerge</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitPush</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitRebase</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GitTag</span><span class="o">.</span><span class="na">class</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="o">[</span>
    <span class="n">GitStatus</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitCommit</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitAdd</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitBranch</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitCheckout</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitClone</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitDiff</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitMerge</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitPush</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitRebase</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GitTag</span><span class="o">.</span><span class="na">class</span>
<span class="o">])</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nc">GitStatus</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitCommit</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitAdd</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitBranch</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitCheckout</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitClone</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitDiff</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitMerge</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitPush</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitRebase</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GitTag</span><span class="o">::</span><span class="k">class</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">public</span> <span class="kd">class</span> <span class="nc">Git</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitStatus</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitCommit</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitAdd</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitBranch</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitCheckout</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitClone</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitDiff</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitMerge</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitPush</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitRebase</span><span class="o">],</span>
    <span class="n">classOf</span><span class="o">[</span><span class="kt">GitTag</span><span class="o">]</span>
<span class="o">))</span>
<span class="k">class</span> <span class="nc">Git</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Subcommands referenced in a <code>subcommands</code> attribute <em>must</em> have a <code>@Command</code> annotation with a <code>name</code> attribute, or an exception is thrown from the <code>CommandLine</code> constructor.
This name will be used both for generating usage help and for recognizing subcommands when parsing the command line.
Command names are case-sensitive by default, but this is <a href="#_case_sensitivity">customizable</a>.</p>
</div>
<div class="paragraph">
<p>Custom type converters registered on a <code>CommandLine</code> instance will apply to all subcommands that were declared on the main command with the <code>subcommands</code> annotation.</p>
</div>
<div class="paragraph">
<p>Subcommands referenced in a <code>subcommands</code> attribute need to have a public no-argument constructor to be instantiated, unless a <a href="#_custom_factory">Custom Factory</a> is installed to instantiate classes.</p>
</div>
<div class="paragraph">
<p>Prior to picocli 4.2, the declared subcommands were instantiated immediately when the top-level <code>CommandLine</code> (the <code>new CommandLine(new Git())</code> object in the above example) was constructed.</p>
</div>
<div class="paragraph">
<p>From picocli 4.2, the declared subcommands are not instantiated until they are matched on the command line, unless they have a <code>@Spec</code> or <code>@ParentCommand</code>-annotated field; these are injected during initialization, and in order to inject them the subcommand is instantiated during initialization.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subcommands_as_methods"><a class="anchor" href="#_subcommands_as_methods"></a>17.3. Subcommands as Methods</h3>
<div class="paragraph">
<p>As of picocli 3.6 it is possible to register subcommands in a very compact manner by having a <code>@Command</code> class with <code>@Command</code>-annotated methods.
The methods are automatically <a href="#_subcommand_methods">registered as subcommands</a> of the enclosing <code>@Command</code> class.
See the <a href="#command-methods">command methods</a> section for more details and examples.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/remkop/picocli/blob/master/picocli-examples"><code>picocli-examples</code></a> module has an  minimal example application, demonstrating the definition of subcommands via methods. This example was coded in <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/subcommands/SubCmdsViaMethods.java">Java</a>, <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin/subcommands/SubCmdsViaMethods.kt">Kotlin</a> and <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/scala/picocli/examples/scala/subcommands/SubCmdsViaMethods.scala">Scala</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_registering_subcommands_programmatically"><a class="anchor" href="#_registering_subcommands_programmatically"></a>17.4. Registering Subcommands Programmatically</h3>
<div class="paragraph">
<p>Subcommands can be registered with the <code>CommandLine.addSubcommand</code> method.
You pass in the name of the command and the annotated object to populate with the subcommand options.
The specified name is used by the parser to recognize subcommands in the command line arguments.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"add"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitAdd</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"branch"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitBranch</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"checkout"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">GitCheckout</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"clone"</span><span class="o">,</span>    <span class="k">new</span> <span class="nc">GitClone</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"diff"</span><span class="o">,</span>     <span class="k">new</span> <span class="nc">GitDiff</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"merge"</span><span class="o">,</span>    <span class="k">new</span> <span class="nc">GitMerge</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"push"</span><span class="o">,</span>     <span class="k">new</span> <span class="nc">GitPush</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"rebase"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitRebase</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"tag"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitTag</span><span class="o">());</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="kt">def</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="n">Git</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="n">GitStatus</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="n">GitCommit</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"add"</span><span class="o">,</span>      <span class="k">new</span> <span class="n">GitAdd</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"branch"</span><span class="o">,</span>   <span class="k">new</span> <span class="n">GitBranch</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"checkout"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GitCheckout</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"clone"</span><span class="o">,</span>    <span class="k">new</span> <span class="n">GitClone</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"diff"</span><span class="o">,</span>     <span class="k">new</span> <span class="n">GitDiff</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"merge"</span><span class="o">,</span>    <span class="k">new</span> <span class="n">GitMerge</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"push"</span><span class="o">,</span>     <span class="k">new</span> <span class="n">GitPush</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"rebase"</span><span class="o">,</span>   <span class="k">new</span> <span class="n">GitRebase</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s2">"tag"</span><span class="o">,</span>      <span class="k">new</span> <span class="n">GitTag</span><span class="o">());</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Git</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span>   <span class="nc">GitStatus</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"commit"</span><span class="p">,</span>   <span class="nc">GitCommit</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"add"</span><span class="p">,</span>      <span class="nc">GitAdd</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"branch"</span><span class="p">,</span>   <span class="nc">GitBranch</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"checkout"</span><span class="p">,</span> <span class="nc">GitCheckout</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"clone"</span><span class="p">,</span>    <span class="nc">GitClone</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"diff"</span><span class="p">,</span>     <span class="nc">GitDiff</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"merge"</span><span class="p">,</span>    <span class="nc">GitMerge</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"push"</span><span class="p">,</span>     <span class="nc">GitPush</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"rebase"</span><span class="p">,</span>   <span class="nc">GitRebase</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"tag"</span><span class="p">,</span>      <span class="nc">GitTag</span><span class="p">())</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="k">val</span> <span class="nv">commandLine</span><span class="k">:</span> <span class="kt">CommandLine</span>  <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"add"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitAdd</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"branch"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitBranch</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"checkout"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">GitCheckout</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"clone"</span><span class="o">,</span>    <span class="k">new</span> <span class="nc">GitClone</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"diff"</span><span class="o">,</span>     <span class="k">new</span> <span class="nc">GitDiff</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"merge"</span><span class="o">,</span>    <span class="k">new</span> <span class="nc">GitMerge</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"push"</span><span class="o">,</span>     <span class="k">new</span> <span class="nc">GitPush</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"rebase"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitRebase</span><span class="o">())</span>
        <span class="o">.</span><span class="py">addSubcommand</span><span class="o">(</span><span class="s">"tag"</span><span class="o">,</span>      <span class="k">new</span> <span class="nc">GitTag</span><span class="o">())</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is strongly recommended that subcommands have a <code>@Command</code> annotation with <code>name</code> and <code>description</code> attributes.</p>
</div>
<div class="paragraph">
<p>From picocli 3.1, the usage help synopsis of the subcommand shows not only the subcommand name but also the parent command name.
For example, if the <code>git</code> command has a <code>commit</code> subcommand, the usage help for the <code>commit</code> subcommand shows <code>Usage: git commit &lt;options&gt;</code>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<em>Note on custom type converters:</em> custom type converters are registered only with the subcommands and nested
sub-subcommands that were added <em>before</em> the custom type was registered.
To ensure a custom type converter is available to all subcommands, register the type converter last, after
adding subcommands.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_executing_subcommands"><a class="anchor" href="#_executing_subcommands"></a>17.5. Executing Subcommands</h3>
<div class="paragraph">
<p>The easiest way to design an application with subcommands is to let each command and subcommand either be a class that implements <code>Runnable</code> or <code>Callable</code>, or a <code>@Command</code>-annotated method.</p>
</div>
<div class="paragraph">
<p>This will allow you to parse the command line, deal with requests for help and requests for version information, deal with invalid user input, and invoke the business logic of the user-specified subcommand - all of that - in one line of code: the <a href="#execute"><code>execute</code></a> method.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"foo"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="nc">Bar</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"hi from foo, x=%d%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
        <span class="kt">boolean</span> <span class="n">ok</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">ok</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// exit code</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Foo</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"bar"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"I'm a subcommand of `foo`"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"hi from bar, y=%d%n"</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
        <span class="k">return</span> <span class="mi">23</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"baz"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"I'm a subcommand of `bar`"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="nf">baz</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-z"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"hi from baz, z=%d%n"</span><span class="o">,</span> <span class="n">z</span><span class="o">);</span>
        <span class="k">return</span> <span class="mi">45</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"foo"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="n">Bar</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s2">"-x"</span><span class="o">)</span> <span class="kt">def</span> <span class="n">x</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="n">Integer</span> <span class="n">call</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">println</span> <span class="s2">"hi from foo, x=$x"</span>
        <span class="kt">def</span> <span class="n">ok</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">ok</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span> <span class="c1">// exit code</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">def</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="n">Foo</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>
        <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"bar"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">"I'm a subcommand of `foo`"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Bar</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s2">"-y"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">y</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="n">Integer</span> <span class="n">call</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">println</span> <span class="s2">"hi from bar, y=$y"</span>
        <span class="k">return</span> <span class="mi">23</span>
    <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"baz"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">"I'm a subcommand of `bar`"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="nf">baz</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s2">"-z"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">z</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">println</span> <span class="s2">"hi from baz, z=$z"</span>
        <span class="k">return</span> <span class="mi">45</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Bar</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"hi from foo, x=$x"</span><span class="p">)</span>
        <span class="kd">var</span> <span class="py">ok</span><span class="p">:</span> <span class="nc">Boolean</span> <span class="p">=</span> <span class="k">true</span>
        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">ok</span><span class="p">)</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span> <span class="c1">// exit code</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">:</span> <span class="nc">Unit</span> <span class="p">=</span> <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Foo</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"bar"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"I'm a subcommand of `foo`"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Bar</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">y</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"hi form bar, y=$y"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">23</span>
    <span class="p">}</span>

    <span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"baz"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"I'm a subcommand of `bar`"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">baz</span><span class="p">(</span> <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-z"</span><span class="p">])</span> <span class="n">z</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">:</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"hi from baz, z=$z"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">45</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"foo"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">Bar</span><span class="o">]))</span>
<span class="k">class</span> <span class="nc">Foo</span> <span class="k">extends</span> <span class="nc">Callable</span><span class="o">[</span><span class="kt">Integer</span><span class="o">]</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-x"</span><span class="o">))</span>
    <span class="k">var</span> <span class="n">x</span> <span class="k">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">def</span> <span class="nf">call</span><span class="k">:</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"hi from foo, $x"</span><span class="o">)</span>
        <span class="k">val</span> <span class="nv">ok</span> <span class="k">=</span> <span class="kc">true</span>
        <span class="nf">if</span> <span class="o">(</span><span class="n">ok</span><span class="o">)</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span> <span class="c1">// exit code</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Foo</span><span class="o">{</span>
    <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
        <span class="k">val</span> <span class="nv">exitCode</span> <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Foo</span><span class="o">()).</span><span class="py">execute</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
        <span class="nv">System</span><span class="o">.</span><span class="py">exit</span><span class="o">(</span><span class="n">exitCode</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"bar"</span><span class="o">,</span> <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"I'm a subcommand of `foo`"</span><span class="o">))</span> <span class="k">class</span> <span class="nc">Bar</span> <span class="k">extends</span> <span class="nc">Callable</span><span class="o">[</span><span class="kt">Integer</span><span class="o">]</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-y"</span><span class="o">))</span>
    <span class="k">var</span> <span class="n">y</span> <span class="k">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">def</span> <span class="nf">call</span><span class="k">:</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"hi from bar, y=$y"</span><span class="o">)</span>
        <span class="mi">23</span>
    <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"baz"</span><span class="o">,</span> <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"I'm a subcommand of `bar`"</span><span class="o">))</span>
    <span class="k">def</span> <span class="nf">baz</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-z"</span><span class="o">))</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"hi from baz, z=$z"</span><span class="o">)</span>
        <span class="mi">45</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To test our example on Linux, we created an alias <code>foo</code> that invokes our Java application.
This could also be a script or a function that calls our Java program:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">alias </span><span class="nv">foo</span><span class="o">=</span><span class="s1">'java Foo'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we call our top-level command with an option like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>foo <span class="nt">-x</span> 123
hi from foo, <span class="nv">x</span><span class="o">=</span>123

<span class="c">#check the exit code</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$?</span>
0</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also specify a subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>foo <span class="nt">-x</span> 123 bar <span class="nt">-y</span><span class="o">=</span>456
hi from bar, <span class="nv">y</span><span class="o">=</span>456

<span class="c">#check the exit code</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$?</span>
23</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally, we can also specify a sub-subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>foo bar baz <span class="nt">-z</span><span class="o">=</span>789
hi from baz, <span class="nv">z</span><span class="o">=</span>789

<span class="c">#check the exit code</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$?</span>
45</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <em>last specified</em> command or subcommand is executed and its exit code is returned.
See also <a href="#_executing_commands_with_subcommands">Executing Commands with Subcommands</a> for details on configuring this.</p>
</div>
</div>
<div class="sect2">
<h3 id="_initialization_before_execution"><a class="anchor" href="#_initialization_before_execution"></a>17.6. Initialization Before Execution</h3>
<div class="paragraph">
<p>Sometimes an application needs to take some action before execution.
With a single command, you can simply do this in the beginning of the <code>run</code> or <code>call</code> method, but in an application with subcommands you don&#8217;t want to repeat this code in every subcommand.</p>
</div>
<div class="paragraph">
<p>One idea is to put the shared initialization logic in a custom execution strategy. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span><span class="nc">Sub1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Sub2</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Sub3</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first calls the init() method,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">executionStrategy</span><span class="o">(</span><span class="nc">ParseResult</span> <span class="n">parseResult</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">init</span><span class="o">();</span> <span class="c1">// custom initialization to be done before executing any command or subcommand</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">RunLast</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="n">parseResult</span><span class="o">);</span> <span class="c1">// default execution strategy</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">MyApp</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyApp</span><span class="o">();</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setExecutionStrategy</span><span class="o">(</span><span class="nl">app:</span><span class="o">:</span><span class="n">executionStrategy</span><span class="o">)</span>
                <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="o">[</span><span class="n">Sub1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Sub2</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Sub3</span><span class="o">.</span><span class="na">class</span><span class="o">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first calls the init() method,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="kt">def</span> <span class="kt">int</span> <span class="nf">executionStrategy</span><span class="o">(</span><span class="n">ParseResult</span> <span class="n">parseResult</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">init</span><span class="o">();</span> <span class="c1">// custom initialization to be done before executing any command or subcommand</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">CommandLine</span><span class="o">.</span><span class="na">RunLast</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="n">parseResult</span><span class="o">);</span> <span class="c1">// default execution strategy</span>
    <span class="o">}</span>

    <span class="kt">def</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">def</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyApp</span><span class="o">();</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setExecutionStrategy</span><span class="o">(</span><span class="n">app</span><span class="o">.&amp;</span><span class="n">executionStrategy</span><span class="o">)</span>
                <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Sub1</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Sub2</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Sub3</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first calls the init() method,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="k">private</span> <span class="k">fun</span> <span class="nf">executionStrategy</span><span class="p">(</span><span class="n">parseResult</span><span class="p">:</span> <span class="nc">ParseResult</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nf">init</span><span class="p">()</span> <span class="c1">// custom initialization to be done before executing any command or subcommand</span>
        <span class="k">return</span> <span class="nc">RunLast</span><span class="p">().</span><span class="nf">execute</span><span class="p">(</span><span class="n">parseResult</span><span class="p">)</span> <span class="c1">// default execution strategy</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">MyApp</span><span class="p">()</span>
            <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">setExecutionStrategy</span> <span class="p">{</span>
                     <span class="n">parseResult</span><span class="p">:</span> <span class="nc">ParseResult</span> <span class="p">-&gt;</span> <span class="n">app</span><span class="p">.</span><span class="nf">executionStrategy</span><span class="p">(</span><span class="n">parseResult</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">Sub1</span><span class="o">],</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">Sub2</span><span class="o">],</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">Sub3</span><span class="o">]))</span>
<span class="k">class</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first calls the init() method,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="k">private</span> <span class="k">def</span> <span class="nf">executionStrategy</span><span class="o">(</span><span class="n">parseResult</span><span class="k">:</span> <span class="kt">ParseResult</span> <span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
        <span class="nf">init</span><span class="o">()</span> <span class="c1">// custom initialization to be done before executing any command or subcommand</span>
        <span class="k">new</span> <span class="nv">CommandLine</span><span class="o">.</span><span class="py">RunLast</span><span class="o">().</span><span class="py">execute</span><span class="o">(</span><span class="n">parseResult</span><span class="o">)</span> <span class="c1">// default execution strategy</span>
    <span class="o">}</span>

    <span class="k">private</span> <span class="k">def</span> <span class="nf">init</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
        <span class="k">val</span> <span class="nv">app</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyApp</span>
        <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">)</span>
            <span class="o">.</span><span class="py">setExecutionStrategy</span><span class="o">(</span><span class="nv">app</span><span class="o">.</span><span class="py">executionStrategy</span><span class="o">)</span>
            <span class="o">.</span><span class="py">execute</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures the <code>init</code> method is called <em>after</em> the command line is parsed (so all options and positional parameters are assigned) but <em>before</em> the user-specified subcommand is executed.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/logging_mixin_advanced">logging example</a> in <code>picocli-examples</code> shows how this can be used to configure the Log4j log level based on a <code>--verbose</code> option, prior to execution.</p>
</div>
</div>
<div class="sect2">
<h3 id="parentcommand-annotation"><a class="anchor" href="#parentcommand-annotation"></a>17.7. <code>@ParentCommand</code> Annotation</h3>
<div class="paragraph">
<p>In command line applications with subcommands, options of the top level command are often intended as "global" options that apply to all the subcommands.
Prior to picocli 2.2, subcommands had no easy way to access their parent command options unless the parent command made these values available in a global variable.</p>
</div>
<div class="paragraph">
<p>The <code>@ParentCommand</code> annotation introduced in picocli 2.2 makes it easy for subcommands to access their parent command options:
subcommand fields annotated with <code>@ParentCommand</code> are initialized with a reference to the parent command.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"fileutils"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="nc">ListFiles</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">FileUtils</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-d"</span><span class="o">,</span> <span class="s">"--directory"</span><span class="o">},</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"this option applies to all subcommands"</span><span class="o">)</span>
    <span class="nc">File</span> <span class="n">baseDirectory</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Groovy</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"fileutils"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">[</span><span class="n">ListFiles</span><span class="o">.</span><span class="na">class</span><span class="o">])</span>
<span class="kd">class</span> <span class="nc">FileUtils</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s2">"-d"</span><span class="o">,</span> <span class="s2">"--directory"</span><span class="o">],</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s2">"this option applies to all subcommands"</span><span class="o">)</span>
    <span class="kt">def</span> <span class="n">baseDirectory</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"fileutils"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">ListFiles</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">FileUtils</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-d"</span><span class="p">,</span> <span class="s">"--directory"</span><span class="p">],</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"this option applies to all subcommands"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">baseDirectory</span><span class="p">:</span> <span class="nc">File</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"fileutils"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">ListFiles</span><span class="o">]))</span>
<span class="k">class</span> <span class="nc">FileUtils</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-d"</span><span class="o">,</span> <span class="s">"--directory"</span><span class="o">),</span>
            <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"this option applies to all subcommands"</span><span class="o">))</span>
    <span class="k">var</span> <span class="n">baseDirectory</span><span class="k">:</span> <span class="kt">File</span> <span class="o">=</span> <span class="kc">null</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above top-level command has a <code>--directory</code> option that applies to its subcommands.
The <code>ListFiles</code> subcommand can use the <code>@ParentCommand</code> annotation to get a reference to the parent command, so it can easily access the parent command options.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"list"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">ListFiles</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@ParentCommand</span>
    <span class="kd">private</span> <span class="nc">FileUtils</span> <span class="n">parent</span><span class="o">;</span> <span class="c1">// picocli injects reference to parent command</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-r"</span><span class="o">,</span> <span class="s">"--recursive"</span><span class="o">},</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"Recursively list subdirectories"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">recursive</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">list</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">baseDirectory</span><span class="o">,</span> <span class="s">"."</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">list</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dir</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">());</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dir</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">File</span> <span class="n">f</span> <span class="o">:</span> <span class="n">dir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">recursive</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">list</span><span class="o">(</span><span class="n">f</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">());</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"list"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">ListFiles</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@ParentCommand</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">parent</span><span class="p">:</span> <span class="nc">FileUtils</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span> <span class="c1">// picocli injects reference to parent command</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-r"</span><span class="p">,</span> <span class="s">"--recursive"</span><span class="p">],</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Recursively list subdirectories"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">recursive</span> <span class="p">=</span> <span class="k">false</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">list</span><span class="p">(</span><span class="nc">File</span><span class="p">(</span><span class="n">parent</span><span class="o">!!</span><span class="p">.</span><span class="n">baseDirectory</span><span class="p">,</span> <span class="s">"."</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">list</span><span class="p">(</span><span class="n">dir</span><span class="p">:</span> <span class="nc">File</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">dir</span><span class="p">.</span><span class="n">absolutePath</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dir</span><span class="p">.</span><span class="n">isDirectory</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">f</span> <span class="k">in</span> <span class="n">dir</span><span class="p">.</span><span class="nf">listFiles</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">isDirectory</span> <span class="p">&amp;&amp;</span> <span class="n">recursive</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nf">println</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">absolutePath</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subcommand_aliases"><a class="anchor" href="#_subcommand_aliases"></a>17.8. Subcommand Aliases</h3>
<div class="paragraph">
<p>Commands may optionally define an <code>aliases</code> attribute to provide alternate names for commands that will be recognized by the parser. Aliases are displayed in the default help output. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">aliases</span> <span class="o">=</span> <span class="o">{</span><span class="s">"st"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Show the working tree status."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">GitStatus</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"status"</span><span class="p">,</span> <span class="n">aliases</span> <span class="p">=</span> <span class="p">[</span><span class="s">"st"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Show the working tree status."</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">GitStatus</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Would result in this help fragment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>status, st    Show the working tree status.</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inherited_command_attributes"><a class="anchor" href="#_inherited_command_attributes"></a>17.9. Inherited Command Attributes</h3>
<div class="paragraph">
<p>Picocli 4.6 adds support for inheriting <code>@Command</code> attributes with the <code>scope = ScopeType.INHERIT</code> annotation.
Commands with this scope have their <code>@Command</code> attributes copied to all subcommands (and sub-subcommands, to any level of depth).</p>
</div>
<div class="paragraph">
<p>When a subcommand specifies an explicit value in its <code>@Command</code> annotation, this value is used instead of the inherited value.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"app"</span><span class="o">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="nc">ScopeType</span><span class="o">.</span><span class="na">INHERIT</span><span class="o">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"app version 1.0"</span><span class="o">,</span>
         <span class="n">header</span> <span class="o">=</span> <span class="s">"App header"</span><span class="o">,</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s">"App description"</span><span class="o">,</span>
         <span class="n">footerHeading</span> <span class="o">=</span> <span class="s">"Copyright%n"</span><span class="o">,</span> <span class="n">footer</span> <span class="o">=</span> <span class="s">"(c) Copyright by the authors"</span><span class="o">,</span>
         <span class="n">showAtFileInUsageHelp</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Hello from app!%nx = %d%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span> <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">header</span> <span class="o">=</span> <span class="s">"Subcommand header"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Subcommand description"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">sub</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Hello app sub!%ny = %d"</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"app"</span><span class="p">,</span> <span class="n">scope</span> <span class="p">=</span> <span class="nc">ScopeType</span><span class="p">.</span><span class="nc">INHERIT</span><span class="p">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"app version 1.0"</span><span class="p">],</span>
         <span class="n">header</span> <span class="p">=</span> <span class="p">[</span><span class="s">"App header"</span><span class="p">],</span>
         <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"App description"</span><span class="p">],</span>
         <span class="n">footerHeading</span> <span class="p">=</span> <span class="s">"Copyright%n"</span><span class="p">,</span> <span class="n">footer</span> <span class="p">=</span> <span class="p">[</span><span class="s">"(c) Copyright by the authors"</span><span class="p">],</span>
         <span class="n">showAtFileInUsageHelp</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Hello from app!\nx = $x"</span><span class="p">)</span> <span class="p">}</span>

    <span class="nd">@Command</span><span class="p">(</span><span class="n">header</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Subcommand header"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Subcommand description"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">sub</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span> <span class="n">y</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"Hello from sub!\ny = $y"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>app</code> command in the above example has <code>scope = ScopeType.INHERIT</code>, so its <code>@Command</code> properties are inherited by the <code>sub</code> subcommand.</p>
</div>
<div class="paragraph">
<p>The <code>sub</code> subcommand defines its own <code>header</code> and <code>description</code>, so these are not inherited from the parent command.
The help message for the subcommand looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Subcommand header
Usage: app sub [-hV] [-y=&lt;arg0&gt;] [@&lt;filename&gt;...]
Subcommand description
      [@&lt;filename&gt;...]   One or more argument files containing options.
  -h, --help             Show this help message and exit.
  -V, --version          Print version information and exit.
  -y=&lt;arg0&gt;
Copyright
(c) Copyright by the authors</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the subcommand has inherited the mixed-in standard help options (<code>--help</code> and <code>--version</code>), the <code>@file</code> usage help, and the footer and footer heading.
It also inherited the version string, shown when the user invokes <code>app sub --version</code>.</p>
</div>
<div class="paragraph">
<p>When a command has <code>scope = INHERIT</code>, the following attributes are copied to its subcommands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all usage help attributes: description, descriptionHeading, header, headerHeading, footer, footerHeading, customSynopsis, synopsisHeading, synopsisSubcommandLabel, abbreviateSynopsis, optionListHeading, parameterListHeading, commandListHeading, exitCodeList, exitCodeListHeading, requiredOptionMarker, showDefaultValues, sortOptions, autoWidth, width, showAtFileInUsageHelp, showEndOfOptionsDelimiterInUsageHelp, and hidden</p>
</li>
<li>
<p>exit codes: exitCodeOnSuccess, exitCodeOnUsageHelp, exitCodeOnVersionHelp, exitCodeOnInvalidInput, exitCodeOnExecutionException</p>
</li>
<li>
<p>the help and version options mixed in by <code>mixinStandardHelpOptions</code></p>
</li>
<li>
<p>separator between option and option parameter</p>
</li>
<li>
<p>version</p>
</li>
<li>
<p>versionProvider</p>
</li>
<li>
<p>defaultValueProvider</p>
</li>
<li>
<p>subcommandsRepeatable</p>
</li>
<li>
<p>whether this command is a <code>helpCommand</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Attributes that are <em>not</em> copied include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>command name</p>
</li>
<li>
<p>command aliases</p>
</li>
<li>
<p>options and parameters (other than the help and version options mixed in by <code>mixinStandardHelpOptions</code>)</p>
</li>
<li>
<p>other mixins than <code>mixinStandardHelpOptions</code></p>
</li>
<li>
<p>subcommands</p>
</li>
<li>
<p>argument groups</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inherited_options"><a class="anchor" href="#_inherited_options"></a>17.10. Inherited Options</h3>
<div class="paragraph">
<p>Picocli 4.3 adds support for "inherited" options.
Options defined with <code>scope = ScopeType.INHERIT</code> are shared with all subcommands (and sub-subcommands, to any level of depth).
Applications can define an inherited option on the top-level command, in one place, to allow end users to specify this option anywhere: not only on the top-level command, but also on any of the subcommands and nested sub-subcommands.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Inherited options currently cannot be used in <a href="#_argument_groups">Argument Groups</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Below is an example where an inherited option is used to configure logging.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"app"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="nc">Sub</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">App</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="nc">ScopeType</span><span class="o">.</span><span class="na">LOCAL</span><span class="o">)</span> <span class="c1">// option is not shared: this is the default</span>
    <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-v"</span><span class="o">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="nc">ScopeType</span><span class="o">.</span><span class="na">INHERIT</span><span class="o">)</span> <span class="c1">// option is shared with subcommands</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVerbose</span><span class="o">(</span><span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbose</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Configure log4j.</span>
        <span class="c1">// (This is a simplistic example: a real application may use more levels and</span>
        <span class="c1">// perhaps configure only the ConsoleAppender level instead of the root log level.)</span>
        <span class="nc">Configurator</span><span class="o">.</span><span class="na">setRootLevel</span><span class="o">(</span><span class="n">verbose</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nc">Level</span><span class="o">.</span><span class="na">DEBUG</span> <span class="o">:</span> <span class="nc">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"-x={}"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"sub"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">Sub</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"-y={}"</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"app"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Sub</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">LogManager</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="nc">App</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">scope</span> <span class="p">=</span> <span class="nc">ScopeType</span><span class="p">.</span><span class="nc">LOCAL</span><span class="p">)</span> <span class="c1">// option is not shared by default</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">],</span> <span class="n">scope</span> <span class="p">=</span> <span class="nc">ScopeType</span><span class="p">.</span><span class="nc">INHERIT</span><span class="p">)</span> <span class="c1">// option is shared with subcommands</span>
    <span class="k">fun</span> <span class="nf">setVerbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="nc">BooleanArray</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Configure log4j.</span>
        <span class="c1">// (This is a simplistic example: a real application may use more levels and</span>
        <span class="c1">// perhaps configure only the ConsoleAppender level instead of the root log level.)</span>
        <span class="nc">Configurator</span><span class="p">.</span><span class="nf">setRootLevel</span><span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">.</span><span class="n">size</span> <span class="p">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">DEBUG</span> <span class="k">else</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">INFO</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"-x={}"</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"sub"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logger</span> <span class="p">=</span> <span class="nc">LogManager</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="nc">Sub</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"-y={}"</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Users can specify the <code>-v</code> option on either the top-level command or on the subcommand, and it will have the same effect.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># the -v option can be specified on the top-level command
java App -x=3 -v sub -y=4</pre>
</div>
</div>
<div class="paragraph">
<p>Specifying the <code>-v</code> option on the subcommand will have the same effect. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># specifying the -v option on the subcommand also changes the log level
java App -x=3 sub -y=4 -v</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Subcommands don&#8217;t need to do anything to receive inherited options, but a potential drawback is that subcommands do not get a reference to inherited options.</p>
</div>
<div class="paragraph">
<p>Subcommands that need to inspect the value of an inherited option can use the <a href="#parentcommand-annotation"><code>@ParentCommand</code> annotation</a> to get a reference to their parent command, and access the inherited option via the parent reference.
Alternatively, for such subcommands, sharing options via <a href="#_mixins">mixins</a> may be a more suitable mechanism.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_manually_parsing_subcommands"><a class="anchor" href="#_manually_parsing_subcommands"></a>17.11. Manually Parsing Subcommands</h3>
<div class="paragraph">
<p>For the following example, we assume we created an alias <code>git</code> that invokes our Java application. This could also be a script or a function that calls our Java program:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">alias </span><span class="nv">git</span><span class="o">=</span><span class="s1">'java picocli.Demo$Git'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we call our command with some arguments like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">git <span class="nt">--git-dir</span><span class="o">=</span>/home/rpopma/picocli status <span class="nt">-sb</span> <span class="nt">-uno</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>git</code> (actually <code>java picocli.Demo$Git</code>) is the top-level command, followed by a global option and a subcommand <code>status</code> with its own options.</p>
</div>
<div class="paragraph">
<p>Setting up the parser and parsing the command line could look like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Set up the parser</span>
    <span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">());</span>

    <span class="c1">// add subcommands programmatically (not necessary if the parent command</span>
    <span class="c1">// declaratively registers the subcommands via annotation)</span>
    <span class="n">commandLine</span><span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">())</span>
               <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">())</span>
               <span class="c1">// ...</span>
               <span class="o">;</span>

    <span class="c1">// Invoke the parseArgs method to parse the arguments</span>
    <span class="nc">ParseResult</span> <span class="n">parsed</span> <span class="o">=</span> <span class="n">commandLine</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="n">handleParseResult</span><span class="o">(</span><span class="n">parsed</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="c1">// Set up the parser</span>
    <span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Git</span><span class="p">())</span>

    <span class="c1">// add subcommands programmatically (not necessary if the parent command</span>
    <span class="c1">// declaratively registers the subcommands via annotation)</span>
    <span class="n">commandLine</span><span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span>   <span class="nc">GitStatus</span><span class="p">())</span>
               <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"commit"</span><span class="p">,</span>   <span class="nc">GitCommit</span><span class="p">())</span>
               <span class="c1">// ...</span>

    <span class="c1">// Invoke the parseArgs method to parse the arguments</span>
    <span class="kd">val</span> <span class="py">parsed</span> <span class="p">=</span> <span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
    <span class="nf">handleParseResult</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>CommandLine.parseArgs</code> method returns a <code>ParseResult</code> that can be queried to get information about
the top-level command (the Java class invoked by <code>git</code> in this example).
The <code>ParseResult.subcommand()</code> method returns a nested <code>ParseResult</code> if the parser found a subcommand.
This can be recursively queried until the last nested subcommand was found and the <code>ParseResult.subcommand()</code> method returns <code>null</code>.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleParseResult</span><span class="o">(</span><span class="nc">ParseResult</span> <span class="n">parsed</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">assert</span> <span class="n">parsed</span><span class="o">.</span><span class="na">subcommand</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">:</span> <span class="s">"at least 1 command and 1 subcommand found"</span><span class="o">;</span>

    <span class="nc">ParseResult</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="na">subcommand</span><span class="o">();</span>
    <span class="k">assert</span> <span class="n">parsed</span><span class="o">.</span><span class="na">commandSpec</span><span class="o">().</span><span class="na">userObject</span><span class="o">().</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="nc">Git</span><span class="o">.</span><span class="na">class</span>       <span class="o">:</span> <span class="s">"main command"</span><span class="o">;</span>
    <span class="k">assert</span>    <span class="n">sub</span><span class="o">.</span><span class="na">commandSpec</span><span class="o">().</span><span class="na">userObject</span><span class="o">().</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="nc">GitStatus</span><span class="o">.</span><span class="na">class</span> <span class="o">:</span> <span class="s">"subcommand"</span><span class="o">;</span>

    <span class="nc">Git</span> <span class="n">git</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Git</span><span class="o">)</span> <span class="n">parsed</span><span class="o">.</span><span class="na">commandSpec</span><span class="o">().</span><span class="na">userObject</span><span class="o">();</span>
    <span class="k">assert</span> <span class="n">git</span><span class="o">.</span><span class="na">gitDir</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/home/rpopma/picocli"</span><span class="o">));</span>

    <span class="nc">GitStatus</span> <span class="n">gitstatus</span> <span class="o">=</span> <span class="o">(</span><span class="nc">GitStatus</span><span class="o">)</span> <span class="n">sub</span><span class="o">.</span><span class="na">commandSpec</span><span class="o">().</span><span class="na">userObject</span><span class="o">();</span>
    <span class="k">assert</span>  <span class="n">gitstatus</span><span class="o">.</span><span class="na">shortFormat</span>              <span class="o">:</span> <span class="s">"git status -s"</span><span class="o">;</span>
    <span class="k">assert</span>  <span class="n">gitstatus</span><span class="o">.</span><span class="na">branchInfo</span>               <span class="o">:</span> <span class="s">"git status -b"</span><span class="o">;</span>
    <span class="k">assert</span> <span class="o">!</span><span class="n">gitstatus</span><span class="o">.</span><span class="na">showIgnored</span>              <span class="o">:</span> <span class="s">"git status --showIgnored not specified"</span><span class="o">;</span>
    <span class="k">assert</span>  <span class="n">gitstatus</span><span class="o">.</span><span class="na">mode</span> <span class="o">==</span> <span class="nc">GitStatusMode</span><span class="o">.</span><span class="na">no</span> <span class="o">:</span> <span class="s">"git status -u=no"</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">private</span> <span class="k">fun</span> <span class="nf">handleParseResult</span><span class="p">(</span><span class="n">parsed</span><span class="p">:</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">ParseResult</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="nf">subcommand</span><span class="p">()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span> <span class="s">"at least 1 command and 1 subcommand found"</span> <span class="p">}</span>

    <span class="kd">val</span> <span class="py">sub</span> <span class="p">=</span> <span class="n">parsed</span><span class="p">.</span><span class="nf">subcommand</span><span class="p">()</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="nf">commandSpec</span><span class="p">().</span><span class="nf">userObject</span><span class="p">().</span><span class="n">javaClass</span> <span class="p">==</span> <span class="nc">Git</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="s">"main command"</span> <span class="p">}</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">sub</span><span class="p">.</span><span class="nf">commandSpec</span><span class="p">().</span><span class="nf">userObject</span><span class="p">().</span><span class="n">javaClass</span> <span class="p">==</span> <span class="nc">GitStatus</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="s">"subcommand"</span> <span class="p">}</span>

    <span class="kd">val</span> <span class="py">git</span> <span class="p">=</span> <span class="n">parsed</span><span class="p">.</span><span class="nf">commandSpec</span><span class="p">().</span><span class="nf">userObject</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Git</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">git</span><span class="p">.</span><span class="n">gitDir</span> <span class="p">==</span> <span class="nc">File</span><span class="p">(</span><span class="s">"/home/rpopma/picocli"</span><span class="p">))</span>

    <span class="kd">val</span> <span class="py">gitstatus</span> <span class="p">=</span> <span class="n">sub</span><span class="p">.</span><span class="nf">commandSpec</span><span class="p">().</span><span class="nf">userObject</span><span class="p">()</span> <span class="k">as</span> <span class="nc">GitStatus</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">gitstatus</span><span class="p">.</span><span class="n">shortFormat</span><span class="p">)</span>               <span class="p">{</span> <span class="s">"git status -s"</span> <span class="p">}</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">gitstatus</span><span class="p">.</span><span class="n">branchInfo</span><span class="p">)</span>                <span class="p">{</span> <span class="s">"git status -b"</span> <span class="p">}</span>
    <span class="nf">assert</span><span class="p">(!</span><span class="n">gitstatus</span><span class="p">.</span><span class="n">showIgnored</span><span class="p">)</span>              <span class="p">{</span> <span class="s">"git status --showIgnored not specified"</span> <span class="p">}</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">gitstatus</span><span class="p">.</span><span class="n">mode</span> <span class="p">===</span> <span class="nc">GitStatusMode</span><span class="p">.</span><span class="n">no</span><span class="p">)</span> <span class="p">{</span> <span class="s">"git status -u=no"</span> <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You may be interested in the <a href="#execute">execute method</a> to reduce error handling and other boilerplate code in your application.
See also the previous section, <a href="#_executing_subcommands">Executing Subcommands</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nested_sub_subcommands"><a class="anchor" href="#_nested_sub_subcommands"></a>17.12. Nested sub-Subcommands</h3>
<div class="paragraph">
<p>When registering subcommands declaratively, subcommands can be nested by specifying the <code>subcommands</code> attribute on subcommand classes:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"main"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nc">ChildCommand1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">ChildCommand2</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">ChildCommand3</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">MainCommand</span> <span class="o">{</span> <span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"cmd3"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nc">GrandChild3Command1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GrandChild3Command2</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="nc">GrandChild3Command3</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">ChildCommand3</span> <span class="o">{</span> <span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"cmd3sub3"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">GreatGrandChild3Command3_1</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">GreatGrandChild3Command3_2</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">GrandChild3Command3</span> <span class="o">{</span> <span class="o">}</span>
<span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"main"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nc">ChildCommand1</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">ChildCommand2</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">ChildCommand3</span><span class="o">::</span><span class="k">class</span><span class="p">]</span>
<span class="p">)</span>
<span class="kd">class</span> <span class="nc">MainCommand</span> <span class="p">{</span> <span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"cmd3"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nc">GrandChild3Command1</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GrandChild3Command2</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GrandChild3Command3</span><span class="o">::</span><span class="k">class</span><span class="p">]</span>
<span class="p">)</span>
<span class="kd">class</span> <span class="nc">ChildCommand3</span> <span class="p">{</span> <span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"cmd3sub3"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nc">GreatGrandChild3Command3_1</span><span class="o">::</span><span class="k">class</span><span class="p">,</span>
    <span class="nc">GreatGrandChild3Command3_2</span><span class="o">::</span><span class="k">class</span><span class="p">]</span>
<span class="p">)</span>
<span class="kd">class</span> <span class="nc">GrandChild3Command3</span> <span class="p">{}</span>
<span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When registering subcommands programmatically, the object passed to the <code>addSubcommand</code> method can be an annotated object or a <code>CommandLine</code> instance with its own nested subcommands.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MainCommand</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd1"</span><span class="o">,</span>                 <span class="k">new</span> <span class="nc">ChildCommand1</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd2"</span><span class="o">,</span>                 <span class="k">new</span> <span class="nc">ChildCommand2</span><span class="o">())</span>
    <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">ChildCommand3</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3sub1"</span><span class="o">,</span>                 <span class="k">new</span> <span class="nc">GrandChild3Command1</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3sub2"</span><span class="o">,</span>                 <span class="k">new</span> <span class="nc">GrandChild3Command2</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3sub3"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">GrandChild3Command3</span><span class="o">())</span>
            <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3sub3sub1"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GreatGrandChild3Command3_1</span><span class="o">())</span>
            <span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"cmd3sub3sub2"</span><span class="o">,</span> <span class="k">new</span> <span class="n">GreatGrandChild3Command3_2</span><span class="o">())</span>
        <span class="o">)</span>
    <span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MainCommand</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd1"</span><span class="p">,</span>             <span class="nc">ChildCommand1</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd2"</span><span class="p">,</span>             <span class="nc">ChildCommand2</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3"</span><span class="p">,</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">ChildCommand3</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3sub1"</span><span class="p">,</span>             <span class="nc">GrandChild3Command1</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3sub2"</span><span class="p">,</span>             <span class="nc">GrandChild3Command2</span><span class="p">())</span>
        <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3sub3"</span><span class="p">,</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">GrandChild3Command3</span><span class="p">())</span>
            <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3sub3sub1"</span><span class="p">,</span> <span class="nc">GreatGrandChild3Command3_1</span><span class="p">())</span>
            <span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"cmd3sub3sub2"</span><span class="p">,</span> <span class="nc">GreatGrandChild3Command3_2</span><span class="p">())</span>
        <span class="p">)</span>
    <span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the usage help message only shows the subcommands of the specified command,
and not the nested sub-subcommands. This can be customized by specifying your own <a href="#_reordering_sections"><code>IHelpSectionRenderer</code></a> for the command list section.
The <code>picocli-examples</code> module has an <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/customhelp/ShowCommandHierarchy.java">example</a> that shows how to accomplish this.</p>
</div>
<div class="paragraph">
<p>To get usage help for nested subcommands, either set <code>mixinStandardHelpOptions = true</code> in all commands in the hierarchy, and/or add <code>picocli.CommandLine.HelpCommand</code> to the subcommands of all commands. Then you can get help message for a nested (sub-)subcommand like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>main cmd3 cmd3sub3 cmd3sub3sub1 <span class="nt">--help</span>      <span class="c"># mixinStandardHelpOptions</span>
Usage: main cmd3 cmd3sub3 cmd3sub3sub1 <span class="o">[</span><span class="nt">-hV</span><span class="o">]</span> <span class="o">[</span><span class="nt">-y</span><span class="o">=</span>&lt;y&gt;] ...
...
<span class="nv">$ </span>main cmd3 cmd3sub3 <span class="nb">help </span>cmd3sub3sub1        <span class="c"># HelpCommand</span>
Usage: main cmd3 cmd3sub3 cmd3sub3sub1 <span class="o">[</span><span class="nt">-y</span><span class="o">=</span>&lt;y&gt;] ... <span class="o">[</span>COMMAND]
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_repeatable_subcommands"><a class="anchor" href="#_repeatable_subcommands"></a>17.13. Repeatable Subcommands</h3>
<div class="paragraph">
<p>From picocli 4.2, it is possible to specify that a command&#8217;s subcommands can be specified multiple times by marking it with <code>@Command(subcommandsRepeatable = true)</code>.</p>
</div>
<div class="sect3">
<h4 id="_example_4"><a class="anchor" href="#_example_4"></a>17.13.1. Example</h4>
<div class="paragraph">
<p>Below is an example where the top-level command <code>myapp</code> is marked as <code>subcommandsRepeatable = true</code>.
This command has three subcommands, <code>add</code>, <code>list</code> and <code>send-report</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"myapp"</span><span class="o">,</span> <span class="n">subcommandsRepeatable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Command</span>
    <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">x</span><span class="o">,</span> <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-w"</span><span class="o">)</span> <span class="kt">double</span> <span class="n">w</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>

    <span class="nd">@Command</span>
    <span class="kt">void</span> <span class="nf">list</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--where"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">where</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"send-report"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">sendReport</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--to"</span><span class="o">,</span> <span class="n">split</span> <span class="o">=</span> <span class="s">","</span><span class="o">)</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">recipients</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"myapp"</span><span class="p">,</span> <span class="n">subcommandsRepeatable</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">add</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="n">x</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-w"</span><span class="p">])</span> <span class="n">w</span><span class="p">:</span> <span class="nc">Double</span><span class="p">)</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">list</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--where"</span><span class="p">])</span> <span class="k">where</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

    <span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"send-report"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">sendReport</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--to"</span><span class="p">],</span> <span class="n">split</span> <span class="p">=</span> <span class="s">","</span><span class="p">)</span> <span class="n">recipients</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example command allows users to specify one or more of its subcommands multiple time. For example, this would be a valid invocation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">myapp add <span class="nt">-x</span><span class="o">=</span>item1 <span class="nt">-w</span><span class="o">=</span>0.2 <span class="se">\</span>
      add <span class="nt">-x</span><span class="o">=</span>item2 <span class="nt">-w</span><span class="o">=</span>0.5 <span class="se">\</span>
      add <span class="nt">-x</span><span class="o">=</span>item3 <span class="nt">-w</span><span class="o">=</span>0.7 <span class="se">\</span>
      list <span class="nt">--where</span> <span class="s2">"w&gt;0.2"</span> <span class="se">\</span>
      send-report <span class="nt">--to</span><span class="o">=</span>recipient@myorg.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above command line invocation, the <code>myapp</code> top-level command is followed by its subcommand <code>add</code>.
Next, this is followed by another two occurences of <code>add</code>, followed by <code>list</code> and <code>send-report</code>.
These are all "sibling" commands, that share the same parent command <code>myapp</code>.
This invocation is valid because <code>myapp</code> is marked with <code>subcommandsRepeatable = true</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_repeatable_subcommands_specification"><a class="anchor" href="#_repeatable_subcommands_specification"></a>17.13.2. Repeatable Subcommands Specification</h4>
<div class="paragraph">
<p>Normally, <code>subcommandsRepeatable</code> is <code>false</code>, so for each command, only one of its subcommands can be specified, potentially followed by only one sub-subcommand of that subcommand, etc.
In mathematical terms, a valid sequence of commands and subcommands can be represented by a <em>directed rooted tree</em> that starts at the top-level command. This is illustrated by the diagram below.</p>
</div>
<div id="sequences-when-subcommands-not-repeatable" class="imageblock">
<div class="content">
<img src="images/subcommands-non-repeatable.png" alt="subcommands non repeatable">
</div>
<div class="title">Figure 1. By default, valid sequences of commands and subcommands form a directed rooted tree.</div>
</div>
<div class="paragraph">
<p>When <code>subcommandsRepeatable</code> is set to <code>true</code> on a command, the subcommands of this command may appear multiple times.
Also, a subcommand can be followed by a "sibling" command (another command with the same parent command).</p>
</div>
<div class="paragraph">
<p>In mathematical terms, when a parent command has this property, the additional valid sequences of its subcommands form a fully connected subgraph (<em>a complete digraph</em>).</p>
</div>
<div class="paragraph">
<p>The blue and green dotted arrows in the diagram below illustrate the additional sequences that are allowed when a command has repeatable subcommands.</p>
</div>
<div id="sequences-when-subcommands-repeatable" class="imageblock">
<div class="content">
<img src="images/subcommands-repeatable.png" alt="subcommands repeatable">
</div>
<div class="title">Figure 2. If a command is marked to allow repeatable subcommands, the additional valid sequences of its subcommands form a fully connected subgraph.</div>
</div>
<div class="paragraph">
<p>Note that it is not valid to specify a subcommand followed by its parent command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># invalid: cannot move _up_ the hierarchy</span>
myapp add <span class="nt">-x</span><span class="o">=</span>item1 <span class="nt">-w</span><span class="o">=</span>0.2 myapp</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_repeatable_subcommands_execution"><a class="anchor" href="#_repeatable_subcommands_execution"></a>17.13.3. Repeatable Subcommands Execution</h4>
<div class="paragraph">
<p>The default <a href="#_executing_commands_with_subcommands"><code>IExecutionStrategy</code></a> (<code>picocli.CommandLine.RunLast</code>) only executes the last subcommands <em>with the same parent</em>. For example, if</p>
</div>
<div class="listingblock">
<div class="content">
<pre>toplevelcmd subcmd-A subcmd-B subsub-B1 subsub-B2</pre>
</div>
</div>
<div class="paragraph">
<p>is invoked, only the last two sub-subcommands <code>subsub-B1</code> and <code>subsub-B2</code> (who both have parent command <code>subcmd-B</code>) are executed by default. You can <a href="https://picocli.info/apidocs/picocli/CommandLine.html#setExecutionStrategy-picocli.CommandLine.IExecutionStrategy-">set</a> a different <a href="https://picocli.info/apidocs/picocli/CommandLine.IExecutionStrategy.html">execution strategy</a> if this does not meet your needs.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage_help_for_subcommands"><a class="anchor" href="#_usage_help_for_subcommands"></a>17.14. Usage Help for Subcommands</h3>
<div class="paragraph">
<p>After registering subcommands, calling the <code>commandLine.usage</code> method will show a usage help message that includes all registered subcommands. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">());</span>

<span class="c1">// add subcommands programmatically (not necessary if the parent command</span>
<span class="c1">// declaratively registers the subcommands via annotation)</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitStatus</span><span class="o">());</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">addSubcommand</span><span class="o">(</span><span class="s">"commit"</span><span class="o">,</span>   <span class="k">new</span> <span class="nc">GitCommit</span><span class="o">());</span>
<span class="o">...</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Git</span><span class="p">())</span>

<span class="c1">// add subcommands programmatically (not necessary if the parent command</span>
<span class="c1">// declaratively registers the subcommands via annotation)</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span>   <span class="nc">GitStatus</span><span class="p">())</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">addSubcommand</span><span class="p">(</span><span class="s">"commit"</span><span class="p">,</span>   <span class="nc">GitCommit</span><span class="p">())</span>

<span class="n">commandLine</span><span class="p">.</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message shows the commands in the order they were registered:</p>
</div>
<div id="subcommand-help" class="listingblock">
<div class="content">
<pre>Usage: git [-hV] [--git-dir=&lt;gitDir&gt;] [COMMAND]
Git is a fast, scalable, distributed revision control system with an unusually
rich command set that provides both high-level operations and full access to
internals.
      --git-dir=&lt;gitDir&gt;   Set the path to the repository.
  -h, --help               Show this help message and exit.
  -V, --version            Print version information and exit.

Commands:

The most commonly used git commands are:
  help      Displays help information about the specified command
  status    Show the working tree status.
  commit    Record changes to the repository.
  add       Add file contents to the index.
  branch    List, create, or delete branches.
  checkout  Checkout a branch or paths to the working tree.
  clone     Clone a repository into a new directory.
  diff      Show changes between commits, commit and working tree, etc.
  merge     Join two or more development histories together.
  push      Update remote refs along with associated objects.
  rebase    Forward-port local commits to the updated upstream head.
  tag       Create, list, delete or verify a tag object signed with GPG.</pre>
</div>
</div>
<div class="paragraph">
<p>The description of each subcommand in the command list is taken from the subcommand&#8217;s first <code>header</code> line, or the first <code>description</code> line if it does not have a <code>header</code> defined.</p>
</div>
<div class="paragraph">
<p>The above usage help message is produced from the annotations on the class below:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">"subcommand demo - picocli 4.0"</span><span class="o">,</span>
        <span class="n">subcommands</span> <span class="o">=</span> <span class="nc">HelpCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"Git is a fast, scalable, distributed revision control "</span> <span class="o">+</span>
                      <span class="s">"system with an unusually rich command set that provides both "</span> <span class="o">+</span>
                      <span class="s">"high-level operations and full access to internals."</span><span class="o">,</span>
        <span class="n">commandListHeading</span> <span class="o">=</span> <span class="s">"%nCommands:%n%nThe most commonly used git commands are:%n"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--git-dir"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Set the path to the repository."</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">File</span> <span class="n">gitDir</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"git"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
        <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"subcommand demo - picocli 4.0"</span><span class="p">],</span>
        <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">HelpCommand</span><span class="o">::</span><span class="k">class</span><span class="p">],</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Git is a fast, scalable, distributed revision control "</span> <span class="p">+</span>
                       <span class="s">"system with an unusually rich command set that provides both "</span> <span class="p">+</span>
                       <span class="s">"high-level operations and full access to internals."</span><span class="p">],</span>
        <span class="n">commandListHeading</span> <span class="p">=</span> <span class="s">"%nCommands:%n%nThe most commonly used git commands are:%n"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--git-dir"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Set the path to the repository."</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">gitDir</span><span class="p">:</span> <span class="nc">File</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example uses the <a href="#_mixin_standard_help_options">mixinStandardHelpOptions</a> attribute to mix in
<a href="#_help_options"><code>usageHelp</code></a> and <a href="#_help_options"><code>versionHelp</code></a> options and registers the <code>help</code> subcommand.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the <code>@Spec</code> annotation for subcommands that need to show the usage help message explicitly.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From picocli 3.1, the usage help synopsis of the subcommand shows not only the subcommand name but also the parent command name.
For example, if the <code>git</code> command has a <code>commit</code> subcommand, the usage help for the <code>commit</code> subcommand shows <code>Usage: git commit &lt;options&gt;</code>.</p>
</div>
<div class="paragraph">
<p>If a subcommand explicitly wants to show the usage help message, the <code>@Spec</code> annotation may be useful.
The injected <code>CommandSpec</code> has its parent command initialized correctly, so the usage help can show the fully qualified name of the subcommand.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"commit"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"..."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Commit</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shouldShowHelp</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">().</span><span class="na">usage</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"commit"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"..."</span><span class="p">]</span> <span class="p">)</span>
<span class="kd">class</span> <span class="nc">Commit</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Spec</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">shouldShowHelp</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">().</span><span class="nf">usage</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, see <a href="#_section_headings">Section Headings</a> for an example subcommand (<code>git commit</code>), which produces the help message shown
in <a href="#_expanded_example">Expanded Example</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hidden_subcommands"><a class="anchor" href="#_hidden_subcommands"></a>17.15. Hidden Subcommands</h3>
<div class="paragraph">
<p>Commands with the <code>hidden</code> attribute set to <code>true</code> will not be shown in the usage help message of their parent command.</p>
</div>
<div class="paragraph">
<p>For example, the <code>bar</code> subcommand below is annotated as <code>hidden = true</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"foo"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"This is a visible subcommand"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span> <span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"bar"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"This is a hidden subcommand"</span><span class="o">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Bar</span> <span class="o">{</span> <span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"app"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span><span class="nc">Foo</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Bar</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"This is a visible subcommand"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="p">{</span> <span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"bar"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"This is a hidden subcommand"</span><span class="p">],</span> <span class="n">hidden</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Bar</span> <span class="p">{</span> <span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"app"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Foo</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="nc">Bar</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help message for <code>App</code> looks like the below. Note that the <code>bar</code> subcommand is not shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: app [COMMAND]
Commands:
  foo  This is a visible subcommand</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_help_subcommands"><a class="anchor" href="#_help_subcommands"></a>17.16. Help Subcommands</h3>
<div class="paragraph">
<p>Commands with the <code>helpCommand</code> attribute set to <code>true</code> are treated as help commands.
When picocli encounters a help command on the command line, required options and required positional parameters of the parent command
are not validated (similar to <a href="#_help_options">help options</a>).</p>
</div>
<div class="paragraph">
<p>See <a href="#_custom_help_subcommands">Custom Help Subcommands</a> for more details on creating help subcommands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">helpCommand</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_required_subcommands"><a class="anchor" href="#_required_subcommands"></a>17.17. Required Subcommands</h3>
<div class="paragraph">
<p>For some command suites, it does not make sense to invoke the top-level command by itself, and the user is required to specify a subcommand.</p>
</div>
<div class="paragraph">
<p>From version 4.3, picocli makes it easy to accomplish this: simply use the <a href="#_executing_subcommands"><code>execute</code> method</a> to start your application, and make the top-level command a class that does not implement <code>Runnable</code> or <code>Callable</code>.</p>
</div>
<div class="paragraph">
<p>Then, when the user specifies only the top-level command, without a subcommand, while this top-level command does not implement <code>Runnable</code> or <code>Callable</code>, picocli internally throws a <code>ParameterException</code> with the error message <code>"Missing required subcommand"</code>. This will cause the <a href="#_invalid_user_input"><code>IParameterExceptionHandler</code></a> to be called, which will display this message to the user.</p>
</div>
<div class="paragraph">
<p>Prior to picocli 4.3, applications could indicate that subcommands are required by letting the top-level command throw a <code>ParameterException</code>. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git"</span><span class="o">,</span> <span class="n">synopsisSubcommandLabel</span> <span class="o">=</span> <span class="s">"COMMAND"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span> <span class="o">...</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span> <span class="s">"Missing required subcommand"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"git"</span><span class="p">,</span> <span class="n">synopsisSubcommandLabel</span> <span class="p">=</span> <span class="s">"COMMAND"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span> <span class="o">..</span><span class="p">.</span> <span class="p">])</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Spec</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nc">ParameterException</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span> <span class="s">"Missing required subcommand"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Git</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the synopsis of a command with subcommands shows a trailing <code>[COMMAND]</code>, indicating that a subcommand can optionally be specified.
To show that the subcommand is mandatory, use the <code>synopsisSubcommandLabel</code> attribute to replace this string with <code>COMMAND</code> (without the <code>[</code> and <code>]</code> brackets).</p>
</div>
</div>
<div class="sect2">
<h3 id="_subcommands_and_default_values"><a class="anchor" href="#_subcommands_and_default_values"></a>17.18. Subcommands and default values</h3>
<div class="paragraph">
<p>There are some scenarios where picocli can not parse an option with a default value which is the same as a subcommand name. To work around this, you can parse the option yourself using <a href="#_custom_parameter_processing"><code>IParameterConsumer</code></a>. A simple implementation is shown below. See <a href="https://github.com/remkop/picocli/issues/1428">this issue</a> for more details.</p>
</div>
<div class="listingblock primary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyParameterConsumer</span> <span class="p">:</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">IParameterConsumer</span> <span class="p">{</span>
  <span class="k">override</span> <span class="k">fun</span> <span class="nf">consumeParameters</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="nc">Stack</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span>
    <span class="n">argSpec</span><span class="p">:</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">Model</span><span class="p">.</span><span class="nc">ArgSpec</span><span class="p">,</span>
    <span class="n">commandSpec</span><span class="p">:</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">Model</span><span class="p">.</span><span class="nc">CommandSpec</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">ParameterException</span><span class="p">(</span>
        <span class="n">commandSpec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span>
        <span class="s">"Missing required parameter for option "</span> <span class="p">+</span>
            <span class="p">(</span><span class="n">argSpec</span> <span class="k">as</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">Model</span><span class="p">.</span><span class="nc">OptionSpec</span><span class="p">).</span><span class="nf">longestName</span><span class="p">()</span>
      <span class="p">)</span>
    <span class="p">}</span>
    <span class="n">argSpec</span><span class="p">.</span><span class="nf">setValue</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nf">pop</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reuse"><a class="anchor" href="#_reuse"></a>18. Reuse</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You may find yourself defining the same options, parameters or command attributes in many command line applications.
To reduce duplication, picocli supports two ways to reuse such options and attributes: subclassing and mixins.</p>
</div>
<div class="sect2">
<h3 id="_subclassing"><a class="anchor" href="#_subclassing"></a>18.1. Subclassing</h3>
<div class="paragraph">
<p>One way to reuse options and attributes is to extend the class where they are defined.
Picocli will walk the class hierarchy to check for annotations, so <code>@Options</code>, <code>@Parameters</code> and <code>@Command</code> attributes declared on a superclass are available in all subclasses.</p>
</div>
<div class="paragraph">
<p>Below is an example class, <code>ReusableOptions</code>, that defines some usage help attributes and a <code>--verbose</code> option that we want to reuse.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">synopsisHeading</span>      <span class="o">=</span> <span class="s">"%nUsage:%n%n"</span><span class="o">,</span>
         <span class="n">descriptionHeading</span>   <span class="o">=</span> <span class="s">"%nDescription:%n%n"</span><span class="o">,</span>
         <span class="n">parameterListHeading</span> <span class="o">=</span> <span class="s">"%nParameters:%n%n"</span><span class="o">,</span>
         <span class="n">optionListHeading</span>    <span class="o">=</span> <span class="s">"%nOptions:%n%n"</span><span class="o">,</span>
         <span class="n">commandListHeading</span>   <span class="o">=</span> <span class="s">"%nCommands:%n%n"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReusableOptions</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span> <span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="o">,</span>
            <span class="s">"For example, `-v -v -v` or `-vvv`"</span> <span class="o">})</span>
    <span class="kd">protected</span> <span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">synopsisHeading</span>      <span class="p">=</span> <span class="s">"%nUsage:%n%n"</span><span class="p">,</span>
         <span class="n">descriptionHeading</span>   <span class="p">=</span> <span class="s">"%nDescription:%n%n"</span><span class="p">,</span>
         <span class="n">parameterListHeading</span> <span class="p">=</span> <span class="s">"%nParameters:%n%n"</span><span class="p">,</span>
         <span class="n">optionListHeading</span>    <span class="p">=</span> <span class="s">"%nOptions:%n%n"</span><span class="p">,</span>
         <span class="n">commandListHeading</span>   <span class="p">=</span> <span class="s">"%nCommands:%n%n"</span><span class="p">)</span>
<span class="k">public</span> <span class="k">open</span> <span class="kd">class</span> <span class="nc">ReusableOptions</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span>
            <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="p">,</span>
            <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="p">])</span>
    <span class="k">protected</span> <span class="kd">var</span> <span class="py">verbosity</span> <span class="p">=</span> <span class="nc">BooleanArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, any command defined in a class that extends <code>ReusableOptions</code> will inherit the <code>--verbose</code> option, and generate a usage help message in the same spacious style. Example code:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"zip"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example reuse by subclassing"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCommand</span> <span class="kd">extends</span> <span class="nc">ReusableOptions</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"zip"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example reuse by subclassing"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyCommand</span> <span class="p">:</span> <span class="nc">ReusableOptions</span><span class="p">(),</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixins"><a class="anchor" href="#_mixins"></a>18.2. Mixins</h3>
<div class="paragraph">
<p>Picocli 3.0 introduced the concept of "mixins".
Mixins allow reuse without subclassing:
picocli annotations from <em>any</em> class can be added to ("mixed in" with) a command.
Picocli&#8217;s <a href="#_mixin_standard_help_options">mixinStandardHelpOptions</a> internally uses a mixin.</p>
</div>
<div class="paragraph">
<p>A mixin is a separate class with options, positional parameters, subcommands and command attributes that you want to reuse in one or more other commands.
A command receiving these mixed-in options, positional parameters, and command attributes is called the "mixee".</p>
</div>
<div class="paragraph">
<p>Mixins can be installed declaratively with a <code>@Mixin</code>-annotated field (or a <code>@Mixin</code>-annotated method parameter for command methods).
Alternatively, mixins can be installed programmatically by calling the <code>CommandLine.addMixin</code> method with an instance of the mixin class.</p>
</div>
<div class="paragraph">
<p>The examples below again use the sample <code>ReusableOptions</code> class as the mixin:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">synopsisHeading</span>      <span class="o">=</span> <span class="s">"%nUsage:%n%n"</span><span class="o">,</span>
         <span class="n">descriptionHeading</span>   <span class="o">=</span> <span class="s">"%nDescription:%n%n"</span><span class="o">,</span>
         <span class="n">parameterListHeading</span> <span class="o">=</span> <span class="s">"%nParameters:%n%n"</span><span class="o">,</span>
         <span class="n">optionListHeading</span>    <span class="o">=</span> <span class="s">"%nOptions:%n%n"</span><span class="o">,</span>
         <span class="n">commandListHeading</span>   <span class="o">=</span> <span class="s">"%nCommands:%n%n"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReusableOptions</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span> <span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="o">,</span>
            <span class="s">"For example, `-v -v -v` or `-vvv`"</span> <span class="o">})</span>
    <span class="kd">protected</span> <span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">synopsisHeading</span>      <span class="p">=</span> <span class="s">"%nUsage:%n%n"</span><span class="p">,</span>
         <span class="n">descriptionHeading</span>   <span class="p">=</span> <span class="s">"%nDescription:%n%n"</span><span class="p">,</span>
         <span class="n">parameterListHeading</span> <span class="p">=</span> <span class="s">"%nParameters:%n%n"</span><span class="p">,</span>
         <span class="n">optionListHeading</span>    <span class="p">=</span> <span class="s">"%nOptions:%n%n"</span><span class="p">,</span>
         <span class="n">commandListHeading</span>   <span class="p">=</span> <span class="s">"%nCommands:%n%n"</span><span class="p">)</span>
<span class="k">open</span> <span class="kd">class</span> <span class="nc">ReusableOptions</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span>
            <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="p">,</span>
            <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="p">])</span>
    <span class="k">protected</span> <span class="kd">var</span> <span class="py">verbosity</span> <span class="p">=</span> <span class="nc">BooleanArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="mixin-annotation"><a class="anchor" href="#mixin-annotation"></a>18.2.1. <code>@Mixin</code> Annotation</h4>
<div class="paragraph">
<p>A command defined in a class can include a mixin by annotating a field with <code>@Mixin</code>.
Similarly, a <a href="#_subcommands_as_methods"><code>@Command</code>-annotated method</a> can include a mixin by declaring a <code>@Mixin</code>-annotated method parameter.
All picocli annotations found in the mixin class are added to the command (the "mixee").
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"zip"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Example reuse with @Mixin annotation."</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCommand</span> <span class="o">{</span>

    <span class="c1">// adds the options defined in ReusableOptions to this command</span>
    <span class="nd">@Mixin</span>
    <span class="kd">private</span> <span class="nc">ReusableOptions</span> <span class="n">myMixin</span><span class="o">;</span>

    <span class="nd">@Command</span>
    <span class="kt">void</span> <span class="nf">subcmd</span><span class="o">(</span><span class="nd">@Mixin</span> <span class="nc">ReusableOptions</span> <span class="n">opts</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ...</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"zip"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Example reuse with @Mixin annotation."</span><span class="p">])</span>
<span class="k">public</span> <span class="kd">class</span> <span class="nc">MyCommand</span> <span class="p">{</span>

    <span class="c1">// adds the options defined in ReusableOptions to this command</span>
    <span class="nd">@Mixin</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">myMixin</span><span class="p">:</span> <span class="nc">ReusableOptions</span>

    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">subcmd</span><span class="p">(</span><span class="nd">@Mixin</span> <span class="n">opts</span><span class="p">:</span> <span class="nc">ReusableOptions</span><span class="p">)</span> <span class="p">:</span> <span class="nc">Unit</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to adding the options, subcommands and command attributes of the mixed-in object to the command,
the mixed-in object is also injected into the field annotated with <code>@Mixin</code>, making it trivial for the command to reference the mixed-in object if necessary.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">MyCommand</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyCommand</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">cmd</span><span class="o">).</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-vvv"</span><span class="o">);</span>

<span class="c1">// the options defined in ReusableOptions have been added to the `MyCommand` command</span>
<span class="k">assert</span> <span class="n">cmd</span><span class="o">.</span><span class="na">myMixin</span><span class="o">.</span><span class="na">verbosity</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">3</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">MyCommand</span><span class="p">()</span>
<span class="nc">CommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">).</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-vvv"</span><span class="p">)</span>

<span class="c1">// the options defined in ReusableOptions have been added to the `MyCommand` command</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">myMixin</span><span class="p">.</span><span class="n">verbosity</span><span class="p">.</span><span class="n">size</span> <span class="p">==</span> <span class="mi">3</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Mixins added with the <code>@Mixin</code> annotation can also be accessed via the map returned by <code>CommandLine.getMixins</code>.</p>
</div>
<div class="paragraph">
<p>The GitHub project has a <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/mixin">full working example</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mixin_example_logger"><a class="anchor" href="#_mixin_example_logger"></a>18.2.2. Mixin Example: Logger</h4>
<div class="paragraph">
<p>Here is an example mixin class <code>MyLogger</code>.
It has an option <code>-v</code> that can be specified multiple times to increase verbosity.
The <code>MyLogger</code> class also provides some methods like <code>debug</code> and <code>trace</code> that can be used to print messages to the standard error stream.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyLogger</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span><span class="o">},</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">"Increase verbosity. Specify multiple times to increase (-vvv)."</span><span class="o">)</span>
    <span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">info</span><span class="o">(</span><span class="nc">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">pattern</span><span class="o">,</span> <span class="n">params</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">debug</span><span class="o">(</span><span class="nc">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">pattern</span><span class="o">,</span> <span class="n">params</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">trace</span><span class="o">(</span><span class="nc">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">pattern</span><span class="o">,</span> <span class="n">params</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="kt">int</span> <span class="n">level</span><span class="o">,</span> <span class="nc">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">verbosity</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">level</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="n">pattern</span><span class="o">,</span> <span class="n">params</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyLogger</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">],</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Increase verbosity. Specify multiple times to increase (-vvv)."</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">verbosity</span> <span class="p">=</span> <span class="nc">BooleanArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">fun</span> <span class="nf">info</span><span class="p">(</span><span class="n">pattern</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="k">vararg</span> <span class="n">params</span><span class="p">:</span> <span class="nc">Any</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">log</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="p">*</span><span class="n">params</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">debug</span><span class="p">(</span><span class="n">pattern</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="k">vararg</span> <span class="n">params</span><span class="p">:</span> <span class="nc">Any</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="p">*</span><span class="n">params</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">trace</span><span class="p">(</span><span class="n">pattern</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="k">vararg</span> <span class="n">params</span><span class="p">:</span> <span class="nc">Any</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="p">*</span><span class="n">params</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">level</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="k">vararg</span> <span class="n">params</span><span class="p">:</span> <span class="nc">Any</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">verbosity</span><span class="p">.</span><span class="n">size</span> <span class="p">&gt;</span> <span class="n">level</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">System</span><span class="p">.</span><span class="n">err</span><span class="p">.</span><span class="nf">printf</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">*</span><span class="n">params</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An application could use the mixin like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Mixin</span> <span class="nc">MyLogger</span> <span class="n">myLogger</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">myLogger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello info%n"</span><span class="o">);</span>
        <span class="n">myLogger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Hello debug%n"</span><span class="o">);</span>
        <span class="n">myLogger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Hello trace%n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="nd">@Mixin</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">myLogger</span><span class="p">:</span> <span class="nc">MyLogger</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">myLogger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"Hello info%n"</span><span class="p">)</span>
        <span class="n">myLogger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Hello debug%n"</span><span class="p">)</span>
        <span class="n">myLogger</span><span class="p">.</span><span class="nf">trace</span><span class="p">(</span><span class="s">"Hello trace%n"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_accessing_the_mixee_from_a_mixin"><a class="anchor" href="#_accessing_the_mixee_from_a_mixin"></a>18.2.3. Accessing the Mixee from a Mixin</h4>
<div class="paragraph">
<p>Sometimes you need to write a Mixin class that accesses the mixee (the command where it is mixed in).</p>
</div>
<div class="paragraph">
<p>From picocli 4.3, this can be accomplished with the <a href="#spec-annotation"><code>@Spec(Spec.Target.MIXEE)</code> annotation</a>.</p>
</div>
<div class="paragraph">
<p>By default, the <code>CommandSpec</code> of the enclosing class is injected into a <code>@Spec</code>-annotated field, but when <code>MIXEE</code> is specified in a mixin class, the <code>CommandSpec</code> of the command <em>receiving</em> this mixin (the "mixee") is injected.
This can be useful when a mixin contains logic that is common to many commands.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">AdvancedMixin</span> <span class="o">{</span>
    <span class="nd">@Spec</span><span class="o">(</span><span class="nc">Spec</span><span class="o">.</span><span class="na">Target</span><span class="o">.</span><span class="na">MIXEE</span><span class="o">)</span> <span class="nc">CommandSpec</span> <span class="n">mixee</span><span class="o">;</span>

    <span class="cm">/**
     * When the -x option is specified on any subcommand,
     * multiply its value with another integer supplied by this subcommand
     * and set the result on the top-level command.
     * @param x the value of the -x option
     */</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// get another value from the command we are mixed into</span>
        <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="o">((</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">function</span><span class="o">.</span><span class="na">IntSupplier</span><span class="o">)</span> <span class="n">mixee</span><span class="o">.</span><span class="na">userObject</span><span class="o">()).</span><span class="na">getAsInt</span><span class="o">();</span>

        <span class="kt">int</span> <span class="n">product</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">;</span>

        <span class="c1">// set the result on the top-level (root) command</span>
        <span class="o">((</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">function</span><span class="o">.</span><span class="na">IntConsumer</span><span class="o">)</span> <span class="n">mixee</span><span class="o">.</span><span class="na">root</span><span class="o">().</span><span class="na">userObject</span><span class="o">()).</span><span class="na">accept</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">java.util.function.IntConsumer</span>
<span class="k">import</span> <span class="nn">java.util.function.IntSupplier</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">AdvancedMixin</span> <span class="p">{</span>
    <span class="nd">@Spec</span><span class="p">(</span><span class="nc">Spec</span><span class="p">.</span><span class="nc">Target</span><span class="p">.</span><span class="nc">MIXEE</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">mixee</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="cm">/**
     * When the -x option is specified on any subcommand,
     * multiply its value with another integer supplied by this subcommand
     * and set the result on the top-level command.
     * @param x the value of the -x option
     */</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">setValue</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// get another value from the command we are mixed into</span>
        <span class="kd">val</span> <span class="py">y</span> <span class="p">=</span> <span class="p">(</span><span class="n">mixee</span><span class="p">.</span><span class="nf">userObject</span><span class="p">()</span> <span class="k">as</span> <span class="nc">IntSupplier</span><span class="p">).</span><span class="n">asInt</span>

        <span class="kd">val</span> <span class="py">product</span> <span class="p">=</span> <span class="n">x</span> <span class="p">*</span> <span class="n">y</span>

        <span class="c1">// set the result on the top-level (root) command</span>
        <span class="p">(</span><span class="n">mixee</span><span class="p">.</span><span class="nf">root</span><span class="p">().</span><span class="nf">userObject</span><span class="p">()</span> <span class="k">as</span> <span class="nc">IntConsumer</span><span class="p">).</span><span class="nf">accept</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_accessing_the_parent_command_from_a_mixin"><a class="anchor" href="#_accessing_the_parent_command_from_a_mixin"></a>18.2.4. Accessing the Parent Command from a Mixin</h4>
<div class="paragraph">
<p>Since picocli 4.2, <a href="#parentcommand-annotation"><code>@ParentCommand</code>-annotated</a> fields can be used in mixins.
This injects a reference to the parent command of the mixee into the mixin.
Here is an example implementation:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// Define a mixin that delegates to the parent command.</span>
<span class="kd">class</span> <span class="nc">MyMixin</span> <span class="o">{</span>
    <span class="nd">@ParentCommand</span> <span class="nc">Top</span> <span class="n">top</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVerbose</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">verbose</span><span class="o">)</span> <span class="o">{</span> <span class="n">top</span><span class="o">.</span><span class="na">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// An example Top-level command with a subcommand.</span>
<span class="c1">// The `-v` option can be specified on the top-level command as well as its subcommands.</span>
<span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="nc">Sub</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Top</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span><span class="o">})</span>
    <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verbose</span><span class="o">(</span><span class="nc">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">verbose</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="n">pattern</span><span class="o">,</span> <span class="n">params</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="n">verbose</span><span class="o">(</span><span class="s">"Hello from top%n"</span><span class="o">);</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Top</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Subcommand classes can mix in the `-v` option with a @Mixin-annotated field.</span>
<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"sub"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="kd">implements</span> <span class="nc">Runnable</span><span class="o">{</span>
    <span class="nd">@Mixin</span> <span class="nc">MyMixin</span> <span class="n">mymixin</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="n">mymixin</span><span class="o">.</span><span class="na">top</span><span class="o">.</span><span class="na">verbose</span><span class="o">(</span><span class="s">"Hello from sub%n"</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="c1">// Define a mixin that delegates to the parent command.</span>
<span class="kd">class</span> <span class="nc">MyMixin</span> <span class="p">{</span>
    <span class="nd">@ParentCommand</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">top</span><span class="p">:</span> <span class="nc">Top</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">setVerbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span> <span class="n">top</span><span class="p">.</span><span class="n">verbose</span> <span class="p">=</span> <span class="n">verbose</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// An example Top-level command with a subcommand.</span>
<span class="c1">// The `-v` option can be specified on the top-level command as well as its subcommands.</span>
<span class="nd">@Command</span><span class="p">(</span><span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Sub</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Top</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">verbose</span> <span class="p">=</span> <span class="k">false</span>

    <span class="k">fun</span> <span class="nf">verbose</span><span class="p">(</span><span class="n">pattern</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="k">vararg</span> <span class="n">params</span><span class="p">:</span> <span class="nc">Any</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="nf">printf</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">*</span><span class="n">params</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="nf">verbose</span><span class="p">(</span><span class="s">"Hello from top%n"</span><span class="p">)</span> <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Top</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Subcommand classes can mix in the `-v` option with a @Mixin-annotated field.</span>
<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"sub"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Mixin</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">mymixin</span><span class="p">:</span> <span class="nc">MyMixin</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="n">mymixin</span><span class="p">.</span><span class="n">top</span><span class="p">.</span><span class="nf">verbose</span><span class="p">(</span><span class="s">"Hello from sub%n"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, the <code>-v</code> option can be specified on the top-level command as well as its subcommands, so all of the below are valid invocations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java Top -v
java Top -v sub
java Top sub -v</pre>
</div>
</div>
<div class="paragraph">
<p>All of these invocations will print some output, since the <code>-v</code> option was specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="_adding_mixins_programmatically"><a class="anchor" href="#_adding_mixins_programmatically"></a>18.2.5. Adding Mixins Programmatically</h4>
<div class="paragraph">
<p>The below example shows how a mixin can be added programmatically with the <code>CommandLine.addMixin</code> method.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyCommand</span><span class="o">());</span>

<span class="nc">ReusableOptions</span> <span class="n">mixin</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReusableOptions</span><span class="o">();</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">addMixin</span><span class="o">(</span><span class="s">"myMixin"</span><span class="o">,</span> <span class="n">mixin</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyCommand</span><span class="p">())</span>

<span class="kd">val</span> <span class="py">mixin</span> <span class="p">=</span> <span class="nc">ReusableOptions</span><span class="p">()</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">addMixin</span><span class="p">(</span><span class="s">"myMixin"</span><span class="p">,</span> <span class="n">mixin</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Programmatically added mixins can be accessed via the map returned by <code>CommandLine.getMixins</code>. Continuing from the previous example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="n">commandLine</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-vvv"</span><span class="o">);</span>

<span class="c1">// the options defined in ReusableOptions have been added to the zip command</span>
<span class="k">assert</span> <span class="n">mixin</span> <span class="o">==</span> <span class="n">commandLine</span><span class="o">.</span><span class="na">getMixins</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"myMixin"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">mixin</span><span class="o">.</span><span class="na">verbosity</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">3</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-vvv"</span><span class="p">)</span>

<span class="c1">// the options defined in ReusableOptions have been added to the zip command</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">mixin</span> <span class="p">===</span> <span class="n">commandLine</span><span class="p">.</span><span class="n">mixins</span><span class="p">[</span><span class="s">"myMixin"</span><span class="p">])</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">mixin</span><span class="p">.</span><span class="n">verbosity</span><span class="p">.</span><span class="n">size</span> <span class="p">==</span> <span class="mi">3</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inherited_scope"><a class="anchor" href="#_inherited_scope"></a>18.3. Inherited Scope</h3>
<div class="paragraph">
<p>A third reuse mechanism is setting <code>scope = ScopeType.INHERIT</code>.</p>
</div>
<div class="paragraph">
<p>When <code>scope = INHERIT</code> is used in the <code>@Command</code> annotation, all <code>@Command</code> attributes, except the command name and its subcommands, are copied to the subcommands.
See <a href="#_inherited_command_attributes">Inherited Command Attributes</a> for details.</p>
</div>
<div class="paragraph">
<p>When <code>scope = INHERIT</code> is used in the <code>@Option</code> annotation, that option is copied to the subcommands.
See <a href="#_inherited_options">Inherited Options</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_case_configure_log_level_with_a_global_option"><a class="anchor" href="#_use_case_configure_log_level_with_a_global_option"></a>18.4. Use Case: Configure Log Level with a Global Option</h3>
<div class="paragraph">
<p>This section shows a detailed example demonstrating Mixins.</p>
</div>
<div class="paragraph">
<p>For mixins that need to be reusable across more than two levels in the command hierarchy,
declaring a <a href="#spec-annotation"><code>@Spec(MIXEE)</code>-annotated</a> field gives the mixin access to the full command hierarchy.</p>
</div>
<div class="paragraph">
<p>The <code>MIXEE</code> value indicates that the <code>CommandSpec</code> to inject is not the spec of the enclosing class, but the spec of the command where the <code>@Mixin</code> is used.</p>
</div>
<div class="paragraph">
<p>The example below shows a class that uses Log4j for logging, and has a "global" option <code>--verbose</code> that can be specified on any command to allow users to configure the Log4j log level.
The <code>@Spec(MIXEE)</code>-annotated field allows the mixin to climb the command hierarchy and store the "verbosity" value in a single place.
When the application is started, a custom execution strategy is used to configure the log level from that single value.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.logging.log4j.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.core.config.Configurator</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Model.CommandSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">Spec</span><span class="o">.</span><span class="na">Target</span><span class="o">.</span><span class="na">MIXEE</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">LoggingMixin</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nd">@Spec</span><span class="o">(</span><span class="no">MIXEE</span><span class="o">)</span> <span class="nc">CommandSpec</span> <span class="n">mixee</span><span class="o">;</span> <span class="c1">// spec of the command where the @Mixin is used</span>

    <span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>

    <span class="cm">/**
     * Sets the specified verbosity on the LoggingMixin of the top-level command.
     * @param verbosity the new verbosity value
     */</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="o">,</span>
            <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVerbose</span><span class="o">(</span><span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbosity</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Each subcommand that mixes in the LoggingMixin has its own instance</span>
        <span class="c1">// of this class, so there may be many LoggingMixin instances.</span>
        <span class="c1">// We want to store the verbosity value in a single, central place,</span>
        <span class="c1">// so we find the top-level command,</span>
        <span class="c1">// and store the verbosity level on our top-level command's LoggingMixin.</span>
        <span class="o">((</span><span class="nc">MyApp</span><span class="o">)</span> <span class="n">mixee</span><span class="o">.</span><span class="na">root</span><span class="o">().</span><span class="na">userObject</span><span class="o">()).</span><span class="na">loggingMixin</span><span class="o">.</span><span class="na">verbosity</span> <span class="o">=</span> <span class="n">verbosity</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"app"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="nc">Sub</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">MyApp</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Mixin</span> <span class="nc">LoggingMixin</span> <span class="n">loggingMixin</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Starting... (trace) from app"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Starting... (debug) from app"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span> <span class="o">(</span><span class="s">"Starting... (info)  from app"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span> <span class="o">(</span><span class="s">"Starting... (warn)  from app"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">Level</span> <span class="nf">calcLogLevel</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">loggingMixin</span><span class="o">.</span><span class="na">verbosity</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="k">return</span> <span class="nc">Level</span><span class="o">.</span><span class="na">WARN</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>  <span class="k">return</span> <span class="nc">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>  <span class="k">return</span> <span class="nc">Level</span><span class="o">.</span><span class="na">DEBUG</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="nc">Level</span><span class="o">.</span><span class="na">TRACE</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first configures Log4j based on the specified verbosity level,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">executionStrategy</span><span class="o">(</span><span class="nc">ParseResult</span> <span class="n">parseResult</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Configurator</span><span class="o">.</span><span class="na">setRootLevel</span><span class="o">(</span><span class="n">calcLogLevel</span><span class="o">());</span> <span class="c1">// configure log4j</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">RunLast</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="n">parseResult</span><span class="o">);</span> <span class="c1">// default execution strategy</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">MyApp</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyApp</span><span class="o">();</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setExecutionStrategy</span><span class="o">(</span><span class="nl">app:</span><span class="o">:</span><span class="n">executionStrategy</span><span class="o">)</span>
                <span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"sub"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">();</span>

    <span class="nd">@Mixin</span> <span class="nc">LoggingMixin</span> <span class="n">loggingMixin</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Hi (tracing)   from app sub"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Hi (debugging) from app sub"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span> <span class="o">(</span><span class="s">"Hi (info)      from app sub"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span> <span class="o">(</span><span class="s">"Hi (warning)   from app sub"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Command</span>
    <span class="kt">void</span> <span class="nf">subsubmethod</span><span class="o">(</span><span class="nd">@Mixin</span> <span class="nc">LoggingMixin</span> <span class="n">loggingMixin</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Hi (tracing)   from app sub subsubmethod"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Hi (debugging) from app sub subsubmethod"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span> <span class="o">(</span><span class="s">"Hi (info)      from app sub subsubmethod"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span> <span class="o">(</span><span class="s">"Hi (warning)   from app sub subsubmethod"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">org.apache.logging.log4j.*</span>
<span class="k">import</span> <span class="nn">org.apache.logging.log4j.core.config.Configurator</span>

<span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.*</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Model.CommandSpec</span>

<span class="kd">class</span> <span class="nc">LoggingMixin</span> <span class="p">{</span>
    <span class="nd">@Spec</span><span class="p">(</span><span class="nc">Spec</span><span class="p">.</span><span class="nc">Target</span><span class="p">.</span><span class="nc">MIXEE</span><span class="p">)</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">mixee</span><span class="p">:</span> <span class="nc">CommandSpec</span><span class="c1">// spec of the command where the @Mixin is used</span>
    <span class="kd">var</span> <span class="py">verbosity</span> <span class="p">=</span> <span class="nc">BooleanArray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="cm">/**
     * Sets the specified verbosity on the LoggingMixin of the top-level command.
     * @param verbosity the new verbosity value
     */</span>
    <span class="nd">@Option</span><span class="p">(</span>
        <span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span>
                 <span class="s">"Specify multiple -v options to increase verbosity."</span><span class="p">,</span>
                 <span class="s">"For example, `-v -v -v` or `-vvv`"</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">fun</span> <span class="nf">setVerbose</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nc">BooleanArray</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Each subcommand that mixes in the LoggingMixin has its own instance</span>
        <span class="c1">// of this class, so there may be many LoggingMixin instances.</span>
        <span class="c1">// We want to store the verbosity value in a single, central place,</span>
        <span class="c1">// so we find the top-level command,</span>
        <span class="c1">// and store the verbosity level on our top-level command's LoggingMixin.</span>
        <span class="p">(</span><span class="n">mixee</span><span class="p">.</span><span class="nf">root</span><span class="p">().</span><span class="nf">userObject</span><span class="p">()</span> <span class="k">as</span> <span class="nc">MyApp</span><span class="p">).</span><span class="n">loggingMixin</span><span class="p">.</span><span class="n">verbosity</span> <span class="p">=</span> <span class="n">verbosity</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"app"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">Sub</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Mixin</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">loggingMixin</span><span class="p">:</span> <span class="nc">LoggingMixin</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">trace</span><span class="p">(</span><span class="s">"Starting... (trace) from app"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Starting... (debug) from app"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span> <span class="p">(</span><span class="s">"Starting... (info)  from app"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">warn</span> <span class="p">(</span><span class="s">"Starting... (warn)  from app"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">calcLogLevel</span><span class="p">():</span> <span class="nc">Level</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">when</span> <span class="p">(</span><span class="n">loggingMixin</span><span class="p">.</span><span class="n">verbosity</span><span class="p">.</span><span class="n">size</span><span class="p">)</span> <span class="p">{</span>
            <span class="mi">0</span> <span class="p">-&gt;</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">WARN</span>
            <span class="mi">1</span> <span class="p">-&gt;</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">INFO</span>
            <span class="mi">2</span> <span class="p">-&gt;</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">DEBUG</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="nc">Level</span><span class="p">.</span><span class="nc">TRACE</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// A reference to this method can be used as a custom execution strategy</span>
    <span class="c1">// that first configures Log4j based on the specified verbosity level,</span>
    <span class="c1">// and then delegates to the default execution strategy.</span>
    <span class="k">private</span> <span class="k">fun</span> <span class="nf">executionStrategy</span><span class="p">(</span><span class="n">parseResult</span><span class="p">:</span> <span class="nc">ParseResult</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="nc">Configurator</span><span class="p">.</span><span class="nf">setRootLevel</span><span class="p">(</span><span class="nf">calcLogLevel</span><span class="p">())</span> <span class="c1">// configure log4j</span>
        <span class="k">return</span> <span class="nc">RunLast</span><span class="p">().</span><span class="nf">execute</span><span class="p">(</span><span class="n">parseResult</span><span class="p">)</span> <span class="c1">// default execution strategy</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kd">val</span> <span class="py">logger</span><span class="p">:</span> <span class="nc">Logger</span> <span class="p">=</span> <span class="nc">LogManager</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="nc">MyApp</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>
        <span class="nd">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">MyApp</span><span class="p">()</span>
            <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">setExecutionStrategy</span> <span class="p">{</span> <span class="n">parseResult</span><span class="p">:</span> <span class="nc">ParseResult</span> <span class="p">-&gt;</span> <span class="n">app</span><span class="p">.</span><span class="nf">executionStrategy</span><span class="p">(</span><span class="n">parseResult</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"sub"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Sub</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Mixin</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">loggingMixin</span><span class="p">:</span> <span class="nc">LoggingMixin</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">logger</span><span class="p">:</span> <span class="nc">Logger</span> <span class="p">=</span> <span class="nc">LogManager</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">trace</span><span class="p">(</span><span class="s">"Hi (tracing)   from app sub"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Hi (debugging) from app sub"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span> <span class="p">(</span><span class="s">"Hi (info)      from app sub"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">warn</span> <span class="p">(</span><span class="s">"Hi (warning)   from app sub"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">subsubmethod</span><span class="p">(</span><span class="nd">@Mixin</span> <span class="n">loggingMixin</span><span class="p">:</span> <span class="nc">LoggingMixin</span><span class="p">?)</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">trace</span><span class="p">(</span><span class="s">"Hi (tracing)   from app sub subsubmethod"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Hi (debugging) from app sub subsubmethod"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span> <span class="p">(</span><span class="s">"Hi (info)      from app sub subsubmethod"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">warn</span> <span class="p">(</span><span class="s">"Hi (warning)   from app sub subsubmethod"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, the <code>-v</code> option can be specified on the top-level command as well as the subcommands, so all of the below are valid invocations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java MyApp -v
java MyApp -v sub
java MyApp sub -v subsubmethod
java MyApp sub subsubmethod -vv</pre>
</div>
</div>
<div class="paragraph">
<p>See also the <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/java/picocli/examples/logging_mixin_advanced">logging</a> example in <code>picocli-examples</code> for a way to modify only the Log4j ConsoleAppenders' log level from the specified verbosity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sharing_options_in_subcommands"><a class="anchor" href="#_sharing_options_in_subcommands"></a>18.5. Sharing Options in Subcommands</h3>
<div class="paragraph">
<p>The above use case can also be accomplished (with less code) via <a href="#_inherited_options">Inherited Options</a>.
Inherited options are another reuse mechanism where an application defines an option on one command, after which end users can specify this option on any of the subcommands, and it will set the value of the annotated field on the parent command.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reuse_combinations"><a class="anchor" href="#_reuse_combinations"></a>18.6. Reuse Combinations</h3>
<div class="paragraph">
<p>The above mechanisms can be combined in any way. Mixins can be nested, and there is no limitation to how deeply mixins can be nested. A mixin may also inherit options, positional parameters and command attributes from a super class.</p>
</div>
<div class="paragraph">
<p>An option with the same name should not be defined multiple times or a <code>DuplicateOptionAnnotationsException</code> is thrown during initialization. Positional parameters for the same position may be defined multiple times, they can co-exist.</p>
</div>
<div class="paragraph">
<p>Command attributes may be defined multiple times, but only one value is preserved. In case a command attribute is defined multiple times, the definition earlier in the following list takes priority over later in the list:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>@Command attributes of the command itself</p>
</li>
<li>
<p>Attributes on the @Mixin commands</p>
</li>
<li>
<p>Attributes on a @Mixin nested in a @Mixin of the command</p>
</li>
<li>
<p>Attributes on superclass of nested @Mixin</p>
</li>
<li>
<p>Attributes on superclass of @Mixin</p>
</li>
<li>
<p>Attributes on superclass of the command</p>
</li>
<li>
<p>Attributes on programmatically added mixins</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internationalization"><a class="anchor" href="#_internationalization"></a>19. Internationalization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of version 3.6, usage help message sections and the description for options and positional parameters can be specified in a resource bundle.
A resource bundle can be set via annotations and programmatically.</p>
</div>
<div class="paragraph">
<p>In order to get you started quickly, the <a href="https://github.com/remkop/picocli/blob/master/picocli-examples"><code>picocli-examples</code></a> module has a minimal i18n example, coded both in <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/i18n/I18NDemo.java">Java</a> and <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin/i18n/I18NDemo.kt">Kotlin</a>.</p>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>19.1. Configuration</h3>
<div class="paragraph">
<p>Annotation example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"i18n-demo"</span><span class="o">,</span> <span class="n">resourceBundle</span> <span class="o">=</span> <span class="s">"my.org.I18nDemo_Messages"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">I18nDemo</span> <span class="o">{}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Programmatic example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span> <span class="kd">class</span> <span class="nc">I18nDemo2</span> <span class="o">{}</span>

<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">I18nDemo2</span><span class="o">());</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">setResourceBundle</span><span class="o">(</span><span class="nc">ResourceBundle</span><span class="o">.</span><span class="na">getBundle</span><span class="o">(</span><span class="s">"my.org.I18nDemo2_Messages"</span><span class="o">));</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span> <span class="kd">class</span> <span class="nc">I18nDemo2</span> <span class="p">{}</span>

<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">I18nDemo2</span><span class="p">())</span>
<span class="n">cmd</span><span class="p">.</span><span class="n">resourceBundle</span> <span class="p">=</span> <span class="nc">ResourceBundle</span><span class="p">.</span><span class="nf">getBundle</span><span class="p">(</span><span class="s">"my.org.I18nDemo2_Messages"</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_resource_bundle"><a class="anchor" href="#_example_resource_bundle"></a>19.2. Example Resource Bundle</h3>
<div class="paragraph">
<p>Example properties resource bundle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code># Usage Help Message Sections
# ---------------------------
# Numbered resource keys can be used to create multi-line sections.
usage.headerHeading = This is my app. It does stuff. Good stuff.%n
usage.header   = header first line
usage.header.0 = header second line
usage.descriptionHeading = Description:%n
usage.description.0 = first line
usage.description.1 = second line
usage.description.2 = third line
usage.synopsisHeading = Usage:\u0020

# Leading whitespace is removed by default.
# Start with \u0020 to keep the leading whitespace.
usage.customSynopsis.0 =      Usage: ln [OPTION]... [-T] TARGET LINK_NAME   (1st form)
usage.customSynopsis.1 = \u0020 or:  ln [OPTION]... TARGET                  (2nd form)
usage.customSynopsis.2 = \u0020 or:  ln [OPTION]... TARGET... DIRECTORY     (3rd form)

# Headings can contain the %n character to create multi-line values.
usage.parameterListHeading = %nPositional parameters:%n
usage.optionListHeading = %nOptions:%n
usage.commandListHeading = %nCommands:%n
usage.footerHeading = Powered by picocli%n
usage.footer = footer

# Option Descriptions
# -------------------
# Use numbered keys to create multi-line descriptions.

# Example description for an option `@Option(names = "-x")`
x = This is the description for the -x option

# Example multi-line description for an option `@Option(names = "-y")`
y.0 = This is the first line of the description for the -y option
y.1 = This is the second line of the description for the -y option

# Example descriptions for the standard help mixin options:
help = Show this help message and exit.
version = Print version information and exit.

# Exit Code Description
# ---------------------
usage.exitCodeListHeading = Exit Codes:%n
usage.exitCodeList.0 = \u00200:Successful program execution. (notice leading space '\u0020')
usage.exitCodeList.1 = 64:Usage error: user input for the command was incorrect.
usage.exitCodeList.2 = 70:An exception occurred when invoking the business logic of this command.

# @file Description
# -----------------
picocli.atfile=One or more argument files containing options, commands and positional parameters.

# End-of-Options (--) Delimiter Description
# -----------------------------------------
picocli.endofoptions = Separates options from positional parameters.</code></pre>
</div>
</div>
<div class="paragraph">
<p>For options and positional parameters, the optional annotation attribute <code>descriptionKey</code> can be used to localize the description. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">descriptionKey</span> <span class="o">=</span> <span class="s">"xoption"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">descriptionKey</span> <span class="p">=</span> <span class="s">"xoption"</span><span class="p">)</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The matching entry in the resource bundle could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>xoption = This is the description for the -x option.</pre>
</div>
</div>
<div class="paragraph">
<p>When the <code>descriptionKey</code> is omitted, the <a href="https://picocli.info/apidocs/picocli/CommandLine.Option.html#descriptionKey--">fallback for options</a> is any option name without the leading dashes, for example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span><span class="o">})</span> <span class="kt">boolean</span><span class="o">[]</span> <span class="n">verbose</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">verbose</span><span class="p">:</span> <span class="nc">BooleanArray</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The matching entry in the resource bundle could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>verbose = Show more detail during execution. \
          May be specified multiple times for increasing verbosity.</pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://picocli.info/apidocs/picocli/CommandLine.Parameters.html#descriptionKey--">positional parameters</a> the fallback key is the <code>paramLabel + [ index ]</code>, for example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0..*"</span><span class="o">,</span> <span class="n">paramLabel</span><span class="o">=</span><span class="s">"FILES"</span><span class="o">)</span> <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0..*"</span><span class="p">,</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"FILES"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The matching entry in the resource bundle could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FILES[0..*] = The files to process.</pre>
</div>
</div>
<div class="paragraph">
<p>For argument groups, use the <code>headingKey</code> to specify a resource bundle key. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@ArgGroup</span><span class="o">(</span><span class="n">headingKey</span> <span class="o">=</span> <span class="s">"myBundleKey"</span><span class="o">)</span> <span class="nc">MyArgGroup</span> <span class="n">myGroup</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@ArgGroup</span><span class="p">(</span><span class="n">headingKey</span> <span class="p">=</span> <span class="s">"myBundleKey"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">myGroup</span><span class="p">:</span> <span class="nc">MyArgGroup</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The matching entry in the resource bundle could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>myBundleKey = The localized heading for this argument group%n</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the heading text should end with <code>%n</code> or the first option in the group will be on the same line.
This is to be consistent with other <a href="#_section_headings">section headings</a> in the usage help.</p>
</div>
</div>
<div class="sect2">
<h3 id="_shared_resource_bundles"><a class="anchor" href="#_shared_resource_bundles"></a>19.3. Shared Resource Bundles</h3>
<div class="paragraph">
<p>Resources for multiple commands can be specified in a single ResourceBundle. Keys and their value can be
shared by multiple commands (so you don&#8217;t need to repeat them for every command), but alternatively, keys can be prefixed with
<code>command name + "."</code> to specify different values for different commands.
The most specific key wins. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>jfrog.rt.usage.header = Artifactory commands
jfrog.rt.config.usage.header = Configure Artifactory details.
jfrog.rt.upload.usage.header = Upload files.

# shared between all commands
usage.footerHeading = Environment Variables:
usage.footer.0 = footer line 0
usage.footer.1 = footer line 1</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_localizing_the_built_in_help"><a class="anchor" href="#_localizing_the_built_in_help"></a>19.4. Localizing the Built-In Help</h3>
<div class="paragraph">
<p>The built-in <code>picocli.CommandLine.HelpCommand</code> can be localized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>help.usage.header</code> controls the help command summary in the subcommand list</p>
</li>
<li>
<p><code>helpCommand.help</code> is the resource bundle key for the <code>--help</code> option of the help subcommand</p>
</li>
<li>
<p><code>helpCommand.command</code> is the resource bundle key for the <code>COMMAND</code> positional parameter of the help subcommand</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code># for a specific subcommand, e.g., `parent help`
parent.help.usage.header=This is the `help` subcommand of the `parent` command
parent.help.helpCommand.help = Specialized description of --help option of help subcommand for parent command
parent.help.helpCommand.command = Specialized description of COMMAND parameter of help subcommand for parent command

# or have one global entry for the `help` subcommand (for any and all commands)
help.usage.header=This is the `help` subcommand
helpCommand.help = Shared description of --help option of built-in help subcommand
helpCommand.command = Shared description of COMMAND parameter of built-in help subcommand</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_localizing_default_values"><a class="anchor" href="#_localizing_default_values"></a>19.5. Localizing Default Values</h3>
<div class="paragraph">
<p>Options with a <a href="#_default_values">default value</a> can use the <code>${DEFAULT-VALUE}</code> variable in the localized option description in the resource bundle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>userName=Specify the user name. The default is ${DEFAULT-VALUE}.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controlling_the_locale"><a class="anchor" href="#_controlling_the_locale"></a>19.6. Controlling the locale</h3>
<div class="paragraph">
<p>In your localized application, it may be desirable to specify the locale in order to determine the language of message texts and help output.
One way of controlling the locale is to give <code>-Duser.language=desiredLocale</code> as VM argument when running the app.
A more accessible and user-friendly approach is to to implement a command line parameter (e. g. <code>--locale</code>) inside your app which can be used to change the locale.
The latter technique requires a two-phase approach to parsing in your application in order to get a valid load order.
The minimal example below demonstrates how to implement this two phase approach:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">InitLocale</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-l"</span><span class="o">,</span> <span class="s">"--locale"</span> <span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"locale for message texts (phase 1)"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">setLocale</span><span class="o">(</span><span class="nc">String</span> <span class="n">locale</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Locale</span><span class="o">.</span><span class="na">setDefault</span><span class="o">(</span><span class="k">new</span> <span class="nc">Locale</span><span class="o">(</span><span class="n">locale</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Unmatched</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">remainder</span><span class="o">;</span> <span class="c1">// ignore any other parameters and options in the first parsing phase</span>
<span class="o">}</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"GreetingApp"</span><span class="o">,</span> <span class="n">resourceBundle</span> <span class="o">=</span> <span class="s">"mybundle"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GreetingApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-l"</span><span class="o">,</span> <span class="s">"--locale"</span> <span class="o">},</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"&lt;locale&gt;"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ignored</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">arity</span> <span class="o">=</span> <span class="s">"1.."</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"&lt;name1&gt; &lt;name2&gt;"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">names</span><span class="o">;</span>

    <span class="nc">ResourceBundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="nc">ResourceBundle</span><span class="o">.</span><span class="na">getBundle</span><span class="o">(</span><span class="s">"mybundle"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// business logic here</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">names</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">MessageFormat</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">bundle</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">),</span> <span class="n">name</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// first phase: configure locale</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">InitLocale</span><span class="o">()).</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

        <span class="c1">// second phase: parse all args (ignoring --locale) and run the app</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">GreetingApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">InitLocale</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-l"</span><span class="p">,</span> <span class="s">"--locale"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"locale for message texts (phase 1)"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">setLocale</span><span class="p">(</span><span class="n">locale</span><span class="p">:</span> <span class="nc">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nc">Locale</span><span class="p">.</span><span class="nf">setDefault</span><span class="p">(</span><span class="nc">Locale</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="nd">@Unmatched</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">others</span> <span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="c1">// ignore other parameters/options in first parsing phase</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"GreetingApp"</span><span class="p">,</span> <span class="n">resourceBundle</span> <span class="p">=</span> <span class="s">"mybundle"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">GreetingApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-l"</span><span class="p">,</span> <span class="s">"--locale"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"&lt;locale&gt;"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">ignored</span><span class="p">:</span> <span class="nc">String</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">arity</span> <span class="p">=</span> <span class="s">"1.."</span><span class="p">,</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"&lt;name1&gt; &lt;name2&gt;"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">names</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>

    <span class="k">private</span> <span class="kd">var</span> <span class="py">bundle</span> <span class="p">=</span> <span class="nc">ResourceBundle</span><span class="p">.</span><span class="nf">getBundle</span><span class="p">(</span><span class="s">"mybundle"</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// business logic here</span>
        <span class="n">names</span><span class="p">.</span><span class="nf">onEach</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="nc">MessageFormat</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">bundle</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">),</span> <span class="n">it</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span>  <span class="p">{</span>
    <span class="c1">// first phase: configure locale</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="n">picocli</span><span class="p">.</span><span class="n">examples</span><span class="p">.</span><span class="n">kotlin</span><span class="p">.</span><span class="n">i18n</span><span class="p">.</span><span class="n">localecontrol</span><span class="p">.</span><span class="nc">InitLocale</span><span class="p">()).</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>

    <span class="c1">// second phase: parse all args (ignoring --locale) and run the app</span>
    <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">GreetingApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now put the default properties file (<code>mybundle.properties</code>, in English) and the Spanish language variant (<code>mybundle_es.properties</code>) in place:</p>
</div>
<div class="listingblock">
<div class="title">mybundle.properties</div>
<div class="content">
<pre>Hello = Hello {0}!</pre>
</div>
</div>
<div class="listingblock">
<div class="title">mybundle_es.properties</div>
<div class="content">
<pre>Hello = Â¡Hola {0}!</pre>
</div>
</div>
<div class="paragraph">
<p>Eventually, we are ready to run our application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java <span class="nt">-cp</span> <span class="s2">"picocli-4.6.2.jar;myapp.jar"</span> org.myorg.GreetingApp Sarah Lea</code></pre>
</div>
</div>
<div class="paragraph">
<p>With no command line parameter <code>--locale</code> given, the message texts are printed in the default language (here: English):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Hello Sarah!
Hello Lea!</pre>
</div>
</div>
<div class="paragraph">
<p>In order to control the locale choosen for our output, we have to make use of the command line parameter <code>--locale</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java <span class="nt">-cp</span> <span class="s2">"picocli-4.6.2.jar;myapp.jar"</span> org.myorg.GreetingApp <span class="nt">--locale</span><span class="o">=</span>es Sarah Lea</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now our message texts are printed in Spanish:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Â¡Hola Sarah!
Â¡Hola Lea!</pre>
</div>
</div>
<div class="paragraph">
<p>Using the command line parameter <code>--locale</code>, one can also determine the language of the help output of your application.
The <a href="https://github.com/remkop/picocli/blob/master/picocli-examples"><code>picocli-examples</code></a> module has examples with fully implemented, localized help output, coded both in <a href="https://github.com/remkop/picocli/blob/master/picocli-examples/src/main/java/picocli/examples/i18n/localecontrol/LocaleControl.java">Java</a> and <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin/i18n/localecontrol/LocaleControl.kt">Kotlin</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variable_interpolation"><a class="anchor" href="#_variable_interpolation"></a>20. Variable Interpolation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of version 4.0, picocli supports variable interpolation (variable expansion) in annotation attributes as well as in text attributes of the programmatic API.</p>
</div>
<div class="sect2">
<h3 id="_variable_interpolation_example"><a class="anchor" href="#_variable_interpolation_example"></a>20.1. Variable Interpolation Example</h3>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s">"This command logs the ${COMMAND-NAME} for ${PARENT-COMMAND-NAME}."</span><span class="o">,</span>
         <span class="n">version</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Versioned Command 1.0"</span><span class="o">,</span>
            <span class="s">"Picocli "</span> <span class="o">+</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.</span><span class="na">VERSION</span><span class="o">,</span>
            <span class="s">"JVM: ${java.version} (${java.vendor} ${java.vm.name} ${java.vm.version})"</span><span class="o">,</span>
            <span class="s">"OS: ${os.name} ${os.version} ${os.arch}"</span><span class="o">})</span>
<span class="kd">class</span> <span class="nc">Status</span> <span class="o">{</span>
    <span class="c1">// -d or --directories</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"${dirOptionName1:--d}"</span><span class="o">,</span> <span class="s">"${dirOptionName2:---directories}"</span><span class="o">},</span>
            <span class="n">description</span> <span class="o">=</span> <span class="o">{</span><span class="s">"Specify one or more directories, "</span> <span class="o">+</span>
                               <span class="s">"separated by '${sys:path.separator}'."</span><span class="o">,</span>
                           <span class="s">"The default is the user home directory (${DEFAULT-VALUE})."</span><span class="o">},</span>
            <span class="n">arity</span> <span class="o">=</span> <span class="s">"${sys:dirOptionArity:-1..*}"</span><span class="o">,</span>
            <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"${sys:user.home}"</span><span class="o">,</span>
            <span class="n">split</span> <span class="o">=</span> <span class="s">"${sys:path.separator}"</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">directories</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"status"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
         <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"This command logs the \${COMMAND-NAME} for \${PARENT-COMMAND-NAME}."</span><span class="p">],</span>
         <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Versioned Command 1.0"</span><span class="p">,</span>
                    <span class="s">"Picocli $VERSION"</span><span class="p">,</span>
                    <span class="s">"JVM: \${java.version} (\${java.vendor} \${java.vm.name} \${java.vm.version})"</span><span class="p">,</span>
                    <span class="s">"OS: \${os.name} \${os.version} \${os.arch}"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Status</span> <span class="p">{</span>
    <span class="c1">// -d or --directories</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"\${dirOptionName1:--d}"</span><span class="p">,</span> <span class="s">"\${dirOptionName2:---directories}"</span><span class="p">],</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Specify one or more directories, "</span> <span class="p">+</span>
                                <span class="s">"separated by '\${sys:path.separator}'."</span><span class="p">,</span>
                           <span class="s">"The default is the user home directory (\${DEFAULT-VALUE})."</span><span class="p">],</span>
        <span class="n">arity</span> <span class="p">=</span> <span class="s">"\${sys:dirOptionArity:-1..*}"</span><span class="p">,</span>
        <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"\${sys:user.home}"</span><span class="p">,</span>
        <span class="n">split</span> <span class="p">=</span> <span class="s">"\${sys:path.separator}"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">directories</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
In Kotlin, the dollar sign ($) has to be escaped with a backslash (\) in order to prevent Kotlin string interpolation to occur: <code>\${DEFAULT-VALUE}</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_predefined_variables"><a class="anchor" href="#_predefined_variables"></a>20.2. Predefined Variables</h3>
<div class="paragraph">
<p>The following variables are predefined:</p>
</div>
<table class="tableblock frame-all grid-cols stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col style="width: 30%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-middle">Since</th>
<th class="tableblock halign-left valign-top">Use in</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${DEFAULT-VALUE}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the description for an option or positional parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the <a href="#defaultValue-annotation">default value</a> for that option or positional parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${FALLBACK-VALUE}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the description for an option with optional parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the <a href="#fallbackValue-annotation">fallback value</a> for that option or positional parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${MAP-FALLBACK-VALUE}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the description for map option or positional parameter that allows key-only parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the <a href="#_key_only_map_parameters">map fallback value</a> for that option or positional parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${COMPLETION-CANDIDATES}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the description for an option or positional parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the completion candidates for that option or positional parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${COMMAND-NAME}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any section of the usage help message for a command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the name of the command</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${COMMAND-FULL-NAME}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any section of the usage help message for a command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the fully qualified name of the command (that is, preceded by its parent fully qualified name)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${PARENT-COMMAND-NAME}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any section of the usage help message for a command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the name of its parent command</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${PARENT-COMMAND-FULL-NAME}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any section of the usage help message for a command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the fully qualified name of its parent command (that is, preceded by the name(s) of the parent command&#8217;s ancestor commands)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${ROOT-COMMAND-NAME}</code></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any section of the usage help message for a command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replaced with the name of the top-level command (in a command suite with subcommands)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_custom_variables"><a class="anchor" href="#_custom_variables"></a>20.3. Custom Variables</h3>
<div class="paragraph">
<p>In addition, you can define your own variables. Currently the following syntaxes are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>${sys:key}</code>: system property lookup, replaced by the value of <code>System.getProperty("key")</code></p>
</li>
<li>
<p><code>${env:key}</code>: environment variable lookup, replaced by the value of <code>System.getEnv("key")</code></p>
</li>
<li>
<p><code>${bundle:key}</code>: look up the value of <code>key</code> in the resource bundle of the command</p>
</li>
<li>
<p><code>${key}</code>: search all of the above, first system properties, then environment variables, and finally the resource bundle of the command</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_default_values_for_custom_variables"><a class="anchor" href="#_default_values_for_custom_variables"></a>20.4. Default Values for Custom Variables</h3>
<div class="paragraph">
<p>You can specify a default value to use when no value is found for a custom variable. The syntax for specifying a default is <code>${a:-b}</code>, where <code>a</code> is the variable name and <code>b</code> is the default value to use if <code>a</code> is not found.</p>
</div>
<div class="paragraph">
<p>So, for the individual lookups, this looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>${key:-defaultValue}
${sys:key:-defaultValue}
${env:key:-defaultValue}
${bundle:key:-defaultValue}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default value may contain other custom variables. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>${bundle:a:-${env:b:-${sys:c:-X}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above variable is expanded as follows. First, try to find key <code>a</code> in the command&#8217;s resource bundle. If <code>a</code> is not found in the resource bundle, get the value of environment variable <code>b</code>. If no environment variable <code>b</code> exists, get the value of system property <code>c</code>. Finally, no system property <code>c</code> exists, the value of the expression becomes <code>X</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_escaping_variables"><a class="anchor" href="#_escaping_variables"></a>20.5. Escaping Variables</h3>
<div class="paragraph">
<p>Sometimes you want to show a string like <code>"${VAR}"</code> in a description.
A <code>$</code> character can be escaped with another <code>$</code> character. Therefore, <code>$${VAR}</code> will not be interpreted as a <code>VAR</code> variable, but will be replaced by <code>${VAR}</code> instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_switching_off_variable_interpolation"><a class="anchor" href="#_switching_off_variable_interpolation"></a>20.6. Switching Off Variable Interpolation</h3>
<div class="paragraph">
<p>Variable interpolation can be switched off for the full command hierarchy by calling <code>CommandLine.setInterpolateVariables(false)</code>, or for a particular command by calling <code>CommandSpec.interpolateVariables(false)</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limitations_of_variable_interpolation"><a class="anchor" href="#_limitations_of_variable_interpolation"></a>20.7. Limitations of Variable Interpolation</h3>
<div class="paragraph">
<p>Some attribute values need to be resolved early, when the model is constructed from the annotation values.</p>
</div>
<div class="paragraph">
<p>Specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>command names and aliases, option names, mixin names</p>
</li>
<li>
<p><code>arity</code> (for options and positional parameters)</p>
</li>
<li>
<p><code>index</code> (for positional parameters)</p>
</li>
<li>
<p><code>separator</code> (for commands)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible for these attributes to contain variables, but be aware of the limitations.</p>
</div>
<div class="paragraph">
<p>If these attributes have variables, and the variables get a different value after the model is constructed, the change will not be reflected in the model.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tips_tricks"><a class="anchor" href="#_tips_tricks"></a>21. Tips &amp; Tricks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_programmatic_api"><a class="anchor" href="#_programmatic_api"></a>21.1. Programmatic API</h3>
<div class="paragraph">
<p>Picocli also provides a <a href="picocli-programmatic-api.html">programmatic API</a>, in addition to the annotations API.</p>
</div>
<div class="paragraph">
<p>The programmatic API allows applications to dynamically create command line options on the fly, where not all options are known in advance.
It also makes it possible to use picocli in other JVM languages that do not support annotations.</p>
</div>
<div class="paragraph">
<p>Another use case is creating idiomatic domain-specific languages for processing command line arguments.
For example, Groovy&#8217;s <a href="http://groovy-lang.org/dsls.html#_clibuilder">CliBuilder DSL</a> is implemented using picocli&#8217;s programmatic API.</p>
</div>
</div>
<div class="sect2">
<h3 id="option-parameters-methods"><a class="anchor" href="#option-parameters-methods"></a>21.2. <code>@Option</code> and <code>@Parameters</code> Methods</h3>
<div class="paragraph">
<p>As of version 3.2, <code>@Option</code> and <code>@Parameters</code> annotations can be added to methods as well as fields of a class.</p>
</div>
<div class="paragraph">
<p>For concrete classes, annotate "setter" methods (methods that accept a parameter) and when the option is specified on the command line, picocli will invoke the method with the value specified on the command line, converted to the type of the method parameter.</p>
</div>
<div class="paragraph">
<p>Alternatively, you may annotate "getter-like" methods (methods that return a value) on an interface, and picocli will create an instance of the interface that returns the values specified on the command line, converted to the method return type.</p>
</div>
<div class="sect3">
<h4 id="_annotating_methods_of_an_interface"><a class="anchor" href="#_annotating_methods_of_an_interface"></a>21.2.1. Annotating Methods of an Interface</h4>
<div class="paragraph">
<p>The <code>@Option</code> and <code>@Parameters</code> annotations can be used on methods of an interface that return a value. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">interface</span> <span class="nc">Counter</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--count"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="nf">getCount</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">interface</span> <span class="nc">Counter</span> <span class="p">{</span>
    <span class="err">@</span><span class="k">get</span><span class="p">:</span><span class="nc">Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--count"</span><span class="p">])</span>
    <span class="kd">val</span> <span class="py">count</span><span class="p">:</span> <span class="nc">Int</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You use it by specifying the class of the interface:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="nc">Counter</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// specify a class</span>
<span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]</span> <span class="o">{</span><span class="s">"--count"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">};</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="nc">Counter</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getCommand</span><span class="o">();</span> <span class="c1">// picocli created an instance</span>
<span class="k">assert</span> <span class="n">counter</span><span class="o">.</span><span class="na">getCount</span><span class="o">()</span> <span class="o">==</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">// method returns command line value</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Counter</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="c1">// specify a class</span>
<span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"--count"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">counter</span><span class="p">:</span> <span class="nc">Counter</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">getCommand</span><span class="p">()</span> <span class="c1">// picocli created an instance</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">counter</span><span class="p">.</span><span class="n">count</span><span class="p">)</span> <span class="c1">// method returns command line value</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_annotating_methods_of_a_concrete_class"><a class="anchor" href="#_annotating_methods_of_a_concrete_class"></a>21.2.2. Annotating Methods of a Concrete Class</h4>
<div class="paragraph">
<p>The <code>@Option</code> and <code>@Parameters</code> annotations can be used on methods of a class that accept a parameter. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Counter</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--count"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">setCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Counter</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="nd">@JvmName</span><span class="p">(</span><span class="s">"setCount1"</span><span class="p">)</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--count"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">setCount</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">count</span> <span class="p">=</span> <span class="n">count</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You use it by passing an instance of the class:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">Counter</span> <span class="n">counter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Counter</span><span class="o">();</span> <span class="c1">// the instance to populate</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">counter</span><span class="o">);</span>
<span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]</span> <span class="o">{</span><span class="s">"--count"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">};</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">counter</span><span class="o">.</span><span class="na">count</span> <span class="o">==</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">// method was invoked with command line value</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">counter</span> <span class="p">=</span> <span class="nc">Counter</span><span class="p">()</span> <span class="c1">// the instance to populate</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"--count"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span>
<span class="n">cmd</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">counter</span><span class="p">.</span><span class="n">count</span><span class="p">)</span> <span class="c1">// method was invoked with command line value</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Methods annotated with <code>@Option</code> and <code>@Parameters</code> can do simple input validation by throwing a <code>ParameterException</code> when invalid values are specified on the command line.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ValidationExample</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;&gt;();</span>

    <span class="nd">@Spec</span> <span class="kd">private</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span> <span class="c1">// injected by picocli</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-D"</span><span class="o">,</span> <span class="s">"--property"</span><span class="o">},</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"KEY=VALUE"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setProperty</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">key</span> <span class="o">:</span> <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">newValue</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
            <span class="n">validateUnique</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">newValue</span><span class="o">);</span>
            <span class="n">properties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">newValue</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateUnique</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">newValue</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">existing</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">existing</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">existing</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">newValue</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParameterException</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">(),</span>
                    <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Duplicate key '%s' for values '%s' and '%s'."</span><span class="o">,</span>
                    <span class="n">key</span><span class="o">,</span> <span class="n">existing</span><span class="o">,</span> <span class="n">newValue</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">// ...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">ValidationExample</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">properties</span><span class="p">:</span> <span class="nc">MutableMap</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="err">?</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">LinkedHashMap</span><span class="p">()</span>

    <span class="nd">@Spec</span> <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span> <span class="p">:</span> <span class="nc">CommandSpec</span> <span class="c1">// injected by picocli</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-D"</span><span class="p">,</span> <span class="s">"--property"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"KEY=VALUE"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">setProperty</span><span class="p">(</span><span class="n">map</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span> <span class="k">in</span> <span class="n">map</span><span class="p">.</span><span class="n">keys</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">newValue</span> <span class="p">=</span> <span class="n">map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="nf">validateUnique</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">newValue</span><span class="p">)</span>
            <span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">=</span> <span class="n">newValue</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">validateUnique</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">newValue</span><span class="p">:</span> <span class="nc">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">existing</span> <span class="p">=</span> <span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">existing</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">existing</span> <span class="p">!=</span> <span class="n">newValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">ParameterException</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">(),</span>
                <span class="s">"Duplicate key '$key' for values '$existing' and '$newValue'."</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="command-methods"><a class="anchor" href="#command-methods"></a>21.3. <a id="_command-methods"></a> <code>@Command</code> Methods</h3>
<div class="paragraph">
<p>As of picocli 3.6, methods can be annotated with <code>@Command</code>.
The method parameters provide the command options and parameters. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Method</span> <span class="n">doit</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">getCommandMethods</span><span class="o">(</span><span class="nc">Cat</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"cat"</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">doit</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Concatenate FILE(s) to standard output."</span><span class="o">,</span>
             <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"4.1.3"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">cat</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-E"</span><span class="o">,</span> <span class="s">"--show-ends"</span><span class="o">})</span> <span class="kt">boolean</span> <span class="n">showEnds</span><span class="o">,</span>
             <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-n"</span><span class="o">,</span> <span class="s">"--number"</span><span class="o">})</span> <span class="kt">boolean</span> <span class="n">number</span><span class="o">,</span>
             <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-T"</span><span class="o">,</span> <span class="s">"--show-tabs"</span><span class="o">})</span> <span class="kt">boolean</span> <span class="n">showTabs</span><span class="o">,</span>
             <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-v"</span><span class="o">,</span> <span class="s">"--show-nonprinting"</span><span class="o">})</span> <span class="kt">boolean</span> <span class="n">showNonPrinting</span><span class="o">,</span>
             <span class="nd">@Parameters</span><span class="o">(</span><span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"FILE"</span><span class="o">)</span> <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// process files</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Cat</span> <span class="p">{</span>
    <span class="nd">@Command</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Concatenate FILE(s) to standard output."</span><span class="p">],</span>
             <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"4.1.3"</span><span class="p">])</span>
    <span class="k">fun</span> <span class="nf">cat</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-E"</span><span class="p">,</span> <span class="s">"--show-ends"</span><span class="p">])</span> <span class="n">showEnds</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
            <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-n"</span><span class="p">,</span> <span class="s">"--number"</span><span class="p">])</span> <span class="n">number</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
            <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-T"</span><span class="p">,</span> <span class="s">"--show-tabs"</span><span class="p">])</span> <span class="n">showTabs</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
            <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-v"</span><span class="p">,</span> <span class="s">"--show-nonprinting"</span><span class="p">])</span> <span class="n">showNonPrinting</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
            <span class="nd">@Parameters</span><span class="p">(</span><span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"FILE"</span><span class="p">)</span> <span class="n">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="p">&gt;?)</span> <span class="p">{</span>
        <span class="c1">// process files</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">doit</span><span class="p">:</span> <span class="nc">Method</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">getCommandMethods</span><span class="p">(</span><span class="nc">Cat</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="s">"cat"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">doit</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage help of the above command looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: cat [-EhnTvV] [FILE...]
Concatenate FILE(s) to standard output.
      [FILE...]
  -E, --show-ends
  -h, --help               Show this help message and exit.
  -n, --number
  -T, --show-tabs
  -v, --show-nonprinting
  -V, --version            Print version information and exit.</pre>
</div>
</div>
<div class="paragraph">
<p>See below for an example that uses a <a href="#_internationalization">resource bundle</a> to define usage help descriptions outside the code.</p>
</div>
<div class="paragraph">
<p>For positional parameters, the <code>@Parameters</code> annotation may be omitted on method parameters.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If compiled with the <code>-parameters</code> flag on Java 8 or higher, the <code>paramLabel</code> of positional parameters is obtained from the method parameter name using reflection instead of the generic arg0, arg1, etc.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_subcommand_methods"><a class="anchor" href="#_subcommand_methods"></a>21.3.1. Subcommand Methods</h4>
<div class="paragraph">
<p>If the enclosing class is annotated with <code>@Command</code>, method commands are automatically added as subcommands to the class command, unless the class command has attribute <code>@Command(addMethodSubcommands = false)</code>.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"picocli-4.1.3"</span><span class="o">,</span>
         <span class="n">resourceBundle</span> <span class="o">=</span> <span class="s">"Git_Messages"</span><span class="o">,</span> <span class="n">subcommands</span> <span class="o">=</span> <span class="o">{</span> <span class="nc">HelpCommand</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--git-dir"</span><span class="o">,</span> <span class="n">descriptionKey</span> <span class="o">=</span> <span class="s">"GITDIR"</span><span class="o">)</span>
    <span class="nc">Path</span> <span class="n">path</span><span class="o">;</span>

    <span class="nd">@Command</span>
    <span class="kt">void</span> <span class="nf">commit</span><span class="o">(</span><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-m"</span><span class="o">,</span> <span class="s">"--message"</span><span class="o">})</span> <span class="nc">String</span> <span class="n">commitMessage</span><span class="o">,</span>
                <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--squash"</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"&lt;commit&gt;"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">squash</span><span class="o">,</span>
                <span class="nd">@Parameters</span><span class="o">(</span><span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"&lt;file&gt;"</span><span class="o">)</span> <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ... implement business logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"git"</span><span class="p">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"picocli-4.1.3"</span><span class="p">],</span>
         <span class="n">resourceBundle</span> <span class="p">=</span> <span class="s">"Git_Messages"</span><span class="p">,</span> <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">HelpCommand</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">Git</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--git-dir"</span><span class="p">],</span> <span class="n">descriptionKey</span> <span class="p">=</span> <span class="s">"GITDIR"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">path</span><span class="p">:</span> <span class="nc">Path</span>

    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">commit</span><span class="p">(</span><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-m"</span><span class="p">,</span> <span class="s">"--message"</span><span class="p">])</span> <span class="n">commitMessage</span><span class="p">:</span> <span class="nc">String</span><span class="p">?,</span>
               <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--squash"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"&lt;commit&gt;"</span><span class="p">)</span> <span class="n">squash</span><span class="p">:</span> <span class="nc">String</span><span class="p">?,</span>
               <span class="nd">@Parameters</span><span class="p">(</span><span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"&lt;file&gt;"</span><span class="p">)</span> <span class="n">files</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">File</span><span class="err">?</span><span class="p">&gt;?)</span> <span class="p">{</span>
        <span class="c1">// ... implement business logic</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>@Command(addMethodSubcommands = false)</code> on the class <code>@Command</code> annotation if the <code>@Command</code>-annotated methods in this class should not be added as subcommands.</p>
</div>
</div>
<div class="sect3">
<h4 id="_description_text_in_resourcebundle"><a class="anchor" href="#_description_text_in_resourcebundle"></a>21.3.2. Description Text in ResourceBundle</h4>
<div class="paragraph">
<p>The usage help of the above <code>git commit</code> example command is very minimal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: git commit [--squash=&lt;commit&gt;] [-m=&lt;arg0&gt;] [&lt;file&gt;...]
      [&lt;file&gt;...]
      --squash=&lt;commit&gt;
  -m, --message=&lt;arg0&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>You can use a <a href="#_internationalization">resource bundle</a> to move the descriptions out of the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># shared between all commands
help = Show this help message and exit.
version = Print version information and exit.

# command-specific strings
git.usage.description = Version control system
git.GITDIR = Set the path to the repository

git.commit.usage.description = Record changes to the repository
git.commit.message = Use the given &lt;msg&gt; as the commit message.
git.commit.squash = Construct a commit message for use with rebase --autosquash.
git.commit.&lt;file&gt;[0..*] = The files to commit.</pre>
</div>
</div>
<div class="paragraph">
<p>With this resource bundle, the usage help for the <code>git commit</code> command looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage: git commit [--squash=&lt;commit&gt;] [-m=&lt;arg0&gt;] [&lt;file&gt;...]
Record changes to the repository
      [&lt;file&gt;...]         The files to commit.
      --squash=&lt;commit&gt;   Construct a commit message for use with rebase
                            --autosquash.
  -m, --message=&lt;arg0&gt;    Use the given &lt;msg&gt; as the commit message.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mixin_support_in_command_methods"><a class="anchor" href="#_mixin_support_in_command_methods"></a>21.3.3. Mixin Support in <code>@Command</code> Methods</h4>
<div class="paragraph">
<p>As of picocli 3.8, <code>@Command</code> methods accept <code>@Mixin</code> parameters.
All options and positional parameters defined in the mixin class are added to the command.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">CommonParams</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="nd">@Command</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doit</span><span class="o">(</span><span class="nd">@Mixin</span> <span class="nc">CommonParams</span> <span class="n">params</span><span class="o">,</span> <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-z"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">z</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">CommonParams</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">App</span> <span class="p">{</span>
    <span class="nd">@Command</span>
    <span class="k">fun</span> <span class="nf">doit</span><span class="p">(</span><span class="nd">@Mixin</span> <span class="n">params</span><span class="p">:</span> <span class="nc">CommonParams</span><span class="p">?,</span> <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-z"</span><span class="p">])</span> <span class="n">z</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the <code>-x</code> and <code>-y</code> options are added to the <code>-z</code>-option of the <code>doit</code> command.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spec-annotation"><a class="anchor" href="#spec-annotation"></a>21.4. <a id="_spec-annotation"></a> <code>@Spec</code> Annotation</h3>
<div class="paragraph">
<p>Picocli 3.2 introduces a <code>@Spec</code> annotation for injecting the <code>CommandSpec</code> model of the command into a command field.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
From picocli 4.6, <code>@Spec</code>-annotated elements can be used in <a href="#_argument_groups">ArgGroup classes</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is useful when a command needs to use the picocli API, for example to walk the command hierarchy and iterate over its sibling commands.
This complements the <code>@ParentCommand</code> annotation;  the <code>@ParentCommand</code> annotation injects a user-defined command object, whereas this annotation injects a picocli class.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">InjectSpecExample</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">;</span>
    <span class="c1">//...</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// do something with the injected spec</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"My full name is "</span> <span class="o">+</span> <span class="n">commandSpec</span><span class="o">.</span><span class="na">qualifiedName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">InjectSpecExample</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Spec</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">commandSpec</span><span class="p">:</span> <span class="nc">CommandSpec</span>
    <span class="c1">//...</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// do something with the injected spec</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"My full name is ${commandSpec.qualifiedName()}"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="spec-mixee-annotation"><a class="anchor" href="#spec-mixee-annotation"></a>21.4.1. <code>@Spec(MIXEE)</code> Annotation</h4>
<div class="paragraph">
<p>As of picocli 4.3, the <code>@Spec</code> annotation has a <code>value</code> element.
The value is <code>Spec.Target.SELF</code> by default, meaning that the <code>CommandSpec</code> of the enclosing class is injected into the <code>@Spec</code>-annotated field.</p>
</div>
<div class="paragraph">
<p>For classes that are used as a <a href="#_mixins">mixin</a>, there is another value that may be useful.
When <code>@Spec(Spec.Target.MIXEE)</code> is specified in a mixin class, the <code>CommandSpec</code> of the command <em>receiving</em> this mixin (the "mixee") is injected into the <code>@Spec</code>-annotated field.
This can be useful when a mixin contains logic that is common to many commands.
See <a href="#_accessing_the_mixee_from_a_mixin">Accessing the Mixee from a Mixin</a> for more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_factory"><a class="anchor" href="#_custom_factory"></a>21.5. Custom Factory</h3>
<div class="paragraph">
<p>Declaratively registered <a href="#_registering_subcommands_declaratively">subcommands</a>, <a href="#_option_specific_type_converters">type converters</a> and <a href="#_dynamic_version_information">version providers</a> must be instantiated somehow. As of picocli 2.2, a custom factory can be specified when constructing a <code>CommandLine</code> instance. This allows full control over object creation and opens possibilities for Inversion of Control and Dependency Injection (see <a href="#_dependency_injection">next section</a>). For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">IFactory</span> <span class="n">myFactory</span> <span class="o">=</span> <span class="n">getCustomFactory</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmdLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">Git</span><span class="o">(),</span> <span class="n">myFactory</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">myFactory</span><span class="p">:</span> <span class="nc">IFactory</span> <span class="p">=</span> <span class="nf">getCustomFactory</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmdLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">Git</span><span class="p">(),</span> <span class="n">myFactory</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Custom factories need to implement the <code>picocli.CommandLine.IFactory</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IFactory</span> <span class="o">{</span>
    <span class="cm">/**
     * Creates and returns an instance of the specified class.
     * @param clazz the class to instantiate
     * @param &lt;K&gt; the type to instantiate
     * @return the new instance
     * @throws Exception an exception detailing what went wrong when creating the instance
     */</span>
    <span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="no">K</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If no factory is specified, a default factory is used. The default factory requires that the classes to instantiate have a public no-argument constructor: it instantiates the class by calling first calling <code>clazz.newInstance()</code>, and if that fails, <code>clazz.getDeclaredConstructor().newInstance()</code>.</p>
</div>
<div class="paragraph">
<p>From version 4.0, picocli delegates all object creation to the factory, including creating <code>Collection</code> instances to capture <a href="#_arrays_and_collections">multi-value</a> <code>@Option</code> values.
Previously, <code>Collection</code> objects were instantiated separately without involving the factory.</p>
</div>
<div class="paragraph">
<p>It is recommended that custom factories should fall back to the default factory. Something like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="no">K</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">doCreate</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span> <span class="c1">// custom factory lookup or instantiation</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">defaultFactory</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span> <span class="c1">// fallback if missing</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">K</span> <span class="p">:</span> <span class="nc">Any</span><span class="p">&gt;</span> <span class="nf">create</span><span class="p">(</span><span class="n">clazz</span><span class="p">:</span> <span class="nc">Class</span><span class="p">&lt;</span><span class="nc">K</span><span class="p">&gt;):</span> <span class="nc">K</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">try</span> <span class="p">{</span>
        <span class="nf">doCreate</span><span class="p">(</span><span class="n">clazz</span><span class="p">)</span> <span class="c1">// custom factory lookup or instantiation</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="nc">Exception</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">defaultFactory</span><span class="p">().</span><span class="nf">create</span><span class="p">(</span><span class="n">clazz</span><span class="p">)</span> <span class="c1">// fallback if missing</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_model_transformations"><a class="anchor" href="#_model_transformations"></a>21.6. Model Transformations</h3>
<div class="paragraph">
<p>From picocli 4.6, it is possible to use the annotations API to modify the model (commands, options, subcommands, etc.) dynamically at runtime.
The <code>@Command</code> annotation now has a <code>modelTransformer</code> attribute where applications can specify a class that implements the <code>IModelTransformer</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">interface</span> <span class="nc">IModelTransformer</span> <span class="o">{</span>
    <span class="cm">/**
     * Given an original CommandSpec, return the object that should be used
     * instead. Implementors may modify the specified CommandSpec and return it,
     * or create a full or partial copy of the specified CommandSpec, and return
     * that, or even return a completely new CommandSpec.
     * &lt;p&gt;
     * Implementors are free to add or remove options, positional parameters,
     * subcommands or modify the command in any other way.
     * &lt;/p&gt;&lt;p&gt;
     * This method is called once, after the full command hierarchy is
     * constructed, and before any command line arguments are parsed.
     * &lt;/p&gt;
     * @return the CommandSpec to use instead of the specified one
     */</span>
    <span class="nc">CommandSpec</span> <span class="nf">transform</span><span class="o">(</span><span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows applications to dynamically add or remove options, positional parameters or subcommands, or modify the command in any other way, based on some runtime condition.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">modelTransformer</span> <span class="o">=</span> <span class="nc">Dynamic</span><span class="o">.</span><span class="na">SubCmdFilter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Dynamic</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SubCmdFilter</span> <span class="kd">implements</span> <span class="nc">IModelTransformer</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nc">CommandSpec</span> <span class="nf">transform</span><span class="o">(</span><span class="nc">CommandSpec</span> <span class="n">commandSpec</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="nc">Boolean</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">"disable_sub"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">commandSpec</span><span class="o">.</span><span class="na">removeSubcommand</span><span class="o">(</span><span class="s">"sub"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">commandSpec</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Command</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">sub</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// subcommand, business logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">modelTransformer</span> <span class="p">=</span> <span class="nc">Dynamic</span><span class="p">.</span><span class="nc">SubCmdFilter</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">Dynamic</span> <span class="p">{</span>

    <span class="kd">class</span> <span class="nc">SubCmdFilter</span> <span class="p">:</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nc">IModelTransformer</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">transform</span><span class="p">(</span><span class="n">commandSpec</span><span class="p">:</span> <span class="nc">CommandSpec</span><span class="p">):</span> <span class="nc">CommandSpec</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nc">Boolean</span><span class="p">.</span><span class="nf">getBoolean</span><span class="p">(</span><span class="s">"disable_sub"</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">commandSpec</span><span class="p">.</span><span class="nf">removeSubcommand</span><span class="p">(</span><span class="s">"sub"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">commandSpec</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Command</span>
    <span class="k">private</span> <span class="k">fun</span> <span class="nf">sub</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// subcommand, business logic</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All transformers are called once, after the full command hierarchy is constructed, and before any command line arguments are parsed.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
If your model transformer is declared as nested class, make sure you mark this class as <code>static</code>, or picocli will not be able to instantiate your transformer class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_automatic_parameter_indexes"><a class="anchor" href="#_automatic_parameter_indexes"></a>21.7. Automatic Parameter Indexes</h3>
<div class="sect3">
<h4 id="_automatic_indexes"><a class="anchor" href="#_automatic_indexes"></a>21.7.1. Automatic Indexes</h4>
<div class="paragraph">
<p><a href="#_positional_parameters">Positional parameters</a> have an <code>index</code> attribute that determines which command line argument(s) are captured.
It is possible to omit the <code>index</code> attribute and let picocli automatically assign an index.</p>
</div>
<div class="paragraph">
<p>This means different things for single-value and for multi-value positional parameters.</p>
</div>
<div class="paragraph">
<p>For <strong>multi-value</strong> positional parameters (arrays or collections), omitting the <code>index</code> attribute means the field captures <em>all</em> positional parameters (the equivalent of <code>index = "0..*"</code>).</p>
</div>
<div class="paragraph">
<p>For <strong>single-value</strong> positional parameters, picocli&#8217;s behaviour has changed since version 4.3:
prior to picocli 4.3, the default index for single-value positional parameters was also <code>index = "0..*"</code>, even though only one value (usually the first argument) can be captured.
From version 4.3, the default index is <code>index = "0+"</code>, which tells picocli to assign an index automatically, starting from zero, based on the other positional parameters defined in the same command.
A simple example can look like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">AutomaticIndex</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">hidden</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>   <span class="c1">// "hidden": don't show this parameter in usage help message</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">allParameters</span><span class="o">;</span>  <span class="c1">// no "index" attribute: captures _all_ arguments</span>

    <span class="nd">@Parameters</span> <span class="nc">String</span> <span class="n">group</span><span class="o">;</span>    <span class="c1">// assigned index = "0"</span>
    <span class="nd">@Parameters</span> <span class="nc">String</span> <span class="n">artifact</span><span class="o">;</span> <span class="c1">// assigned index = "1"</span>
    <span class="nd">@Parameters</span> <span class="nc">String</span> <span class="n">version</span><span class="o">;</span>  <span class="c1">// assigned index = "2"</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">AutomaticIndex</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">hidden</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>  <span class="c1">// "hidden": don't show this parameter in usage help message</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">allParameters</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>   <span class="c1">// no "index" attribute: captures _all_ arguments</span>

    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">group</span><span class="p">:</span>    <span class="nc">String</span>  <span class="c1">// assigned index = "0"</span>
    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">artifact</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "1"</span>
    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">version</span><span class="p">:</span>  <span class="nc">String</span>  <span class="c1">// assigned index = "2"</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Picocli initializes fields with the values at the specified index in the arguments array.</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"info.picocli"</span><span class="o">,</span> <span class="s">"picocli"</span><span class="o">,</span> <span class="s">"4.3.0"</span> <span class="o">};</span>
<span class="nc">AutomaticIndex</span> <span class="n">auto</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">populateCommand</span><span class="o">(</span><span class="k">new</span> <span class="nc">AutomaticIndex</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span>

<span class="k">assert</span> <span class="n">auto</span><span class="o">.</span><span class="na">group</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"info.picocli"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">auto</span><span class="o">.</span><span class="na">artifact</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"picocli"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">auto</span><span class="o">.</span><span class="na">version</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"4.3.0"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">auto</span><span class="o">.</span><span class="na">allParameters</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">args</span><span class="o">));</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">args</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"info.picocli"</span><span class="p">,</span> <span class="s">"picocli"</span><span class="p">,</span> <span class="s">"4.3.0"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">auto</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">populateCommand</span><span class="p">(</span><span class="nc">AutomaticIndex</span><span class="p">(),</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span>

<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"info.picocli"</span><span class="p">,</span> <span class="n">auto</span><span class="p">.</span><span class="n">group</span> <span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"picocli"</span><span class="p">,</span> <span class="n">auto</span><span class="p">.</span><span class="n">artifact</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"4.3.0"</span><span class="p">,</span> <span class="n">auto</span><span class="p">.</span><span class="n">version</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="nc">Arrays</span><span class="p">.</span><span class="nf">asList</span><span class="p">(*</span><span class="n">args</span><span class="p">),</span> <span class="n">auto</span><span class="p">.</span><span class="n">allParameters</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Automatic indexes depend on the ability of Java reflection and Java annotation processors to iterate over fields in declaration order in the source code.
Officially this is not guaranteed by the Java spec.
In practice this has worked in Oracle JVMs and OpenJDK from Java 6, but there is some risk this may not work in the future or on other JVM&#8217;s.
In general, for single-value positional parameters, using <a href="#_explicit_index">explicit indexes</a> is the safer option.
(Multi-value positional parameters can safely omit the <code>index</code> attribute.)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Methods cannot be iterated over in predictable order.
For applications with <a href="#option-parameters-methods"><code>@Parameters</code>-annotated methods</a> or combinations of <code>@Parameters</code>-annotated methods and <code>@Parameters</code>-annotated fields, we recommend using <a href="#_explicit_index">explicit indexes</a> for single-value positional parameters.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_anchored_automatic_index"><a class="anchor" href="#_anchored_automatic_index"></a>21.7.2. Anchored Automatic Index</h4>
<div class="paragraph">
<p>The default automatic index (<code>index = "0+"</code>) for single-value positional parameters is "anchored at zero": it starts at zero, and is increased with each additional positional parameter.</p>
</div>
<div class="paragraph">
<p>Sometimes you want to have indexes assigned automatically from a different starting point than zero.
This can be useful when defining <a href="#_mixins">Mixins</a> with positional parameters.</p>
</div>
<div class="paragraph">
<p>To accomplish this, specify an index with the anchor point and a <code>+</code> character to indicate that picocli should start to automatically assign indexes from that anchor point. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Anchored</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">p1</span><span class="o">;</span> <span class="c1">// assigned index = "1" or higher</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">p2</span><span class="o">;</span> <span class="c1">// assigned index = "2" or higher</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Anchored</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p1</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "1" or higher</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p2</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "2" or higher</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_combining_explicit_and_automatic_indexes"><a class="anchor" href="#_combining_explicit_and_automatic_indexes"></a>21.7.3. Combining Explicit and Automatic Indexes</h4>
<div class="paragraph">
<p>If a command defines a positional parameter with an explicit index at the anchor point, then automatic indexes anchored at that point will start from the explicit index plus 1.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ExplicitAndAutomaticIndexes</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">explicit0</span><span class="o">;</span>  <span class="c1">// explicit index "0" at default anchor point</span>
    <span class="nd">@Parameters</span> <span class="nc">String</span> <span class="n">pAuto1</span><span class="o">;</span>                   <span class="c1">// assigned index "1", anchor point + 1</span>
    <span class="nd">@Parameters</span> <span class="nc">String</span> <span class="n">pAuto2</span><span class="o">;</span>                   <span class="c1">// assigned index "2"</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">pAnchored1</span><span class="o">;</span> <span class="c1">// assigned index "1": no explicit index 1</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">pAnchored2</span><span class="o">;</span> <span class="c1">// assigned index "2"</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"2"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">explicit2</span><span class="o">;</span>  <span class="c1">// explicit index "2", matching anchor for "2+"</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"2+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">pAnchored3</span><span class="o">;</span> <span class="c1">// assigned index "3", anchor point + 1</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"2+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">pAnchored4</span><span class="o">;</span> <span class="c1">// assigned index "4"</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">ExplicitAndAutomaticIndexes</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">explicit0</span><span class="p">:</span> <span class="nc">String</span>   <span class="c1">// explicit index "0"</span>
                                                              <span class="c1">// at default anchor point</span>
    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAuto1</span><span class="p">:</span> <span class="nc">String</span>                   <span class="c1">// assigned index "1",</span>
                                                              <span class="c1">// anchor point + 1</span>
    <span class="nd">@Parameters</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAuto2</span><span class="p">:</span> <span class="nc">String</span>                   <span class="c1">// assigned index "2"</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAnchored1</span><span class="p">:</span> <span class="nc">String</span> <span class="c1">// assigned index "1":</span>
                                                              <span class="c1">// no explicit index 1</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAnchored2</span><span class="p">:</span> <span class="nc">String</span> <span class="c1">// assigned index "2"</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">explicit2</span><span class="p">:</span> <span class="nc">String</span>   <span class="c1">// explicit index "2",</span>
                                                              <span class="c1">// matching anchor for "2+"</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"2+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAnchored3</span><span class="p">:</span> <span class="nc">String</span> <span class="c1">// assigned index "3",</span>
                                                              <span class="c1">// anchor point + 1</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"2+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">pAnchored4</span><span class="p">:</span> <span class="nc">String</span> <span class="c1">// assigned index "4"</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_unanchored_automatic_index"><a class="anchor" href="#_unanchored_automatic_index"></a>21.7.4. Unanchored Automatic Index</h4>
<div class="paragraph">
<p>Sometimes you want to have indexes assigned automatically to come at the end.
This can be useful when defining <a href="#_mixins">Mixins</a> with positional parameters.</p>
</div>
<div class="paragraph">
<p>To accomplish this, specify an index with a <code>+</code> character to indicate that picocli should automatically assign indexes that come at the end.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">Unanchored</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">p0</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">p1</span><span class="o">;</span> <span class="c1">// assigned index = "1"</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"1+"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">p2</span><span class="o">;</span> <span class="c1">// assigned index = "2"</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"3"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">p3</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"+"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">p4</span><span class="o">;</span> <span class="c1">// assigned index = "4" &lt;-- unanchored</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"+"</span> <span class="o">)</span> <span class="nc">String</span> <span class="n">p5</span><span class="o">;</span> <span class="c1">// assigned index = "5" &lt;-- unanchored</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">Unanchored</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0"</span> <span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p0</span><span class="p">:</span> <span class="nc">String</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p1</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "1"</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"1+"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p2</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "2"</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"3"</span> <span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p3</span><span class="p">:</span> <span class="nc">String</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"+"</span> <span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p4</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "4" &lt;-- unanchored</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"+"</span> <span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">p5</span><span class="p">:</span> <span class="nc">String</span>  <span class="c1">// assigned index = "5" &lt;-- unanchored</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_do_not_combine_unanchored_indexes_with_open_ended_indexes"><a class="anchor" href="#_do_not_combine_unanchored_indexes_with_open_ended_indexes"></a>21.7.5. Do Not Combine Unanchored Indexes with Open-ended Indexes</h4>
<div class="paragraph">
<p>It is not possible to combine unanchored indexes (<code>+</code>) with open-ended explicit indexes (<code>*</code>):
the parameter with the open-ended index will capture all arguments, and there is no position "after the other indexes" that can be assigned.</p>
</div>
<div class="paragraph">
<p>The below example will always give a <code>Missing required parameter: &lt;last&gt;</code> error:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BadCombination</span> <span class="o">{</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"0..*"</span><span class="o">)</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">all</span><span class="o">;</span>
    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">"+"</span>   <span class="o">)</span> <span class="nc">String</span> <span class="n">last</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">BadCombination</span> <span class="p">{</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"0..*"</span><span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">all</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">index</span> <span class="p">=</span> <span class="s">"+"</span>   <span class="p">)</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">last</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_improved_support_for_chinese_japanese_and_korean"><a class="anchor" href="#_improved_support_for_chinese_japanese_and_korean"></a>21.8. Improved Support for Chinese, Japanese and Korean</h3>
<div class="paragraph">
<p>Picocli will align the usage help message to fit within some user-defined width (80 columns by default).
A number of characters in Chinese, Japanese and Korean (CJK) are wider than others.
If those characters are treated to have the same width as other characters, the usage help message may extend past the right margin.</p>
</div>
<div class="paragraph">
<p>From 4.0, picocli will use 2 columns for these wide characters when calculating where to put line breaks, resulting in better usage help message text.</p>
</div>
<div class="paragraph">
<p>This can be switched off with <code>CommandLine.setAdjustLineBreaksForWideCJKCharacters(false)</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_boolean_options_with_parameters"><a class="anchor" href="#_boolean_options_with_parameters"></a>21.9. Boolean Options with Parameters</h3>
<div class="paragraph">
<p>By default the value of a boolean field is set to the logical negative of its default value when the option is specified on the command line.</p>
</div>
<div class="paragraph">
<p>It is possible to let end users explicitly specify "true" or "false" as a parameter for a boolean option by defining an explicit <a href="#_arity">Arity</a> attribute. A boolean option with <code>arity = "0..1"</code> accepts zero to one parameters, <code>arity = "1"</code> means the option <em>must</em> have one parameter. For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BooleanOptionWithParameters</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"1 mandatory parameter"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">x</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-y"</span><span class="o">,</span> <span class="n">arity</span> <span class="o">=</span> <span class="s">"0..1"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"min 0 and max 1 parameter"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">y</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">class</span> <span class="nc">BooleanOptionWithParameters</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"1 mandatory parameter"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="k">false</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-y"</span><span class="p">],</span> <span class="n">arity</span> <span class="p">=</span> <span class="s">"0..1"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"min 0 and max 1 parameter"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">y</span> <span class="p">=</span> <span class="k">false</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following ways to invoke the program will be accepted (values are not case sensitive):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;command&gt; -x true
&lt;command&gt; -x FALSE
&lt;command&gt; -x TRUE -y
&lt;command&gt; -x True -y False</pre>
</div>
</div>
<div class="paragraph">
<p>But trying to specify the <code>-x</code> option without a parameter, or with a value other than "true" or "false" (case insensitive) will result in a <code>ParameterException</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hexadecimal_values"><a class="anchor" href="#_hexadecimal_values"></a>21.10. Hexadecimal Values</h3>
<div class="paragraph">
<p>Numeric values are interpreted as decimal numbers by default. If you want picocli to be more flexible, you can
register a custom type converter that delegates to the <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html#decode-java.lang.String-">decode</a> method to convert strings to numbers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>decode</code> method looks at the prefix to determine the radix, so numbers
starting with <code>0x</code>, <code>0X</code> or <code>#</code> are interpreted as hexadecimal numbers, numbers starting with <code>0</code> are interpreted
as octal numbers, and otherwise the number is interpreted as a decimal number.
</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Java 8</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">obj</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Byte</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>    <span class="nl">Byte:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Byte</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span>     <span class="nl">Byte:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Short</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>   <span class="nl">Short:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Short</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span>    <span class="nl">Short:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nl">Integer:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span>  <span class="nl">Integer:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>    <span class="nl">Long:</span><span class="o">:</span><span class="n">decode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span>     <span class="nl">Long:</span><span class="o">:</span><span class="n">decode</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nc">CommandLine</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Byte</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>     <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Byte</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Byte</span><span class="p">.</span><span class="nc">TYPE</span><span class="p">,</span>  <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Byte</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Short</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>    <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Short</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Short</span><span class="p">.</span><span class="nc">TYPE</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Short</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Int</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>      <span class="nc">Integer</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Integer</span><span class="p">.</span><span class="nc">TYPE</span><span class="p">,</span>         <span class="nc">Integer</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Long</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>     <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Long</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Long</span><span class="p">.</span><span class="nc">TYPE</span><span class="p">,</span>  <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">Long</span><span class="o">::</span><span class="n">decode</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Java 5</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">intConverter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ITypeConverter</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">};</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">intConverter</span><span class="o">);</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span>  <span class="n">intConverter</span><span class="o">);</span>
<span class="c1">// ...</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">var</span> <span class="py">intConverter</span><span class="p">:</span> <span class="nc">ITypeConverter</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">=</span> <span class="kd">object</span> <span class="err">: </span><span class="nc">ITypeConverter</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">convert</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nc">String</span><span class="p">):</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">Integer</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Int</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="n">intConverter</span><span class="p">)</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">registerConverter</span><span class="p">(</span><span class="nc">Integer</span><span class="p">.</span><span class="nc">TYPE</span><span class="p">,</span>    <span class="n">intConverter</span><span class="p">)</span>
<span class="c1">// ...</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_option_parameter_separators_2"><a class="anchor" href="#_option_parameter_separators_2"></a>21.11. Option-Parameter Separators</h3>
<div class="sect3">
<h4 id="_default_separators"><a class="anchor" href="#_default_separators"></a>21.11.1. Default Separators</h4>
<div class="paragraph">
<p>Options may take an <em>option parameter</em> (also called <em>option-argument</em>).
For POSIX-style short options (like <code>-f</code> or <code>-c</code>), the option parameter may be attached to the option,
or it may be separated by a space or the <em>separator string</em> (<code>=</code> by default).
That is, all of the below are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-foutput</span>.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-f</span> output.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">-f</span><span class="o">=</span>output.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Long option names (like <code>--file</code>) must be separated from their option parameter by a space or the
<em>separator string</em> (<code>=</code> by default). That is, the first two below examples are valid but the last example is invalid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">// valid <span class="o">(</span>separator between <span class="nt">--file</span> and its parameter<span class="o">)</span>
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">--file</span> output.txt
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">--file</span><span class="o">=</span>output.txt

// invalid <span class="o">(</span>picocli will not recognize the <span class="nt">--file</span> option when attached to its parameter<span class="o">)</span>
&lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="nt">--fileoutput</span>.txt</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_custom_separators"><a class="anchor" href="#_custom_separators"></a>21.11.2. Custom Separators</h4>
<div class="paragraph">
<p>The separator string can be customized programmatically or declaratively.</p>
</div>
<div class="paragraph">
<p>Use the <code>separator</code> attribute of the <code>@Command</code> annotation to declaratively set a separator string:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">separator</span> <span class="o">=</span> <span class="s">":"</span><span class="o">)</span>  <span class="c1">// declaratively set a separator</span>
<span class="kd">class</span> <span class="nc">OptionArg</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-f"</span><span class="o">,</span> <span class="s">"--file"</span> <span class="o">})</span> <span class="nc">String</span> <span class="n">file</span><span class="o">;</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">separator</span> <span class="p">=</span> <span class="s">":"</span><span class="p">)</span>  <span class="c1">// declaratively set a separator</span>
<span class="kd">class</span> <span class="nc">OptionArg</span> <span class="p">{</span>
    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-f"</span><span class="p">,</span> <span class="s">"--file"</span><span class="p">])</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">file</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">OptionArg</span> <span class="n">optionArg</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">populateCommand</span><span class="o">(</span><span class="k">new</span> <span class="nc">OptionArg</span><span class="o">(),</span> <span class="s">"-f:output.txt"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">optionArg</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"output.txt"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">optionArg</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">populateCommand</span><span class="p">(</span><span class="nc">OptionArg</span><span class="p">(),</span> <span class="s">"-f:output.txt"</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"output.txt"</span><span class="p">,</span> <span class="n">optionArg</span><span class="p">.</span><span class="n">file</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the separator string can be changed programmatically with the <code>CommandLine.setSeparator(String separator)</code> method.
For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">OptionArg</span> <span class="n">optionArg</span>     <span class="o">=</span> <span class="k">new</span> <span class="nc">OptionArg</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">commandLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">optionArg</span><span class="o">);</span>

<span class="n">commandLine</span><span class="o">.</span><span class="na">setSeparator</span><span class="o">(</span><span class="s">":"</span><span class="o">);</span> <span class="c1">// programmatically set a separator</span>
<span class="n">commandLine</span><span class="o">.</span><span class="na">parseArgs</span><span class="o">(</span><span class="s">"-f:output.txt"</span><span class="o">);</span>
<span class="k">assert</span> <span class="n">optionArg</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"output.txt"</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">optionArg</span> <span class="p">=</span> <span class="nc">OptionArg</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">commandLine</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">optionArg</span><span class="p">)</span>

<span class="n">commandLine</span><span class="p">.</span><span class="n">separator</span> <span class="p">=</span> <span class="s">":"</span> <span class="c1">// programmatically set a separator</span>
<span class="n">commandLine</span><span class="p">.</span><span class="nf">parseArgs</span><span class="p">(</span><span class="s">"-f:output.txt"</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"output.txt"</span><span class="p">,</span> <span class="n">optionArg</span><span class="p">.</span><span class="n">file</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_best_practices_for_command_line_interfaces"><a class="anchor" href="#_best_practices_for_command_line_interfaces"></a>21.12. Best Practices for Command Line Interfaces</h3>
<div class="paragraph">
<p>Picocli makes it easy to follow this new and modern set of <a href="https://clig.dev/#guidelines">Command Line Interface Guidelines</a>.</p>
</div>
<div class="paragraph">
<p>Slightly older, but a classic: when designing your command line application,
the <a href="https://www.gnu.org/prep/standards/html_node/Command_002dLine-Interfaces.html#Command_002dLine-Interfaces">GNU recommendations</a> for command line interfaces and <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html#tag_12_02">POSIX Utility Guidelines</a> may be useful.</p>
</div>
<div class="paragraph">
<p>Generally, many applications use options for optional values and parameters for mandatory values.
However, picocli lets you make options required if you want to, see <a href="#_required_arguments">Required Arguments</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_text_blocks_for_java_15"><a class="anchor" href="#_text_blocks_for_java_15"></a>21.13. Text Blocks for Java 15</h3>
<div class="paragraph">
<p>When writing your command line program, you can use Java 15&#8217;s new "Text Block" feature.
Multi-line text blocks can be used in command and option descriptions, headers and footers.</p>
</div>
<div class="listingblock primary">
<div class="title">Java 15</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-v"</span><span class="o">,</span> <span class="s">"--verbose"</span> <span class="o">},</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s">"""
                Verbose mode. Helpful for troubleshooting.
                Multiple -v options increase the verbosity.
                """</span><span class="o">)</span> <span class="c1">// write description in text block</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span> <span class="s">"-v"</span><span class="p">,</span> <span class="s">"--verbose"</span> <span class="p">],</span>
  <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"""
                 Verbose mode. Helpful for troubleshooting.
                 Multiple -v options increase the verbosity.
                 """</span><span class="p">])</span> <span class="c1">// write description in text block</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see <a href="https://www.infoq.com/articles/java-text-blocks/">this article</a> by Java Language Architect Brian Goetz.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependency_injection"><a class="anchor" href="#_dependency_injection"></a>22. Dependency Injection</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_guice_example"><a class="anchor" href="#_guice_example"></a>22.1. Guice Example</h3>
<div class="paragraph">
<p><span class="image"><img src="https://picocli.info/images/225px-Guice.jpg" alt="Guice logo"></span></p>
</div>
<div class="paragraph">
<p>The below example shows how to create a <a href="#_custom_factory">custom <code>IFactory</code></a> implementation with a Guice <code>Injector</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">com.google.inject.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.IFactory</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GuiceFactory</span> <span class="kd">implements</span> <span class="nc">IFactory</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Injector</span> <span class="n">injector</span> <span class="o">=</span> <span class="nc">Guice</span><span class="o">.</span><span class="na">createInjector</span><span class="o">(</span><span class="k">new</span> <span class="nc">DemoModule</span><span class="o">());</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="no">K</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">aClass</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">injector</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">aClass</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ConfigurationException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// no implementation found in Guice configuration</span>
            <span class="k">return</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">defaultFactory</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">aClass</span><span class="o">);</span> <span class="c1">// fallback if missing</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DemoModule</span> <span class="kd">extends</span> <span class="nc">AbstractModule</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">bind</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">LinkedList</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">com.google.inject.*</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.IFactory</span>

<span class="kd">class</span> <span class="nc">GuiceFactory</span> <span class="p">:</span> <span class="nc">IFactory</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">injector</span> <span class="p">=</span> <span class="nc">Guice</span><span class="p">.</span><span class="nf">createInjector</span><span class="p">(</span><span class="nc">DemoModule</span><span class="p">())</span>

    <span class="nd">@Throws</span><span class="p">(</span><span class="nc">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">K</span><span class="p">&gt;</span> <span class="nf">create</span><span class="p">(</span><span class="n">aClass</span><span class="p">:</span> <span class="nc">Class</span><span class="p">&lt;</span><span class="nc">K</span><span class="p">&gt;):</span> <span class="nc">K</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">try</span> <span class="p">{</span>
            <span class="n">injector</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="n">aClass</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ex</span><span class="p">:</span> <span class="nc">ConfigurationException</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// no implementation found in Guice configuration</span>
            <span class="nc">CommandLine</span><span class="p">.</span><span class="nf">defaultFactory</span><span class="p">().</span><span class="nf">create</span><span class="p">(</span><span class="n">aClass</span><span class="p">)</span> <span class="c1">// fallback if missing</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">DemoModule</span> <span class="p">:</span> <span class="nc">AbstractModule</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">configure</span><span class="p">()</span> <span class="p">{</span>
            <span class="nf">bind</span><span class="p">(</span><span class="kd">object</span> <span class="err">: </span><span class="nc">TypeLiteral</span><span class="p">&lt;</span><span class="n">kotlin</span><span class="p">.</span><span class="n">collections</span><span class="p">.</span><span class="nc">List</span><span class="p">&lt;</span><span class="err">*</span><span class="p">&gt;&gt;()</span> <span class="p">{})</span>
                <span class="p">.</span><span class="nf">toInstance</span><span class="p">(</span><span class="n">kotlin</span><span class="p">.</span><span class="n">collections</span><span class="p">.</span><span class="nc">ArrayList</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the custom factory when creating a <code>CommandLine</code> instance, or when invoking the <code>run</code> or <code>call</code> convenience methods:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">javax.inject.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.*</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"di-demo"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InjectionDemo</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Inject</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span> <span class="n">list</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"-x"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="nc">InjectionDemo</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="nc">GuiceFactory</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">assert</span> <span class="n">list</span> <span class="k">instanceof</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">LinkedList</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Command</span>
<span class="k">import</span> <span class="nn">javax.inject.Inject</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"di-demo"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">InjectionDemo</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Inject</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">list</span><span class="p">:</span> <span class="n">kotlin</span><span class="p">.</span><span class="n">collections</span><span class="p">.</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;</span>

    <span class="nd">@CommandLine</span><span class="p">.</span><span class="nc">Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-x"</span><span class="p">])</span> <span class="kd">var</span> <span class="py">x</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">assert</span><span class="p">(</span><span class="n">list</span> <span class="k">is</span> <span class="n">kotlin</span><span class="p">.</span><span class="n">collections</span><span class="p">.</span><span class="nc">ArrayList</span><span class="p">&lt;</span><span class="err">*</span><span class="p">&gt;)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">InjectionDemo</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="nc">GuiceFactory</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot_example"><a class="anchor" href="#_spring_boot_example"></a>22.2. Spring Boot Example</h3>
<div class="paragraph">
<p><span class="image"><img src="https://picocli.info/images/spring-boot.png" alt="Spring Boot Logo" width="350" height="167"></span></p>
</div>
<div class="paragraph">
<p>As of version 4.0, picocli comes with Spring Boot support by providing a custom factory in the <code>picocli-spring-boot-starter</code> module.</p>
</div>
<div class="paragraph">
<p>The Spring Boot example app below provides a command line interface to a mail client that can be used to send emails using an SMTP server.
The <code>To</code> address(es) and the subject line can be given as options, while a message body can be specified as parameter text.</p>
</div>
<div class="paragraph">
<p>To get started, visit the <a href="https://start.spring.io/#!type=maven-project&amp;language=java&amp;platformVersion=2.3.5.RELEASE&amp;packaging=jar&amp;jvmVersion=11&amp;groupId=info.picocli&amp;artifactId=examples&amp;name=spring-boot-demo&amp;description=Demo%20project%20for%20Spring%20Boot%20with%20Picocli%20support&amp;packageName=info.picocli.examples&amp;dependencies=mail">Spring Initializr</a> first.
Our example app has <code>Java Mail Sender</code> as dependency, please note that this dependency is selected already.
Review all settings, and change if needed, especially if you want to code your app in Kotlin.
By clicking on the button <code>Generate</code> you can download a self-contained skeleton Spring Boot project, together with its dependencies, a build script and test cases.
Extract the archive file to a directory of your choice and open a shell or command prompt for this directory.</p>
</div>
<div class="paragraph">
<p>Since picocli dependencies are not available in the Spring Initializr, we have to add them manually:</p>
</div>
<div class="listingblock primary">
<div class="title">Maven</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>info.picocli<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>picocli-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.6.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Gradle (Groovy)</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">'info.picocli:picocli-spring-boot-starter:4.6.2'</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Gradle (Kotlin)</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"info.picocli:picocli-spring-boot-starter:4.6.2"</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will bring in the <code>info.picocli:picocli</code> and the <code>info.picocli:picocli-spring-boot-starter</code> dependencies.</p>
</div>
<div class="paragraph">
<p>Now open the pre-authored source file <code>SpringBootDemoApplication.java</code>, rename it to <code>MySpringMailer.java</code> and edit and extend it so that it looks like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.springframework.boot.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.IFactory</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MySpringMailer</span> <span class="kd">implements</span> <span class="nc">CommandLineRunner</span><span class="o">,</span> <span class="nc">ExitCodeGenerator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">IFactory</span> <span class="n">factory</span><span class="o">;</span>        <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="kd">private</span> <span class="nc">MailCommand</span> <span class="n">mailCommand</span><span class="o">;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">exitCode</span><span class="o">;</span>

    <span class="c1">// constructor injection</span>
    <span class="nc">MySpringMailer</span><span class="o">(</span><span class="nc">IFactory</span> <span class="n">factory</span><span class="o">,</span> <span class="nc">MailCommand</span> <span class="n">mailCommand</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">factory</span> <span class="o">=</span> <span class="n">factory</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">mailCommand</span> <span class="o">=</span> <span class="n">mailCommand</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// let picocli parse command line args and run the business logic</span>
        <span class="n">exitCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">mailCommand</span><span class="o">,</span> <span class="n">factory</span><span class="o">).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getExitCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">exitCode</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// let Spring instantiate and inject dependencies</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="nc">SpringApplication</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">MySpringMailer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">)));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The injected factory is auto-configured to inject <code>PicocliSpringFactory</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The injected <code>MailCommand</code> is our <code>@picocli.CommandLine.Command</code>-annotated class, which is listed next:</td>
</tr>
</table>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">org.springframework.boot.*</span>
<span class="k">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.IFactory</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">class</span> <span class="nc">MySpringMailer</span> <span class="p">:</span> <span class="nc">CommandLineRunner</span><span class="p">,</span> <span class="nc">ExitCodeGenerator</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">var</span> <span class="py">factory</span><span class="p">:</span> <span class="nc">IFactory</span>        <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">mailCommand</span><span class="p">:</span> <span class="nc">MailCommand</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="mi">0</span>

    <span class="c1">// constructor injection</span>
    <span class="k">constructor</span><span class="p">(</span><span class="n">factory</span><span class="p">:</span> <span class="nc">IFactory</span><span class="p">,</span> <span class="n">mailCommand</span><span class="p">:</span> <span class="nc">MailCommand</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">factory</span> <span class="p">=</span> <span class="n">factory</span>          <span class="c1">// auto-configured to inject PicocliSpringFactory</span>
        <span class="k">this</span><span class="p">.</span><span class="n">mailCommand</span> <span class="p">=</span> <span class="n">mailCommand</span>  <span class="c1">// your @picocli.CommandLine.Command-annotated class</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">(</span><span class="k">vararg</span> <span class="n">args</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// let picocli parse command line args and run the business logic</span>
        <span class="n">exitCode</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">mailCommand</span><span class="p">,</span> <span class="n">factory</span><span class="p">).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getExitCode</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">exitCode</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="n">runApplication</span><span class="p">&lt;</span><span class="nc">MySpringMailer</span><span class="p">&gt;(*</span><span class="n">args</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The injected factory is auto-configured to inject <code>PicocliSpringFactory</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The injected <code>MailCommand</code> is our <code>@picocli.CommandLine.Command</code>-annotated class, which is listed next:</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>

<span class="nd">@Component</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"mailCommand"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MailCommand</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Autowired</span> <span class="kd">private</span> <span class="nc">IMailService</span> <span class="n">mailService</span><span class="o">;</span> <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--to"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"email(s) of recipient(s)"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">to</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--subject"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Subject"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">subject</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Message to be sent"</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">body</span> <span class="o">=</span> <span class="o">{};</span>

    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">mailService</span><span class="o">.</span><span class="na">sendMessage</span><span class="o">(</span><span class="n">to</span><span class="o">,</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">" "</span><span class="o">,</span> <span class="n">body</span><span class="o">));</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We annotate our command with the <code>@org.springframework.stereotype.Component</code> annotation so that Spring can autodetect it for dependency injection.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The business logic of your command looks like any other picocli command with options and parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The interface for our autowired <code>MailService</code> is very simple:</td>
</tr>
</table>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span>
<span class="k">import</span> <span class="nn">org.springframework.stereotype.Component</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.*</span>
<span class="k">import</span> <span class="nn">java.util.concurrent.Callable</span>

<span class="nd">@Component</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"mailCommand"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MailCommand</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>

    <span class="nd">@Autowired</span> <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">mailService</span><span class="p">:</span> <span class="nc">IMailService</span> <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--to"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"email(s) of recipient(s)"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">to</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--subject"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Subject"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">subject</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">""</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Message to be sent"</span><span class="p">])</span>
    <span class="kd">var</span> <span class="py">body</span> <span class="p">=</span> <span class="n">arrayOf</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;()</span>

    <span class="nd">@Throws</span><span class="p">(</span><span class="nc">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="n">mailService</span><span class="p">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="nc">String</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="p">*</span><span class="n">body</span><span class="p">))</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We annotate our command with the <code>@org.springframework.stereotype.Component</code> annontation so that Spring can autodetect it for dependency injection.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The business logic of your command looks like any other picocli command with options and parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The interface for our autowired <code>MailService</code> is very simple:</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IMailService</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">sendMessage</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">text</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">interface</span> <span class="nc">IMailService</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span> <span class="n">subject</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And this is the implementation of our mail service:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.slf4j.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.mail.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.mail.javamail.JavaMailSender</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Service</span><span class="o">(</span><span class="s">"MailService"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MailServiceImpl</span> <span class="kd">implements</span> <span class="nc">IMailService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="no">LOGGER</span><span class="o">=</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">MailServiceImpl</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">NOREPLY_ADDRESS</span> <span class="o">=</span> <span class="s">"noreply@picocli.info"</span><span class="o">;</span>

    <span class="nd">@Autowired</span> <span class="kd">private</span> <span class="nc">JavaMailSender</span> <span class="n">emailSender</span><span class="o">;</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendMessage</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">SimpleMailMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleMailMessage</span><span class="o">();</span> <span class="c1">// create message</span>
            <span class="n">message</span><span class="o">.</span><span class="na">setFrom</span><span class="o">(</span><span class="no">NOREPLY_ADDRESS</span><span class="o">);</span>                    <span class="c1">// compose message</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">recipient</span> <span class="o">:</span> <span class="n">to</span><span class="o">)</span> <span class="o">{</span> <span class="n">message</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">recipient</span><span class="o">);</span> <span class="o">}</span>
            <span class="n">message</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
            <span class="n">message</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
            <span class="n">emailSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>                           <span class="c1">// send message</span>

            <span class="no">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Mail to {} sent! Subject: {}, Body: {}"</span><span class="o">,</span> <span class="n">to</span><span class="o">,</span> <span class="n">subject</span><span class="o">,</span> <span class="n">text</span><span class="o">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">MailException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span> <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>JavaMailSender</code> is provided by the Spring framework.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Once a mail was successful sent, a log message will be emitted.</td>
</tr>
</table>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">org.slf4j.LoggerFactory</span>
<span class="k">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span>
<span class="k">import</span> <span class="nn">org.springframework.mail.*</span>
<span class="k">import</span> <span class="nn">org.springframework.mail.javamail.JavaMailSender</span>
<span class="k">import</span> <span class="nn">org.springframework.stereotype.Service</span>

<span class="nd">@Service</span><span class="p">(</span><span class="s">"MailService"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MailServiceImpl</span> <span class="p">:</span> <span class="nc">IMailService</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">LOGGER</span> <span class="p">=</span> <span class="nc">LoggerFactory</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="nc">MailServiceImpl</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">NOREPLY_ADDRESS</span> <span class="p">=</span> <span class="s">"noreply@picocli.info"</span>

    <span class="nd">@Autowired</span> <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">emailSender</span><span class="p">:</span> <span class="nc">JavaMailSender</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span> <span class="n">subject</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">message</span> <span class="p">=</span> <span class="nc">SimpleMailMessage</span><span class="p">()</span> <span class="c1">// create message</span>
            <span class="n">message</span><span class="p">.</span><span class="nf">setFrom</span><span class="p">(</span><span class="nc">NOREPLY_ADDRESS</span><span class="p">)</span>  <span class="c1">// compose message</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">recipient</span> <span class="k">in</span> <span class="n">to</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">message</span><span class="p">.</span><span class="nf">setTo</span><span class="p">(</span><span class="n">recipient</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">message</span><span class="p">.</span><span class="nf">setSubject</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">message</span><span class="p">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">emailSender</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>        <span class="c1">// send message</span>
            <span class="nc">LOGGER</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"Mail to {} sent! Subject: {}, Body: {}"</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="nc">MailException</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="nf">printStackTrace</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>JavaMailSender</code> is provided by the Spring framework.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Once a mail was successful sent, a log message will be emitted.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally we have to configure our mail service. This can be done inside a file <code>application.properties</code>, which we put in a <code>config</code> subdirectory of your project:</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre># configuration mail service
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=email
spring.mail.password=password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true</pre>
</div>
</div>
<div class="paragraph">
<p>With all our classes and configuration in place, we now can use the maven wrapper <code>mvnw</code> to compile and run our example app:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvnw spring-boot:run
# ...
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.3.5.RELEASE)
# ...
#2020-11-01 19:35:31.084  INFO 15724 --- [           main] info.picocli.demo.MySpringMailer         : Started MySpringMailer in 0.821 seconds (JVM running for 1.131)
Missing required option: '--to=&lt;to&gt;'
Usage: mailCommand [--subject=&lt;subject&gt;] --to=&lt;to&gt; [--to=&lt;to&gt;]... [&lt;body&gt;...]
      [&lt;body&gt;...]           Message to be sent
      --subject=&lt;subject&gt;   Subject
      --to=&lt;to&gt;             email(s) of recipient(s)</pre>
</div>
</div>
<div class="paragraph">
<p>Since we specified no command line arguments, Picocli complains about the missing required option <code>--to</code> and outputs the usage help.
We have to pass in command line arguments into our command line call, we can use <code>-Dspring-boot.run.arguments</code> for that purpose:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvnw compile spring-boot:dev -Dspring-boot.run.arguments="--to hans@mustermann.de \
    --to zhang@san.cn --subject Testmail Easy mailing with Spring Boot and picocli"
# ...
2020-11-01 21:14:43.458  INFO 9656 --- [           main] info.picocli.demo.MailServiceImpl        : Mail to [hans@mustermann.de, zhang@san.cn] successfully sent! Subject:  Testmail, Body: Easy mailing with Spring Boot and picocli
# ...</pre>
</div>
</div>
<div class="paragraph">
<p>With all options and parameters specified, a mail is sent successfully.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It may be a good idea to define an option <code>--spring.config.location</code> in your command.
Spring Boot allows end users to specify the <code>spring.config.location</code> Spring environment property as a command line option to specify an alternative location for the <code>application.properties</code> file.
Defining this option prevents picocli from throwing an <code>UnmatchedArgumentException</code> ("Unknown option") when it sees an option it cannot match.
You can make it a <code>hidden</code> option so it is not shown in the usage help message, or add a description that explains its meaning.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can define an <a href="#unmatched-annotation">unmatched</a> field to capture <em>all</em> unknown options (and positional parameters):</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Unmatched</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">unmatched</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Unmatched</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">unmatched</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/remkop/picocli/tree/master/picocli-spring-boot-starter">picocli-spring-boot-starter README</a> has another example of a picocli app integrated into Spring Boot.</p>
</div>
</div>
<div class="sect2">
<h3 id="_micronaut_example"><a class="anchor" href="#_micronaut_example"></a>22.3. Micronaut Example</h3>
<div class="paragraph">
<p><span class="image"><img src="https://micronaut.io/images/micronaut_mini_copy_tm.svg" alt="Micronaut Logo" width="350"></span></p>
</div>
<div class="paragraph">
<p>The Micronaut microservices framework provides <a href="https://docs.micronaut.io/latest/guide/index.html#picocli">built-in support</a> for picocli with its <code>PicocliRunner</code> class.</p>
</div>
<div class="paragraph">
<p>The micronaut example app below provides a command line interface to a HTTP client that can be used to retrieve the number of stars for a GitHub project via the GitHub REST API. Owner and name (called <code>slug</code>) of the project to be queried can be given as a command line parameter.</p>
</div>
<div class="paragraph">
<p>To get started, <a href="https://micronaut-projects.github.io/micronaut-starter/latest/guide/#installation">install</a> the Micronaut framework first.
Now you can use the <code>mn</code>  command line interface to generate your first project: <code>git-stars</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">mn create-cli-app git-stars <span class="nt">--features</span> http-client <span class="nt">--lang</span><span class="o">=</span>java
| Application created at /home/user/projects/micronaut/git-stars</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will create a self-contained micronaut project with picocli support, together with its dependencies, a gradle build script and test cases.
Don&#8217;t forget the <code>--features http-client</code> option, which will add the <code>io.micronaut:micronaut-http-client</code> dependency to the project.
Use <code>--lang=kotlin</code> or <code>--lang=groovy</code> to generate code for other languages.
Open the auto-generated source file <code>GitStarsCommand.java</code> and alter and extend it so that it looks like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Command</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.Parameters</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.micronaut.configuration.picocli.PicocliRunner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.micronaut.http.client.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.micronaut.http.client.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">io</span><span class="o">.</span><span class="na">micronaut</span><span class="o">.</span><span class="na">http</span><span class="o">.</span><span class="na">HttpRequest</span><span class="o">.*;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"git-stars"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Retrieve number of stars for a GitHub project"</span><span class="o">,</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GitStarsCommand</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Client</span><span class="o">(</span><span class="s">"https://api.github.com"</span><span class="o">)</span>
    <span class="nd">@Inject</span> <span class="nc">RxHttpClient</span> <span class="n">client</span><span class="o">;</span> <span class="c1">// example injected service</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"GitHub slug"</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"&lt;owner/repo&gt;"</span><span class="o">,</span>
                <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"remkop/picocli"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">slug</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">PicocliRunner</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="nc">GitStarsCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span> <span class="n">m</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="no">GET</span><span class="o">(</span><span class="s">"/repos/"</span> <span class="o">+</span> <span class="n">slug</span><span class="o">).</span><span class="na">header</span><span class="o">(</span>
                <span class="s">"User-Agent"</span><span class="o">,</span> <span class="s">"remkop-picocli"</span><span class="o">),</span> <span class="nc">Map</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">blockingFirst</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%s has %s stars%n"</span><span class="o">,</span> <span class="n">slug</span><span class="o">,</span> <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"stargazers_count"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">javax.inject.Inject</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Command</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Parameters</span>
<span class="k">import</span> <span class="nn">io.micronaut.configuration.picocli.PicocliRunner</span>
<span class="k">import</span> <span class="nn">io.micronaut.http.HttpRequest</span>
<span class="k">import</span> <span class="nn">io.micronaut.http.client.RxHttpClient</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"git-stars-kotlin"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Retrieve star count for GitHub project"</span><span class="p">],</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">GitStarsKotlinCommand</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>

    <span class="kd">val</span> <span class="py">URI_GitHub_API</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"https://api.github.com"</span>
    <span class="nd">@Inject</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">client</span><span class="p">:</span> <span class="nc">RxHttpClient</span> <span class="c1">// example injected service</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"GitHub slug"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"&lt;owner/repo&gt;"</span><span class="p">,</span>
        <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"remkop/picocli"</span><span class="p">)</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">slug</span><span class="p">:</span> <span class="nc">String</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">req</span> <span class="p">=</span> <span class="nc">HttpRequest</span><span class="p">.</span><span class="nc">GET</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;(</span><span class="s">"${URI_GitHub_API}/repos/$slug"</span><span class="p">)</span>
        <span class="n">req</span><span class="p">.</span><span class="nf">header</span><span class="p">(</span><span class="s">"User-Agent"</span><span class="p">,</span> <span class="s">"remkop-picocli"</span><span class="p">)</span>
        <span class="kd">val</span> <span class="py">flowable</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="nc">MutableMap</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">).</span><span class="nf">blockingFirst</span><span class="p">()</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"$slug has ${flowable.get("</span><span class="n">stargazers_count</span><span class="s">")} stars"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="nd">@JvmStatic</span> <span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="nc">PicocliRunner</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="nc">GitStarsKotlinCommand</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span> <span class="p">*</span><span class="n">args</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now run the app using the <code>gradle</code> build tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">cd </span>git-stars
./gradlew run <span class="nt">--args</span><span class="o">=</span><span class="s2">"micronaut-projects/micronaut-core"</span>
<span class="c"># ...</span>
<span class="o">&gt;</span> Task :run
21:12:17.660 <span class="o">[</span>main] INFO  i.m.context.env.DefaultEnvironment - Established active environments: <span class="o">[</span>cli]
micronaut-projects/micronaut-core has 4245 stars</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>mn</code> command line interface, you can add another command (including a test case) to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">mn create-command second
Rendered <span class="nb">command </span>to src/main/java/git/stars/SecondCommand.java
Rendered <span class="nb">command test </span>to src/test/java/git/stars/SecondCommandTest.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the auto-generated test cases for the previously created class, simply issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">mn <span class="nb">test</span> <span class="nt">--tests</span> git.stars.SecondCommandTest
<span class="c"># ...</span>
<span class="o">&gt;</span> :test <span class="o">&gt;</span> Executing <span class="nb">test </span>git.stars.SecondCommandTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://micronaut-projects.github.io/micronaut-picocli/latest/guide/#quickstart">quick start guide</a> for Micronaut&#8217;s Picocli integration has more information, including an extended <a href="https://micronaut-projects.github.io/micronaut-picocli/latest/guide/#_an_example_http_client">code sample</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_quarkus_example"><a class="anchor" href="#_quarkus_example"></a>22.4. Quarkus Example</h3>
<div class="paragraph">
<p><span class="image"><img src="https://quarkus.io/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" alt="Quarkus Logo" width="350"></span></p>
</div>
<div class="paragraph">
<p>Quarkus 1.5 added support for <a href="https://quarkus.io/guides/picocli#simple-command-line-application">Picocli Command Mode</a> applications, which allows to use Picocli in Quarkus applications easily.</p>
</div>
<div class="paragraph">
<p>The Quarkus example app below provides a command line interface to a mail client that can be used to send emails using an SMTP server.
<code>From</code> and <code>To</code> addresses have to be given as options, while a message body can be specified as parameter text.
The <code>headers</code> subcommand can be used to specify one or more custom header lines.</p>
</div>
<div class="paragraph">
<p>To get started, visit the <a href="https://code.quarkus.io/?g=info.picocli&amp;a=quarkus-example&amp;v=1.0.0-SNAPSHOT&amp;b=MAVEN&amp;s=baLo.UX2&amp;cn=code.quarkus.io">Quarkus Web Application Configurator</a> first.
Our example app depends on the extensions <code>Picocli</code> and <code>Mailer</code>, please note that these extension are selected already.
If you want to code your app in Kotlin, you need to add the <code>Kotlin</code> extension, too.
Now move your mouse over the button <code>Generate your application</code> and select <code>Download as zip</code>.
This will download a self-contained skeleton Quarkus project with picocli support, together with its dependencies, a maven build script and test cases.
Extract the archive file to a directory of your choice and open a shell or command prompt for this directory.
Now open the pre-authored source file <code>HelloCommando.java</code>, rename it to <code>MailCommando.java</code> and edit and extend it so that it looks like this:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.quarkus.mailer.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.quarkus.picocli.runtime.annotations.TopCommand</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.*</span><span class="o">;</span>

<span class="nd">@TopCommand</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span class="nd">@Command</span> <span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="nc">MailCommand</span><span class="o">.</span><span class="na">HeaderCommand</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">requiredOptionMarker</span> <span class="o">=</span> <span class="sc">'*'</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MailCommand</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="kd">private</span> <span class="nc">Mail</span> <span class="n">mail</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Mail</span><span class="o">();</span>
    <span class="nd">@Inject</span> <span class="nc">Mailer</span> <span class="n">mailer</span><span class="o">;</span>  <span class="c1">// Quarkus mailer</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--from"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"email address of sender"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">from</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--to"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"email(s) of recipient(s)"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">to</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--subject"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"Subject"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="n">subject</span><span class="o">;</span>

    <span class="nd">@Parameters</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Message to be sent"</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">body</span> <span class="o">=</span> <span class="o">{};</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">mail</span><span class="o">.</span><span class="na">setFrom</span><span class="o">(</span><span class="n">from</span><span class="o">)</span>   <span class="c1">// compose mail</span>
            <span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">to</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">" "</span><span class="o">,</span> <span class="n">body</span><span class="o">));</span>
       <span class="n">mailer</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">mail</span><span class="o">);</span>    <span class="c1">// send mail</span>
    <span class="o">}</span>

    <span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"headers"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"adding custom header line(s)"</span><span class="o">)</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">HeaderCommand</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">headerMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="nd">@ParentCommand</span> <span class="kd">private</span> <span class="nc">MailCommand</span> <span class="n">parent</span><span class="o">;</span>

        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--header"</span><span class="o">,</span> <span class="n">paramLabel</span> <span class="o">=</span> <span class="s">"KEY=VALUE"</span><span class="o">)</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setProperty</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">headers</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span><span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">headerMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">k</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">))));</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">parent</span><span class="o">.</span><span class="na">mail</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headerMap</span><span class="o">);</span>
            <span class="n">parent</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>MailCommand</code> parent class serves as entry point for the picocli command line.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The static inner <code>HeaderCommand</code> class represents the <code>headers</code> subcommand.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Since both the <code>MailCommand</code> class and the <code>HeaderCommand</code> class are annotated with the <code>picocli.CommandLine.Command</code> annotation, there is an ambiguity concerning the entry point of the app. This is resolved by annotating the <code>MailCommand</code> class with the <code>io.quarkus.picocli.runtime.annotations.TopCommand</code> annotation. As an alternative, this ambiguity can be resolved by specifying the <code>quarkus.picocli.top-command</code> property, too. This property takes precedence over the <code>TopCommand</code> annotation.</td>
</tr>
</table>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">io.quarkus.mailer.*</span>
<span class="k">import</span> <span class="nn">io.quarkus.picocli.runtime.annotations.TopCommand</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.*</span>
<span class="k">import</span> <span class="nn">javax.inject.Inject</span>
<span class="k">import</span> <span class="nn">kotlin.collections.HashMap</span>

<span class="nd">@TopCommand</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span class="nd">@Command</span><span class="p">(</span><span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">MailCommand</span><span class="p">.</span><span class="nc">HeaderCommand</span><span class="o">::</span><span class="k">class</span><span class="p">],</span> <span class="n">requiredOptionMarker</span> <span class="p">=</span> <span class="sc">'*'</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">MailCommand</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">mail</span> <span class="p">=</span> <span class="nc">Mail</span><span class="p">()</span>
    <span class="nd">@Inject</span> <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">mailer</span> <span class="p">:</span> <span class="nc">Mailer</span>   <span class="c1">// Quarkus mailer</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--from"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"email address of sender"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">from</span><span class="p">:</span> <span class="nc">String</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--to"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"email(s) of recipient(s)"</span><span class="p">],</span> <span class="n">required</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">to</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--subject"</span><span class="p">],</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Subject"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">subject</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="nd">@Parameters</span><span class="p">(</span><span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Message to be sent"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">body</span> <span class="p">=</span> <span class="n">arrayOf</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">mail</span><span class="p">.</span><span class="nf">setFrom</span><span class="p">(</span><span class="n">from</span><span class="p">)</span> <span class="c1">// compose mail</span>
            <span class="p">.</span><span class="nf">setTo</span><span class="p">(</span><span class="n">to</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">setSubject</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">body</span><span class="p">.</span><span class="nf">joinToString</span><span class="p">(</span><span class="n">separator</span> <span class="p">=</span> <span class="s">" "</span><span class="p">)</span>
        <span class="n">mailer</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">mail</span><span class="p">)</span> <span class="c1">// send mail</span>
    <span class="p">}</span>

    <span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"headers"</span><span class="p">,</span> <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"adding custom header line(s)"</span><span class="p">])</span>
    <span class="k">internal</span> <span class="kd">class</span> <span class="nc">HeaderCommand</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="k">private</span> <span class="kd">val</span> <span class="py">headerMap</span><span class="p">:</span> <span class="nc">MutableMap</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> <span class="nc">HashMap</span><span class="p">()</span>
        <span class="nd">@ParentCommand</span> <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">parent</span><span class="p">:</span> <span class="nc">MailCommand</span>

        <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--header"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"KEY=VALUE"</span><span class="p">)</span>
        <span class="k">fun</span> <span class="nf">setProperty</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="n">headers</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span> <span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">-&gt;</span>
                <span class="n">headerMap</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(*</span><span class="n">v</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">" "</span><span class="p">).</span><span class="nf">toTypedArray</span><span class="p">())</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">parent</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">headers</span> <span class="p">=</span> <span class="n">headerMap</span>
            <span class="n">parent</span><span class="p">.</span><span class="nf">run</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>MailCommand</code> parent class serves as the entry point for the picocli command line.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The inner <code>HeaderCommand</code> class represents the <code>headers</code> subcommand.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Since both the <code>MailCommand</code> class and the <code>HeaderCommand</code> class are annotated with the <code>picocli.CommandLine.Command</code> annotation, there is an ambiguity concerning the entry point of the app. This is resolved by annotating the <code>MailCommand</code> class with the <code>io.quarkus.picocli.runtime.annotations.TopCommand</code> annotation. As an alternative, this ambiguity can be resolved by specifying the <code>quarkus.picocli.top-command</code> property, too. This property takes precedence over the <code>TopCommand</code> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you are done with coding, you can use the maven wrapper <code>mvnw</code> to compile and run our example app:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvnw compile quarkus:dev
# ...
Missing required options: '--from=&lt;from&gt;', '--to=&lt;to&gt;'
Usage: &lt;main class&gt; --from=&lt;from&gt; [--subject=&lt;subject&gt;] --to=&lt;to&gt;
                    [--to=&lt;to&gt;]... [&lt;body&gt;...] [COMMAND]
      [&lt;body&gt;...]           Message to be sent
*     --from=&lt;from&gt;         email address of sender
*     --to=&lt;to&gt;             email(s) of recipient(s)
      --subject=&lt;subject&gt;   Subject
Commands:
  header  adding custom header line(s)</pre>
</div>
</div>
<div class="paragraph">
<p>Since we specified no command line arguments, Picocli complains about the missing required options <code>--from</code> and <code>--to</code> and outputs the usage help.
We have to pass in command line arguments into our command line call, we can use <code>-Dquarkus.args=our_values</code> for that purpose:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvnw compile quarkus:dev -Dquarkus.args="--from john@doe.info --to hans@mustermann.de \
    --to zhang@san.cn Easy mailing with Quarkus and picocli"
# ...
2020-10-29 10:59:22,197 INFO  [quarkus-mailer] (Quarkus Main Thread) Sending email null from john@doe.info to [hans@mustermann.de, zhang@san.cn], text body:
Easy mailing with Quarkus and picocli
html body:
&lt;empty&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>With all required options and parameters specified, a mail is sent successfully.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Sending emails in a development and production systems</div>
<div class="paragraph">
<p>If you are running Quarkus in DEV or TEST mode, mails are not actually sent, but printed on <code>STDOUT</code> and collected in a <code>MockMailbox</code> bean instead.
In a production system, to have to set the boolean configuration value <code>quarkus.mailer.mock</code> to <code>true</code>. Additionally to need to give further configuration values (STMP host name, â¦ inside the file <code>src/main/resources/application.properties</code>.
Please refer to the Quarkus guide <a href="https://quarkus.io/guides/mailer">Sending Emails</a> for details and additional information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an extra, our command line interface offers the opportunity to specify one ore more custom header lines via the <code>headers</code> subcommand, more specifically via the <code>--header</code> option (<code>KEY="MY VALUE STRINGS"</code>) of this subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./mvnw compile quarkus:dev -Dquarkus.args="--from= ... --to ... body message headers \
    --header X-Mailer=Picocli/Quarkus --header X-Mailer-Version=1.0"
# ...</pre>
</div>
</div>
<div class="paragraph">
<p>This command will add two additional custom header lines to our mail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>From: john@doe.info
To: hans@mustermann.de
X-Mailer: Picocli/Quarkus  <i class="conum" data-value="1"></i><b>(1)</b>
X-Mailer-Version: 1.0      <i class="conum" data-value="2"></i><b>(2)</b>
# ...</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom header line 1, starting with <code>X-</code> as defined in <a href="https://tools.ietf.org/html/rfc822">RFC 822</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Custom header line 2</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Quarkus guide for the <a href="https://quarkus.io/guides/picocli">Command mode with Picocli</a> has extended information on the Quarkus Picocli integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cdi_2_0_jsr_365"><a class="anchor" href="#_cdi_2_0_jsr_365"></a>22.5. CDI 2.0 (JSR 365)</h3>
<div class="paragraph">
<p>If your application runs in a dependency injection container that does not offer explicit support for picocli, it may still be possible to get dependency injection in your picocli commands, subcommands and other classes like version providers, default providers, type converters, etc.</p>
</div>
<div class="paragraph">
<p>In essence, all that is needed is an implementation of the <code>picocli.CommandLine.IFactory</code> interface that gets objects from the dependency injection container instead of instantiating them directly.</p>
</div>
<div class="paragraph">
<p>Below is an example CDI factory that works for any container that implements the <a href="https://docs.jboss.org/cdi/spec/2.0/cdi-spec.html">Contexts and Dependency Injection for Java 2.0</a> specification (JSR 365).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">javax.enterprise.context.ApplicationScoped</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.inject.Instance</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.inject.spi.CDI</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">picocli.CommandLine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">picocli.CommandLine.IFactory</span><span class="o">;</span>

<span class="cm">/**
 * Factory used by picocli to look up subcommands and other classes
 * in the CDI container before instantiating them directly,
 * to support dependency injection in subcommands and other classes.
 */</span>
<span class="nd">@ApplicationScoped</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CDIFactory</span> <span class="kd">implements</span> <span class="nc">IFactory</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IFactory</span> <span class="n">fallbackFactory</span> <span class="o">=</span> <span class="nc">CommandLine</span><span class="o">.</span><span class="na">defaultFactory</span><span class="o">();</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="no">K</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">cls</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Instance</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">instance</span> <span class="o">=</span> <span class="no">CDI</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">select</span><span class="o">(</span><span class="n">cls</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">instance</span><span class="o">.</span><span class="na">isResolvable</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">defaultFactory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">cls</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>How to use the above factory depends on the specific container, but in general it would look something like the below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"cdi-app"</span><span class="o">,</span> <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyCDIApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">{</span><span class="s">"-x"</span><span class="o">,</span> <span class="s">"--option"</span><span class="o">},</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"example option"</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="n">flag</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// business logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CDIFactory</span> <span class="n">cdiFactory</span> <span class="o">=</span> <span class="no">CDI</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">select</span><span class="o">(</span><span class="nc">CDIFactory</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="nc">MyCDIApp</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">cdiFactory</span><span class="o">).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_9_jpms_modules"><a class="anchor" href="#_java_9_jpms_modules"></a>23. Java 9 JPMS Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The main <code>picocli-${version}.jar</code> is a JPMS module named <code>info.picocli</code>.</p>
</div>
<div class="paragraph">
<p>Starting from picocli 4.0, this jar will be an explicit module instead of an automatic module,
so the <a href="https://docs.oracle.com/en/java/javase/12/tools/jlink.html"><code>jlink</code> tool</a> can be used to provide a trimmed binary image that has only the required modules.
(Note that <a href="https://medium.com/azulsystems/using-jlink-to-build-java-runtimes-for-non-modular-applications-9568c5e70ef4">there are ways</a> to use jlink with non-modular applications.)</p>
</div>
<div class="paragraph">
<p>Typically, a modular jar includes the <code>module-info.class</code> file in its root directory.
This causes problems for some older tools, which incorrectly process the module descriptor as if it were a normal Java class.
To provide the best backward compatibility, the main picocli artifact is a <a href="https://openjdk.java.net/jeps/238#Modular-multi-release-JAR-files">modular multi-release jar</a> with the <code>module-info.class</code> file located in <code>META-INF/versions/9</code>.</p>
</div>
<div class="sect2">
<h3 id="_module_configuration"><a class="anchor" href="#_module_configuration"></a>23.1. Module Configuration</h3>
<div class="paragraph">
<p>Applications that use Java 9&#8217;s modules need to configure their module to allow picocli reflective access to the annotated classes and fields.</p>
</div>
<div class="paragraph">
<p>Often applications want the annotated classes and fields to be <strong>private</strong>; there should be no need to make them part of the exported API of your module just to allow picocli to access them. The below settings make this possible.</p>
</div>
<div class="paragraph">
<p>Example <code>module-info.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>module com.yourorg.yourapp {
   requires info.picocli;

   // Open this package for reflection to external frameworks.
   opens your.package.using.picocli;

   // or: limit access to picocli only
   opens other.package.using.picocli to info.picocli;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that neither package is <code>exported</code>, so other modules cannot accidentally compile against types in these packages.</p>
</div>
<div class="paragraph">
<p>Alternatively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>// open all packages in the module to reflective access
open module com.yourorg.yourapp {
   requires info.picocli;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_osgi_bundle"><a class="anchor" href="#_osgi_bundle"></a>24. OSGi Bundle</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="https://www.osgi.org/wp-content/uploads/OSGi-website-header-logo.png" alt="OSGi logo"></span></p>
</div>
<div class="paragraph">
<p>From 4.0, the picocli JAR is an OSGi bundle with <code>Bundle-Name: picocli</code> and other appropriate metadata in the manifest.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tracing"><a class="anchor" href="#_tracing"></a>25. Tracing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli 1.0 introduced support for parser tracing to facilitate troubleshooting.</p>
</div>
<div class="paragraph">
<p>System property <code>picocli.trace</code> controls the trace level. Supported levels are <code>OFF</code>, <code>WARN</code>, <code>INFO</code>, and <code>DEBUG</code>. The default trace level is <code>WARN</code>.</p>
</div>
<div class="paragraph">
<p>Specifying system property <code>-Dpicocli.trace</code> without a value will set the trace level to <code>INFO</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DEBUG: Shows details of the decisions made by the parser during command line parsing.</p>
</li>
<li>
<p>INFO: Shows a high-level overview of what happens during command line parsing.</p>
</li>
<li>
<p>WARN: The default. Shows warnings instead of errors when lenient parsing is enabled:
when single-value options were specified multiple times (and <code>CommandLine.overwrittenOptionsAllowed</code> is <code>true</code>),
or when command line arguments could not be matched as an option or positional parameter
(and <code>CommandLine.unmatchedArgumentsAllowed</code> is <code>true</code>).</p>
</li>
<li>
<p>OFF: Suppresses all tracing including warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># create a custom 'git' command that invokes picocli.Demo$Git with tracing switched on</span>
<span class="nb">alias </span><span class="nv">git</span><span class="o">=</span><span class="s1">'java -Dpicocli.trace -cp picocli-all.jar picocli.Demo$Git'</span>

<span class="c"># invoke our command with some parameters</span>
git <span class="nt">--git-dir</span><span class="o">=</span>/home/rpopma/picocli commit <span class="nt">-m</span> <span class="s2">"Fixed typos"</span> <span class="nt">--</span> src1.java src2.java src3.java

<span class="c"># remove our 'git' pseudonym from the current shell environment</span>
<span class="nb">unalias </span>git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[picocli INFO] Parsing 8 command line args [--git-dir=/home/rpopma/picocli, commit, -m, "Fixed typos", --, src1.java, src2.java, src3.java]
[picocli INFO] Setting File field 'Git.gitDir' to '\home\rpopma\picocli' for option --git-dir
[picocli INFO] Adding [Fixed typos] to List&lt;String&gt; field 'GitCommit.message' for option -m
[picocli INFO] Found end-of-options delimiter '--'. Treating remainder as positional parameters.
[picocli INFO] Adding [src1.java] to List&lt;String&gt; field 'GitCommit.files' for args[0..*]
[picocli INFO] Adding [src2.java] to List&lt;String&gt; field 'GitCommit.files' for args[0..*]
[picocli INFO] Adding [src3.java] to List&lt;String&gt; field 'GitCommit.files' for args[0..*]</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tab_autocomplete"><a class="anchor" href="#_tab_autocomplete"></a>26. TAB Autocomplete</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli-based applications can now have command line completion in Bash or Zsh Unix shells.
See the <a href="autocomplete.html">Autocomplete for Java Command Line Applications</a> manual for how to generate an autocompletion script tailored to your application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generate_man_page_documentation"><a class="anchor" href="#_generate_man_page_documentation"></a>27. Generate Man Page Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From picocli 4.2, the <code>picocli-codegen</code> module has a <code>ManPageGenerator</code> tool that can generate AsciiDoc documentation using the <code>manpage</code> doctype and manpage document structure.
The generated AsciiDoc files can be converted to HTML, PDF and unix man pages with the wonderful <a href="https://asciidoctor.org/docs/user-manual/#man-pages">asciidoctor</a> tool.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen#generate-documentation">Generate Documentation</a> section of the <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen">picocli-codegen README</a> for details on how to generate and customize this documentation.</p>
</div>
<div class="paragraph">
<p>To see some examples, the man pages for the picocli built-in tools were created with this tool:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="man/gen-manpage.html">gen-manpage</a> (<code>picocli.codegen.docgen.manpage.ManPageGenerator</code>)</p>
</li>
<li>
<p><a href="man/picocli.AutoComplete.html">picocli.AutoComplete</a> (<code>picocli.AutoComplete</code>)</p>
</li>
<li>
<p><a href="man/generate-completion.html">generate-completion</a> (<code>picocli.AutoComplete$GenerateCompletion</code> - to be used as a subcommand)</p>
</li>
<li>
<p><a href="man/gen-reflect-config.html">gen-reflect-config</a> (<code>picocli.codegen.aot.graalvm.ReflectionConfigGenerator</code>)</p>
</li>
<li>
<p><a href="man/gen-proxy-config.html">gen-proxy-config</a> (<code>picocli.codegen.aot.graalvm.DynamicProxyConfigGenerator</code>)</p>
</li>
<li>
<p><a href="man/gen-resource-config.html">gen-resource-config</a> (<code>picocli.codegen.aot.graalvm.ResourceConfigGenerator</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From picocli 4.4, this tool can be used as a <a href="#_subcommands">subcommand</a> in your application, with the usual syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">picocli.codegen.docgen.manpage.ManPageGenerator</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">subcommands</span> <span class="o">=</span> <span class="nc">ManPageGenerator</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="o">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the <code>ManPageGenerator</code> tool as a subcommand, you will need the <code>picocli-codegen</code> jar in your classpath.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_your_application"><a class="anchor" href="#_testing_your_application"></a>28. Testing Your Application</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_black_box_and_white_box_testing"><a class="anchor" href="#_black_box_and_white_box_testing"></a>28.1. Black Box and White Box Testing</h3>
<div class="paragraph">
<p>Picocli 4.0 introduced the <a href="#execute"><code>execute</code></a>, <code>get/setOut</code>, and <code>get/setErr</code> APIs that make testing a lot easier.</p>
</div>
<div class="paragraph">
<p>Applications can do black box testing by verifying the exit code and the output of the program to the standard output stream and standard error stream.</p>
</div>
<div class="paragraph">
<p>Additionally, you can do white box testing by keeping a reference to the application and asserting on its state after giving it various command line inputs.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">MyApp</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyApp</span><span class="o">();</span>
<span class="nc">CommandLine</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">app</span><span class="o">);</span>

<span class="nc">StringWriter</span> <span class="n">sw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringWriter</span><span class="o">();</span>
<span class="n">cmd</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="n">sw</span><span class="o">));</span>

<span class="c1">// black box testing</span>
<span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"-x"</span><span class="o">,</span> <span class="s">"-y=123"</span><span class="o">);</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">exitCode</span><span class="o">);</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="s">"Your output is abc..."</span><span class="o">,</span> <span class="n">sw</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>

<span class="c1">// white box testing</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="s">"expectedValue1"</span><span class="o">,</span> <span class="n">app</span><span class="o">.</span><span class="na">getState1</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="s">"expectedValue2"</span><span class="o">,</span> <span class="n">app</span><span class="o">.</span><span class="na">getState2</span><span class="o">());</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">MyApp</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">cmd</span> <span class="p">=</span> <span class="nc">CommandLine</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="kd">val</span> <span class="py">sw</span> <span class="p">=</span> <span class="nc">StringWriter</span><span class="p">()</span>
<span class="n">cmd</span><span class="p">.</span><span class="k">out</span> <span class="p">=</span> <span class="nc">PrintWriter</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>

<span class="c1">// black box testing</span>
<span class="kd">val</span> <span class="py">exitCode</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="s">"-x"</span><span class="p">,</span> <span class="s">"-y=123"</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">exitCode</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"Your output is abc..."</span><span class="p">,</span> <span class="n">sw</span><span class="p">.</span><span class="nf">toString</span><span class="p">())</span>

<span class="c1">// white box testing</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"expectedValue1"</span><span class="p">,</span> <span class="n">app</span><span class="p">.</span><span class="n">state1</span><span class="p">)</span>
<span class="nf">assertEquals</span><span class="p">(</span><span class="s">"expectedValue2"</span><span class="p">,</span> <span class="n">app</span><span class="p">.</span><span class="n">state2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This assumes that the application uses the <code>PrintWriter</code> provided by <a href="https://picocli.info/apidocs/picocli/CommandLine.html#getOut--"><code>CommandLine.getOut</code></a> or  <a href="https://picocli.info/apidocs/picocli/CommandLine.html#getErr--"><code>CommandLine.getErr</code></a>.
Applications can get these writers via the <a href="#spec-annotation"><code>@Spec</code></a> annotation:</p>
</div>
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="nd">@Spec</span> <span class="nc">CommandSpec</span> <span class="n">spec</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// make testing easier by printing to the Err and Out streams provided by picocli</span>
        <span class="n">spec</span><span class="o">.</span><span class="na">commandLine</span><span class="o">().</span><span class="na">getOut</span><span class="o">().</span><span class="na">println</span><span class="o">(</span><span class="s">"Your output is abc..."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Runnable</span> <span class="p">{</span>
    <span class="nd">@Spec</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">spec</span><span class="p">:</span> <span class="nc">CommandSpec</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// make testing easier by printing to the Err and Out streams provided by picocli</span>
        <span class="n">spec</span><span class="p">.</span><span class="nf">commandLine</span><span class="p">().</span><span class="k">out</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">"Your output is abc..."</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_output"><a class="anchor" href="#_testing_the_output"></a>28.2. Testing the Output</h3>
<div class="paragraph">
<p>Applications that print to <code>System.out</code> or <code>System.err</code> directly, or use a version of picocli lower than 4.0, can be tested by capturing the standard output and error streams.
There are various options for doing this, some of which are shown below.</p>
</div>
<div class="sect3">
<h4 id="_java_8_with_system_lambda"><a class="anchor" href="#_java_8_with_system_lambda"></a>28.2.1. Java 8+ with System-Lambda</h4>
<div class="paragraph">
<p>Applications that use JUnit 5 or Java 8+ can use Stephan Birkner&#8217;s <a href="https://github.com/stefanbirkner/system-lambda">System-Lambda</a> project for capturing output.
This library has facilities for capturing the standard output and standard error streams separately or mixed together, and for normalizing line breaks.</p>
</div>
<div class="paragraph">
<p>Example usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">github</span><span class="o">.</span><span class="na">stefanbirkner</span><span class="o">.</span><span class="na">systemlambda</span><span class="o">.</span><span class="na">SystemLambda</span><span class="o">.</span><span class="na">tapSystemErr</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">github</span><span class="o">.</span><span class="na">stefanbirkner</span><span class="o">.</span><span class="na">systemlambda</span><span class="o">.</span><span class="na">SystemLambda</span><span class="o">.</span><span class="na">tapSystemOutNormalized</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testMyApp</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">errText</span> <span class="o">=</span> <span class="n">tapSystemErr</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">outText</span> <span class="o">=</span> <span class="n">tapSystemOutNormalized</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="s">"--option=value"</span><span class="o">,</span> <span class="s">"arg0"</span><span class="o">,</span> <span class="s">"arg1"</span><span class="o">);</span>
            <span class="o">});</span>
            <span class="n">assertEquals</span><span class="o">(</span><span class="s">"--option='value'\n"</span> <span class="o">+</span>
                         <span class="s">"position[0]='arg0'\n"</span> <span class="o">+</span>
                         <span class="s">"position[1]='arg1'\n"</span><span class="o">,</span> <span class="n">outText</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="n">errText</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_junit_4_with_system_rules"><a class="anchor" href="#_junit_4_with_system_rules"></a>28.2.2. JUnit 4 with System-Rules</h4>
<div class="paragraph">
<p>Applications that use JUnit 4 can use Stephan Birkner&#8217;s <a href="https://stefanbirkner.github.io/system-rules">System-Rules</a> project for capturing output.</p>
</div>
<div class="paragraph">
<p>Example usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.contrib.java.lang.system.SystemErrRule</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.contrib.java.lang.system.SystemOutRule</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Rule</span>
    <span class="nc">SystemErrRule</span> <span class="n">systemErrRule</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SystemErrRule</span><span class="o">().</span><span class="na">enableLog</span><span class="o">().</span><span class="na">muteForSuccessfulTests</span><span class="o">();</span>

    <span class="nd">@Rule</span>
    <span class="nc">SystemOutRule</span> <span class="n">systemOutRule</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SystemOutRule</span><span class="o">().</span><span class="na">enableLog</span><span class="o">().</span><span class="na">muteForSuccessfulTests</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testMyApp</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="s">"--option=value"</span><span class="o">,</span> <span class="s">"arg0"</span><span class="o">,</span> <span class="s">"arg1"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">expected</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"--option='value'%n"</span> <span class="o">+</span>
                                        <span class="s">"position[0]='arg0'%n"</span> <span class="o">+</span>
                                        <span class="s">"position[1]='arg1'%n"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="n">expected</span><span class="o">,</span> <span class="n">systemOutRule</span><span class="o">.</span><span class="na">getLog</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="n">systemErrRule</span><span class="o">.</span><span class="na">getLog</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_diy_output_capturing"><a class="anchor" href="#_diy_output_capturing"></a>28.2.3. DIY Output Capturing</h4>
<div class="paragraph">
<p>It is also possible to capture output in the tests yourself without using a library.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">ByteArrayOutputStream</span> <span class="n">err</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
<span class="nc">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
<span class="nc">PrintStream</span> <span class="n">oldErr</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">;</span>
<span class="nc">PrintStream</span> <span class="n">oldOut</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">setErr</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintStream</span><span class="o">(</span><span class="n">err</span><span class="o">));</span>           <span class="c1">// setup</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintStream</span><span class="o">(</span><span class="n">out</span><span class="o">));</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="s">"my command args"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>  <span class="c1">// test</span>
    <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">setErr</span><span class="o">(</span><span class="n">oldErr</span><span class="o">);</span>                         <span class="c1">// teardown</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="n">oldOut</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="s">"MY COMMAND OUTPUT"</span><span class="o">,</span> <span class="n">out</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span> <span class="c1">// verify</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="n">err</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This looks verbose, but can be simplified a lot by letting the test framework do the setup and cleanup.</p>
</div>
<div class="paragraph">
<p>JUnit 4 lets you do setup in a <code>@org.junit.Before</code>-annotated method and teardown in an <code>@org.junit.After</code>-annotated method.
The JUnit 5 equivalent annotations are <code>@org.junit.jupiter.api.BeforeEach</code> and <code>@org.junit.jupiter.api.AfterEach</code>, respectively.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">//import org.junit.After;  // JUnit 4</span>
<span class="c1">//import org.junit.Before; // JUnit 4</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="o">;</span>  <span class="c1">// JUnit 5</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span> <span class="c1">// JUnit 5</span>
<span class="c1">//...</span>
<span class="kd">class</span> <span class="nc">TestOutput</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="nc">PrintStream</span> <span class="n">originalOut</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="kd">final</span> <span class="nc">PrintStream</span> <span class="n">originalErr</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">;</span>
    <span class="kd">final</span> <span class="nc">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
    <span class="kd">final</span> <span class="nc">ByteArrayOutputStream</span> <span class="n">err</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>

    <span class="c1">//@Before   // JUnit 4</span>
    <span class="nd">@BeforeEach</span> <span class="c1">// JUnit 5</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUpStreams</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">out</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
        <span class="n">err</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintStream</span><span class="o">(</span><span class="n">out</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setErr</span><span class="o">(</span><span class="k">new</span> <span class="nc">PrintStream</span><span class="o">(</span><span class="n">err</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">//@After   // JUnit 4</span>
    <span class="nd">@AfterEach</span> <span class="c1">// JUnit 5</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">restoreStreams</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="n">originalOut</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setErr</span><span class="o">(</span><span class="n">originalErr</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="s">"my command args"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
        <span class="k">new</span> <span class="nf">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"MY COMMAND OUTPUT"</span><span class="o">,</span> <span class="n">out</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="n">err</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_exit_code"><a class="anchor" href="#_testing_the_exit_code"></a>28.3. Testing the Exit Code</h3>
<div class="paragraph">
<p>Testing the exit code of applications that call <code>System.exit</code> can be tricky but is not impossible.
Depending on your programming language, your environment and your testing framework, you have several options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Java 8</strong>: You can use Stephan Birkner&#8217;s <a href="https://github.com/stefanbirkner/system-lambda">System-Lambda</a> project for testing the <a href="https://github.com/stefanbirkner/system-lambda#systemexit">exit code</a></p>
</li>
<li>
<p><strong>Java/Kotlin + Junit 5</strong>: You can use Todd Ginsberg&#8217;s <a href="https://github.com/tginsberg/junit5-system-exit">System.exit()</a> extension for Junit 5. The project README mentions common <a href="https://github.com/tginsberg/junit5-system-exit#use-cases">use cases</a>.</p>
</li>
<li>
<p><strong>Java + Junit 4</strong>: You can use Stephan Birkner&#8217;s <a href="https://stefanbirkner.github.io/system-rules">System-Rules</a> project for testing the <a href="https://stefanbirkner.github.io/system-rules/#ExpectedSystemExit">exit code</a>.</p>
</li>
<li>
<p><strong>Kotlin + Kotest</strong>: Kotlin coders you may use the <a href="https://kotest.io/">Kotest</a> test framework which comes with <a href="https://kotest.io/docs/extensions/system_extensions.html#system-exit-extensions">System Exit extensions</a> that allow you to test the exit code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The listing below provides code samples for all of the four options mentioned above:</p>
</div>
<div class="listingblock primary">
<div class="title">Java 8</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">github</span><span class="o">.</span><span class="na">stefanbirkner</span><span class="o">.</span><span class="na">systemlambda</span><span class="o">.</span><span class="na">SystemLambda</span><span class="o">.</span><span class="na">catchSystemExit</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Command</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hi"</span><span class="o">);</span>
            <span class="k">return</span> <span class="mi">42</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testMyAppExit</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">catchSystemExit</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">MyApp</span><span class="o">.</span><span class="na">main</span><span class="o">();</span>
        <span class="o">});</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="n">exitCode</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Java/Junit 5</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">com.ginsberg.junit.exit.ExpectSystemExitWithStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Command</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hi"</span><span class="o">);</span>
            <span class="k">return</span> <span class="mi">42</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@ExpectSystemExitWithStatus</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">testMyAppExit</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MyApp</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">[]</span> <span class="o">{});</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Java/Junit 4</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.Rule</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.contrib.java.lang.system.ExpectedSystemExit</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Rule</span> <span class="kd">public</span> <span class="kd">final</span> <span class="nc">ExpectedSystemExit</span> <span class="n">exit</span> <span class="o">=</span> <span class="nc">ExpectedSystemExit</span><span class="o">.</span><span class="na">none</span><span class="o">();</span>

    <span class="nd">@Command</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hi"</span><span class="o">);</span>
            <span class="k">return</span> <span class="mi">42</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testExitCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">exit</span><span class="o">.</span><span class="na">expectSystemExitWithStatus</span><span class="o">(</span><span class="mi">42</span><span class="o">);</span>
        <span class="nc">MyApp</span><span class="o">.</span><span class="na">main</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin/Kotest</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">io.kotest.assertions.throwables.shouldThrow</span>
<span class="k">import</span> <span class="nn">io.kotest.core.spec.style.StringSpec</span>
<span class="k">import</span> <span class="nn">io.kotest.extensions.system.*</span>
<span class="k">import</span> <span class="nn">io.kotest.matchers.shouldBe</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">SystemExitTest</span> <span class="p">:</span> <span class="nc">StringSpec</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">listeners</span><span class="p">()</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="nc">SpecSystemExitListener</span><span class="p">)</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="s">"Picocli app should exit process with return code 42"</span> <span class="p">{</span>
            <span class="n">shouldThrow</span><span class="p">&lt;</span><span class="nc">SystemExitException</span><span class="p">&gt;</span> <span class="p">{</span>
                <span class="nf">main</span><span class="p">(</span><span class="nf">arrayOf</span><span class="p">())</span>
            <span class="p">}.</span><span class="n">exitCode</span> <span class="n">shouldBe</span> <span class="mi">42</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">PicocliApp</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">42</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">:</span> <span class="nc">Unit</span> <span class="p">=</span> <span class="nf">exitProcess</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">PicocliApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_environment_variables"><a class="anchor" href="#_testing_environment_variables"></a>28.4. Testing Environment Variables</h3>
<div class="paragraph">
<p>Since picocli offers support for using <a href="#_variable_interpolation">environment variables</a> in the annotations, you may want to test this.
Depending on your programming language, your environment and your testing framework, you have several options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Java 8</strong>: You can use Stephan Birkner&#8217;s <a href="https://github.com/stefanbirkner/system-lambda">System-Lambda</a> project for testing <a href="https://github.com/stefanbirkner/system-lambda#environment-variables">environment variables</a></p>
</li>
<li>
<p><strong>Java + Junit 4</strong>: You can use Stephan Birkner&#8217;s <a href="https://stefanbirkner.github.io/system-rules">System-Rules</a> project for testing the <a href="https://stefanbirkner.github.io/system-rules/#EnvironmentVariables">environment variables</a>.</p>
</li>
<li>
<p><strong>Kotlin + Kotest</strong>: Kotlin coders you may use the <a href="https://kotest.io/">Kotest</a> test framework which comes with <a href="https://kotest.io/docs/extensions/system_extensions.html#system-environment">System Environment</a> extension that allow you to test environment variables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The listing below provides code samples for the three options mentioned above:</p>
</div>
<div class="listingblock primary">
<div class="title">Java 8</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">github</span><span class="o">.</span><span class="na">stefanbirkner</span><span class="o">.</span><span class="na">systemlambda</span><span class="o">.</span><span class="na">SystemLambda</span><span class="o">.</span><span class="na">withEnvironmentVariable</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">testEnvVar</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
        <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--option"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"${env:MYVAR}"</span><span class="o">,</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s">"Some option. Default: ${DEFAULT-VALUE}"</span><span class="o">)</span>
        <span class="nc">String</span> <span class="n">option</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nc">String</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">withEnvironmentVariable</span><span class="o">(</span><span class="s">"MYVAR"</span><span class="o">,</span> <span class="s">"some-value"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="s">"OTHER_VAR"</span><span class="o">,</span> <span class="s">"second value"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
                            <span class="o">.</span><span class="na">getUsageMessage</span><span class="o">(</span><span class="nc">CommandLine</span><span class="o">.</span><span class="na">Help</span><span class="o">.</span><span class="na">Ansi</span><span class="o">.</span><span class="na">OFF</span><span class="o">));</span>

    <span class="nc">String</span> <span class="n">expected</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">""</span> <span class="o">+</span>
            <span class="s">"Usage: &lt;main class&gt; [--option=&lt;option&gt;]%n"</span> <span class="o">+</span>
            <span class="s">"      --option=&lt;option&gt;   Some option. Default: some-value%n"</span><span class="o">);</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="n">expected</span><span class="o">,</span> <span class="n">actual</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Java/JUnit 4</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.junit.contrib.java.lang.system.EnvironmentVariables</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    <span class="nd">@Rule</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">EnvironmentVariables</span> <span class="n">environmentVariables</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EnvironmentVariables</span><span class="o">();</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testEnvVar</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">class</span> <span class="nc">MyApp</span> <span class="o">{</span>
            <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s">"--option"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"${env:MYVAR}"</span><span class="o">,</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="s">"Some option. Default: ${DEFAULT-VALUE}"</span><span class="o">)</span>
            <span class="nc">String</span> <span class="n">option</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">environmentVariables</span><span class="o">.</span><span class="na">clear</span><span class="o">(</span><span class="s">"MYVAR"</span><span class="o">,</span> <span class="s">"OTHER_VAR"</span><span class="o">,</span> <span class="s">"THIRD_VAR"</span><span class="o">);</span>
        <span class="n">environmentVariables</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"MYVAR"</span><span class="o">,</span> <span class="s">"some-value"</span><span class="o">);</span>
        <span class="n">environmentVariables</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"OTHER_VAR"</span><span class="o">,</span> <span class="s">"second value"</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">actual</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">())</span>
                <span class="o">.</span><span class="na">getUsageMessage</span><span class="o">(</span><span class="nc">CommandLine</span><span class="o">.</span><span class="na">Help</span><span class="o">.</span><span class="na">Ansi</span><span class="o">.</span><span class="na">OFF</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">expected</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">""</span> <span class="o">+</span>
                <span class="s">"Usage: &lt;main class&gt; [--option=&lt;option&gt;]%n"</span> <span class="o">+</span>
                <span class="s">"      --option=&lt;option&gt;   Some option. Default: some-value%n"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="n">expected</span><span class="o">,</span> <span class="n">actual</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Kotlin/Kotest</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="k">import</span> <span class="nn">io.kotest.core.spec.style.StringSpec</span>
<span class="k">import</span> <span class="nn">io.kotest.extensions.system.withEnvironment</span>
<span class="k">import</span> <span class="nn">io.kotest.matchers.shouldBe</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine</span>
<span class="k">import</span> <span class="nn">picocli.CommandLine.Command</span>

<span class="kd">class</span> <span class="nc">EnvironmentVarTest</span> <span class="p">:</span> <span class="nc">StringSpec</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">init</span> <span class="p">{</span>
        <span class="s">"env var"</span> <span class="p">{</span>
            <span class="nf">withEnvironment</span><span class="p">(</span><span class="nf">mapOf</span><span class="p">(</span><span class="s">"MYVAR"</span> <span class="n">to</span> <span class="s">"some-value"</span><span class="p">,</span> <span class="s">"OTHER_VAR"</span> <span class="n">to</span> <span class="s">"second value"</span><span class="p">))</span> <span class="p">{</span>
                <span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">getUsageMessage</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">.</span><span class="nc">Help</span><span class="p">.</span><span class="nc">Ansi</span><span class="p">.</span><span class="nc">OFF</span><span class="p">)</span> <span class="n">shouldBe</span>
                <span class="s">"Usage: &lt;main class&gt; [--option=&lt;option&gt;]"</span> <span class="p">+</span> <span class="nc">System</span><span class="p">.</span><span class="nf">lineSeparator</span><span class="p">()</span> <span class="p">+</span>
                <span class="s">"      --option=&lt;option&gt;   Some option. Default: some-value"</span> <span class="p">+</span> <span class="nc">System</span><span class="p">.</span><span class="nf">lineSeparator</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Command</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">{</span>
    <span class="nd">@CommandLine</span><span class="p">.</span><span class="nc">Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"--option"</span><span class="p">],</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">"\${env:MYVAR}"</span><span class="p">,</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Some option. Default: \${DEFAULT-VALUE}"</span><span class="p">])</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">option</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The latest versions of <code>com.github.stefanbirkner:system-rules</code>, 1.18 and 1.19, have an <a href="https://github.com/stefanbirkner/system-rules/issues/70">issue</a> that means the Environment Variables rule will not work in JUnit 5. Use System Rules version 1.17.2 instead when combining with JUnit 5.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mocking"><a class="anchor" href="#_mocking"></a>28.5. Mocking</h3>
<div class="paragraph">
<p>If you prefer to use mocking in your tests, there are several frameworks available.
This document will only cover some relevant aspects of some mocking frameworks based on feedback from the picocli community.</p>
</div>
<div class="sect3">
<h4 id="_mocking_subcommands_with_mockito"><a class="anchor" href="#_mocking_subcommands_with_mockito"></a>28.5.1. Mocking subcommands with Mockito</h4>
<div class="paragraph">
<p>The <a href="https://site.mockito.org">Mockito</a> framework creates a synthetic class for a mocked class.
The generated class is a subclass of the mocked class and also copies all the annotations to the mock.
If you are mocking a command with subcommands this might result in a <code>picocli.CommandLine$DuplicateNameException</code>.
To mitigate this, configure the mock to not copy the annotations.
The example below shows how to use the <a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/MockSettings.html">MockSettings</a> API to accomplish this.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testMockWithoutAnnotations</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">CheckSum</span> <span class="n">checkSum</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">CheckSum</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">withSettings</span><span class="o">().</span><span class="na">withoutAnnotations</span><span class="o">());</span>
        <span class="nc">CommandLine</span> <span class="n">cmdLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="n">checkSum</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">cmdLine</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"test"</span><span class="o">));</span>
    <span class="o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You can&#8217;t use MockSettings with <code>spy()</code>.
To mock commands with subcommands you will need to use <code>mock()</code> instead of <code>spy()</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_packaging_your_application"><a class="anchor" href="#_packaging_your_application"></a>29. Packaging Your Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You finished your application. Congratulations! Now, how do you package it and distribute it to your users?</p>
</div>
<div class="paragraph">
<p>As mentioned in <a href="#_running_the_application">Running the Application</a>, earlier in this manual, one way to run our application is like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">java <span class="nt">-cp</span> <span class="s2">"picocli-4.6.2.jar;myapp.jar"</span> org.myorg.MyMainClass <span class="nt">--option</span><span class="o">=</span>value arg0 arg1</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is quite verbose. You may want to package your application in such a way that end users can invoke it by its command name like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">mycommand <span class="nt">--option</span><span class="o">=</span>value arg0 arg1</code></pre>
</div>
</div>
<div class="paragraph">
<p>After all, the usage help shows the command name defined in <code>@Command(name = "mycommand")</code>, so we would like users to be able to run the application with this command.</p>
</div>
<div class="paragraph">
<p>Below are some ideas on how to accomplish this.</p>
</div>
<div class="sect2">
<h3 id="_alias"><a class="anchor" href="#_alias"></a>29.1. Alias</h3>
<div class="paragraph">
<p>On unix-based operating systems, you can ask your users to define an alias. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">alias </span><span class="nv">mycommand</span><span class="o">=</span><span class="s1">'java -cp "/path/to/picocli-4.6.2.jar:/path/to/myapp.jar" org.myorg.MainClass'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Append the above line to your <code>~/.bashrc</code> file to make this alias available in every new shell session.</p>
</div>
<div class="paragraph">
<p>This requires that a JRE is installed on the machine and assumes that the <code>java</code> executable is in the <code>PATH</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In Windows, the <code>DOSKEY</code> command can be used to define macros, but this has <a href="https://superuser.com/questions/560519/how-to-set-an-alias-in-windows-command-line/560558#560558">serious limitations</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Defining an alias is cheap and easy, but fragile and not very portable.
A better alternative is to create a launcher script.
Many build tools provide plugins to generate launcher scripts for your application, as detailed in the following section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_launcher_script"><a class="anchor" href="#_launcher_script"></a>29.2. <a id="_build_tool_plugins"></a> Launcher Script</h3>
<div class="paragraph">
<p>The <a href="https://www.mojohaus.org/appassembler/">Application Assembler Maven Plugin</a> can be used with Maven, and similarly, <a href="https://docs.gradle.org/current/userguide/application_plugin.html">Gradle Application plugin</a> can be used with Gradle, to create a distribution zip or tar file with launcher scripts.</p>
</div>
<div class="paragraph">
<p>Both require a JRE to be installed on the target machine.</p>
</div>
<div class="paragraph">
<p>An even more interesting solution may be to create a GraalVM native image for your application, as detailed in the following section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_graalvm_native_image"><a class="anchor" href="#_graalvm_native_image"></a>29.3. GraalVM Native Image</h3>
<div class="paragraph">
<p><span class="image"><img src="images/exe-picocli-on-graalvm.png" alt="Turn your picocli-based application into a native image" width="265" height="150"></span></p>
</div>
<div class="sect3">
<h4 id="_what_are_graalvm_native_images"><a class="anchor" href="#_what_are_graalvm_native_images"></a>29.3.1. What are GraalVM Native Images?</h4>
<div class="paragraph">
<p><a href="https://www.graalvm.org/docs/reference-manual/aot-compilation/">GraalVM Native Image</a> allows you to
ahead-of-time compile Java code to a standalone executable, called a native image.
The resulting executable includes the application, the libraries, and the JDK and does not require a separate Java VM to be installed.
The generated native image has faster startup time and lower runtime memory overhead compared to a Java VM.</p>
</div>
<div class="paragraph">
<p>GraalVM native images have some limitations and require some extra <a href="https://github.com/oracle/graal/blob/master/substratevm/BuildConfiguration.md">configuration</a>
to be able to use features like <a href="https://github.com/oracle/graal/blob/master/substratevm/Reflection.md">reflection</a>, <a href="https://github.com/oracle/graal/blob/master/substratevm/Resources.md">resources</a> (including resource bundles) and <a href="https://github.com/oracle/graal/blob/master/substratevm/DynamicProxy.md">dynamic proxies</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_how_do_i_create_a_native_image_for_my_application"><a class="anchor" href="#_how_do_i_create_a_native_image_for_my_application"></a>29.3.2. How do I Create a Native Image for my Application?</h4>
<div class="paragraph">
<p>The <code>picocli-codegen</code> module contains an annotation processor that generates the necessary configuration files
under <code>META-INF/native-image/picocli-generated/$project</code> during compilation,
to be included in the application jar. The <a href="#_annotation_processor">Annotation Processor</a> section of the manual has details on configuring the annotation processor, and further information can be found in the <a href="https://github.com/remkop/picocli/tree/master/picocli-codegen">picocli-codegen README</a>
file.</p>
</div>
<div class="paragraph">
<p>By embedding these configuration files, your jar is instantly Graal-enabled: the
<a href="https://www.graalvm.org/docs/reference-manual/aot-compilation/#install-native-image"><code>native-image</code> tool</a>
used to generate the native executable is able to get the configuration from the jar.
In most cases no further configuration is needed when generating a native image.</p>
</div>
<div class="paragraph">
<p>After installing GraalVM and installing the <code>native-image</code> generator utility (with <code>gu install -L /path/to/native-image-installable</code>),
you can then create a native image by invoking the <code>native-image</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>path/to/native-image -cp picocli-4.6.2.jar --static -jar myapp.jar</pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
To create a native image, the compiler toolchain for your platform needs to be installed. See <a href="https://www.infoq.com/articles/java-native-cli-graalvm-picocli/">Build Great Native CLI Apps in Java with Graalvm and Picocli</a> for details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>GraalVM includes a <a href="https://medium.com/graalvm/simplifying-native-image-generation-with-maven-plugin-and-embeddable-configuration-d5b283b92f57">Maven plugin</a>
to generate a native image during the build.
Gradle users may be interested in the <a href="https://github.com/palantir/gradle-graal">gradle-graal</a> plugin by Palantir, or the <a href="https://plugins.gradle.org/plugin/org.mikeneck.graalvm-native-image">graalvm-native-image</a> plugin by Mike Neck.
(Documentation for both Maven and Gradle plugins seems sparse at time of this writing.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_where_can_i_get_more_details"><a class="anchor" href="#_where_can_i_get_more_details"></a>29.3.3. Where can I get More Details?</h4>
<div class="paragraph">
<p>This InfoQ article <a href="https://www.infoq.com/articles/java-native-cli-graalvm-picocli/">Build Great Native CLI Apps in Java with Graalvm and Picocli</a> provides details on setting up the GraalVM toolchain for creating native images.
It pays special attention to Windows, where setting up the compiler toolchain can be tricky.</p>
</div>
<div class="paragraph">
<p>This <a href="https://picocli.info/picocli-on-graalvm.html">older article</a>, "Picocli on GraalVM: Blazingly Fast Command Line Apps", may still be useful.</p>
</div>
<div class="paragraph">
<p>See also this <a href="https://github.com/remkop/picocli-native-image-demo">demo Gradle project</a> and this <a href="https://github.com/remkop/picocli-native-image-maven-demo">demo Maven project</a> that provide a simple complete CLI app, with build instructions, that developers can clone, and build to get the stand-alone executable.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_really_executable_jar"><a class="anchor" href="#_really_executable_jar"></a>29.4. Really Executable JAR</h3>
<div class="paragraph">
<p>A <a href="https://skife.org/java/unix/2011/06/20/really_executable_jars.html">really executable JAR</a>
is a JAR file that is also a shell script which executes the JAR by running it with <code>java</code>.
It thus functions as an exectuable, is portable across operating systems and architectures,
and is still a valid JAR file that can be executed explicitly or otherwise used as a JAR.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/brianm/really-executable-jars-maven-plugin">Really Executable JAR Maven Plugin</a>
can be used to create such a JAR, typically in combination with the shade plugin,
as the JAR needs to be standalone, containing all of its dependencies.</p>
</div>
</div>
<div class="sect2">
<h3 id="_launch4j"><a class="anchor" href="#_launch4j"></a>29.5. launch4j</h3>
<div class="paragraph">
<p><a href="http://launch4j.sourceforge.net/docs.html">launch4j</a> can create a native launcher executable. It can bundle a JRE (~200MB) or use a pre-installed one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javapackager_java_8"><a class="anchor" href="#_javapackager_java_8"></a>29.6. javapackager (Java 8)</h3>
<div class="paragraph">
<p>JDK 8 <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javapackager.html">javapackager</a> can create a native launcher executable. It can bundle a JRE (~200MB) or use a pre-installed one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jlink_java_9"><a class="anchor" href="#_jlink_java_9"></a>29.7. jlink (Java 9+)</h3>
<div class="paragraph">
<p>With the JPMS module system introduced in Java 9 it became possible to use <a href="https://docs.oracle.com/javase/9/tools/jlink.htm#JSWOR-GUID-CECAC52B-CFEE-46CB-8166-F17A8E9280E9">jlink</a> to create a custom light-weight JRE with only the necessary modules.
This JRE may be as small as 30-40MB.
Use <code>jlink</code> with the <code>--launcher</code> option to generate launcher scripts for your application.</p>
</div>
<div class="paragraph">
<p>See <a href="https://medium.com/azulsystems/using-jlink-to-build-java-runtimes-for-non-modular-applications-9568c5e70ef4">this article</a> for using jlink for non-modular applications.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jpackage"><a class="anchor" href="#_jpackage"></a>29.8. jpackage</h3>
<div class="paragraph">
<p>jpackage is a packaging tool according to <a href="https://openjdk.java.net/jeps/343">JEP 343</a> which ships with JDK 14.
JPackage can take the custom light-weight JRE produced by <code>jlink</code> and create an installer and a native application launcher.
The result is a Java "application image" that is a single directory in the filesystem containing
the native application launcher, resources and configuration files,
and the custom light-weight JRE runtime image (including the application modules) produced by <code>jlink</code>.</p>
</div>
<div class="paragraph">
<p>For further details, you may read the <a href="https://docs.oracle.com/en/java/javase/14/docs/specs/man/jpackage.html">jpackage synopsis</a> or study the <a href="https://docs.oracle.com/en/java/javase/14/jpackage/">Packaging Tool User&#8217;s Guide</a>.
This <a href="https://www.infoq.com/news/2019/03/jep-343-jpackage/">InfoQ article</a> may be of interest, too.
Gradle users may like these plugins: <a href="https://badass-runtime-plugin.beryx.org/releases/latest/">org.beryx Badass Runtime Plugin</a>
and <a href="https://badass-jlink-plugin.beryx.org/releases/latest/">org.beryx Badass JLink Plugin</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jbang"><a class="anchor" href="#_jbang"></a>29.9. jbang</h3>
<div class="paragraph">
<p><a href="https://github.com/maxandersen/jbang">jbang</a> allows you to write scripts in Java that use external dependencies.
You use it with a <code>//DEPS</code> comment, similar to the <a href="http://groovy-lang.org/grape.html"><code>@Grab</code></a> annotation in Groovy.</p>
</div>
<div class="paragraph">
<p>Use <code>jbang --init=cli helloworld.java</code> to create an initial script with a picocli template.
This <a href="https://asciinema.org/a/AVwA19yijKRNKEO0bJENN2ME3?autoplay=true&amp;speed=2">asciinema presentation</a> shows what is possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jreleaser"><a class="anchor" href="#_jreleaser"></a>29.10. JReleaser</h3>
<div class="paragraph">
<p><a href="https://jreleaser.org">JReleaser</a> enables several packaging options such as <a href="https://brew.sh/">Homebrew</a>, <a href="https://chocolatey.org/">Chocolatey</a>,
<a href="https://snapcraft.io/">Snapcraft</a>, <a href="https://scoop.sh/">Scoop</a>, <a href="https://www.jbang.dev/">jbang</a>, <a href="https://www.docker.com/">Docker</a>, among others.
Currently two different distribution  types are supported: jlink, and standard zip/tar distributions. The latter can be generated with a
combination of the <a href="https://www.mojohaus.org/appassembler/appassembler-maven-plugin/">appassembler-maven-plugin</a> and
<a href="http://maven.apache.org/plugins/maven-assembly-plugin/">maven-assembly-plugin</a> plugins if using Maven, or the
<a href="https://docs.gradle.org/current/userguide/application_plugin.html">application</a> plugin if using Gradle.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_picocli_in_other_languages"><a class="anchor" href="#_picocli_in_other_languages"></a>30. Picocli in Other Languages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli may be used in other JVM languages that support annotations.</p>
</div>
<div class="sect2">
<h3 id="_groovy"><a class="anchor" href="#_groovy"></a>30.1. Groovy</h3>
<div class="sect3">
<h4 id="_groovy_annotation_syntax"><a class="anchor" href="#_groovy_annotation_syntax"></a>30.1.1. Groovy Annotation Syntax</h4>
<div class="paragraph">
<p>In Groovy, use <code>[</code> and <code>]</code> to surround array values, instead of the <code>{</code> and <code>}</code> used in Java.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"MyApp"</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s2">"Groovy picocli v4.0 demo"</span><span class="o">,</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="c1">// add --help and --version options</span>
         <span class="n">description</span> <span class="o">=</span> <span class="s2">"@|bold Groovy|@ @|underline picocli|@ example"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s2">"-c"</span><span class="o">,</span> <span class="s2">"--count"</span><span class="o">],</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">"number of repetitions"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">count</span><span class="o">.</span><span class="na">times</span> <span class="o">{</span>
            <span class="n">println</span><span class="o">(</span><span class="s2">"hello world $it..."</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="k">new</span> <span class="n">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="n">MayApp</span><span class="o">()).</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">))</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_groovy_scripts"><a class="anchor" href="#_groovy_scripts"></a>30.1.2. Groovy Scripts</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Picocli 2.0 introduced special support for Groovy scripts.
From picocli 4.0 this was moved into a separate module, <code>picocli-groovy</code>.
In picocli 4.6, <code>@PicocliScript</code> was deprecated in favor of <code>@PicocliScript2</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Scripts annotated with <code>@picocli.groovy.PicocliScript2</code> are automatically transformed to use
<code>picocli.groovy.PicocliBaseScript2</code> as their base class and can also use the <code>@Command</code> annotation to
customize parts of the usage message like command name, description, headers, footers etc.</p>
</div>
<div class="paragraph">
<p>Before the script body is executed, the <code>PicocliBaseScript2</code> base class parses the command line and initializes
<code>@Field</code> variables annotated with <code>@Option</code> or <code>@Parameters</code>.
The script body is executed if the user input was valid and did not request usage help or version information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Grab</span><span class="o">(</span><span class="s1">'info.picocli:picocli-groovy:4.6.2'</span><span class="o">)</span>
<span class="nd">@GrabConfig</span><span class="o">(</span><span class="n">systemClassLoader</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"myScript"</span><span class="o">,</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="c1">// add --help and --version options</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">"@|bold Groovy script|@ @|underline picocli|@ example"</span><span class="o">)</span>
<span class="nd">@picocli.groovy.PicocliScript2</span>
<span class="kn">import</span> <span class="nn">groovy.transform.Field</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">picocli</span><span class="o">.</span><span class="na">CommandLine</span><span class="o">.*</span>

<span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="o">[</span><span class="s2">"-c"</span><span class="o">,</span> <span class="s2">"--count"</span><span class="o">],</span> <span class="n">description</span> <span class="o">=</span> <span class="s2">"number of repetitions"</span><span class="o">)</span>
<span class="nd">@Field</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

<span class="c1">// PicocliBaseScript2 prints usage help or version if requested by the user</span>

<span class="n">count</span><span class="o">.</span><span class="na">times</span> <span class="o">{</span>
   <span class="n">println</span> <span class="s2">"hi"</span>
<span class="o">}</span>
<span class="c1">// the CommandLine that parsed the args is available as a property</span>
<span class="k">assert</span> <span class="k">this</span><span class="o">.</span><span class="na">commandLine</span><span class="o">.</span><span class="na">commandName</span> <span class="o">==</span> <span class="s2">"myScript"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The older <code>@picocli.groovy.PicocliScript</code> annotation is deprecated from picocli 4.6.
New scripts should use the <code>@picocli.groovy.PicocliScript2</code> annotation (and associated <code>picocli.groovy.PicocliBaseScript2</code> base class) instead.
The table below compares these two base classes.</p>
</div>
<table class="tableblock frame-all grid-cols stretch">
<caption class="title">Table 6. Comparison of <code>PicocliBaseScript2</code> and <code>PicocliBaseScript</code> script base classes.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><code>PicocliBaseScript2</code></th>
<th class="tableblock halign-left valign-top"><code>PicocliBaseScript</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Subcommands as methods</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported, subcommands can be defined as <code>@Command</code>-annotated methods in the script.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsupported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><code>help</code> subcommands</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported, both the built-in one and custom ones.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsupported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Exit codes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported: scripts can override <code>afterExecution(CommandLine, int, Exception)</code> to call <code>System.exit</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsupported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Command execution</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Via invocation of <a href="https://picocli.info/#execute"><code>CommandLine::execute</code></a>. Scripts can override <code>beforeParseArgs(CommandLine)</code> to install a custom  <code>IExecutionStrategy</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution after parsing is defined in <code>PicocliBaseScript::run</code> and is not easy to customize. Any subcommand <em>and</em> the main script are <em>both</em> executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom handling of invalid user input</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scripts can override <code>beforeParseArgs(CommandLine)</code> to install a custom <code>IParameterExceptionHandler</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalid input handling can be customized by overriding <code>PicocliBaseScript::handleParameterException</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom error handling</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scripts can override <code>beforeParseArgs(CommandLine)</code> to install a custom <code>IExecutionExceptionHandler</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runtime exception handling can be customized by overriding <code>PicocliBaseScript::handleExecutionException</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Principle</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implements <code>Callable&lt;Object&gt;</code>, script body is transformed to the <code>call</code> method.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script body is transformed to the <code>runScriptBody</code> method.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
When upgrading scripts from picocli versions older than 4.0, just changing the version number is not enough!
Scripts should use <code>@Grab('info.picocli:picocli-groovy:4.6.2')</code>. The old artifact id <code>@Grab('info.picocli:picocli:4.6.2')</code> will not work,
because the <code>@picocli.groovy.PicocliScript</code> annotation class and supporting classes have been moved into a separate module, <code>picocli-groovy</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_closures_in_annotations"><a class="anchor" href="#_closures_in_annotations"></a>30.1.3. Closures in Annotations</h4>
<div class="paragraph">
<p>As of picocli 4.6, Groovy programs can use closures in the picocli annotations instead of specifying a class.
This can be especially useful in Groovy scripts, where one cannot define a static inner class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"ClosureDemo"</span><span class="o">,</span>
        <span class="n">versionProvider</span> <span class="o">=</span> <span class="o">{</span>
            <span class="o">{</span> <span class="o">-&gt;</span> <span class="o">[</span><span class="s2">"line1"</span> <span class="o">,</span> <span class="s2">"line2"</span><span class="o">]</span> <span class="k">as</span> <span class="n">String</span><span class="o">[]</span> <span class="o">}</span> <span class="k">as</span> <span class="n">IVersionProvider</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="o">},</span>
        <span class="n">defaultValueProvider</span> <span class="o">=</span> <span class="o">{</span>
            <span class="o">{</span> <span class="n">argSpec</span> <span class="o">-&gt;</span> <span class="s2">"some default"</span> <span class="o">}</span> <span class="k">as</span> <span class="n">IDefaultValueProvider</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="o">})</span>
<span class="kd">class</span> <span class="nc">ClosureDemo</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s1">'-x'</span><span class="o">,</span> <span class="n">completionCandidates</span> <span class="o">=</span> <span class="o">{[</span><span class="s2">"A"</span><span class="o">,</span> <span class="s2">"B"</span><span class="o">,</span> <span class="s2">"C"</span><span class="o">]})</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="n">String</span> <span class="n">x</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s1">'-y'</span><span class="o">,</span>
            <span class="n">parameterConsumer</span> <span class="o">=</span> <span class="o">{</span>
                <span class="o">{</span> <span class="n">args</span><span class="o">,</span> <span class="n">argSpec</span><span class="o">,</span> <span class="n">commandSpec</span> <span class="o">-&gt;</span>  <i class="conum" data-value="4"></i><b>(4)</b>
                    <span class="n">argSpec</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="n">commandSpec</span><span class="o">.</span><span class="na">name</span><span class="o">())</span>
                    <span class="n">args</span><span class="o">.</span><span class="na">clear</span><span class="o">()</span>
                <span class="o">}</span> <span class="k">as</span> <span class="n">IParameterConsumer</span>
            <span class="o">})</span>
    <span class="n">String</span> <span class="n">y</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="o">=</span> <span class="s1">'-z'</span><span class="o">,</span> <span class="n">converter</span> <span class="o">=</span> <span class="o">[</span> <span class="c1">// requires Groovy 3.0.7</span>
            <span class="o">{</span> <span class="o">{</span> <span class="n">str</span> <span class="o">-&gt;</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">str</span><span class="o">)</span> <span class="o">}</span> <span class="k">as</span> <span class="n">ITypeConverter</span> <span class="o">}</span> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="o">])</span>
    <span class="n">MessageDigest</span> <span class="n">z</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When a class is specified, picocli creates an instance of the class.
By contrast, when a closure is specified, picocli <em>calls the closure</em> to get an instance.
(To be precise, both of these are delegated to the configured <a href="#_custom_factory">factory</a>, and the default factory implementation supports closures from picocli 4.6.)</p>
</div>
<div class="paragraph">
<p>As you can see in the above example, each closure in the annotation should contain another closure that has the required type (<code>IVersionProvider</code>, <code>IDefaultValueProvider</code>, etc.)</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Command <code>versionProvider</code>: note the empty parameter list before the <code>&#8594;</code> arrow. This is needed to help the Groovy compiler. The closure must be cast to <code>IVersionProvider</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Command <code>defaultProvider</code>: return a default value for the specified <code>ArgSpec</code> parameter. The closure must be cast to <code>IDefaultValueProvider</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Option or Parameters <code>completionCandidates</code>: return a list of Strings. No parameter list or casting is required.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Option or Parameters <code>parameterConsumer</code>: given a <code>Stack</code>, <code>ArgSpec</code> and <code>CommandSpec</code>, process the remaining arguments. The closure must be cast to <code>IParameterConsumer</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Option or Parameters type <code>converter</code> takes an array of closures. Groovy 3.0.7 or greater is required: older versions of Groovy ignore closures in class array annotations. Each closure must have a parameter and be cast to <code>ITypeConverter</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_older_versions_of_groovy"><a class="anchor" href="#_older_versions_of_groovy"></a>30.1.4. Older Versions of Groovy</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using a Groovy version older than 2.4.7, use this workaround for the <a href="https://issues.apache.org/jira/browse/GROOVY-7613">Grape bug</a> that causes this error:
<code>java.lang.ClassNotFoundException: # Licensed to the Apache Software Foundation (ASF) under one or more</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="nd">@Grab</span><span class="o">(</span><span class="s1">'info.picocli:picocli-groovy:4.6.2'</span><span class="o">)</span>
<span class="nd">@GrabExclude</span><span class="o">(</span><span class="s1">'org.codehaus.groovy:groovy-all'</span><span class="o">)</span> <span class="c1">// work around GROOVY-7613</span>
<span class="o">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to get you started quickly, you may have a look at the <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/groovy/picocli/examples">Groovy examples</a> folder of the picocli code repository.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kotlin"><a class="anchor" href="#_kotlin"></a>30.2. Kotlin</h3>
<div class="sect3">
<h4 id="_kotlin_annotation_syntax"><a class="anchor" href="#_kotlin_annotation_syntax"></a>30.2.1. Kotlin Annotation Syntax</h4>
<div class="paragraph">
<p>Kotlin 1.2 (released Nov 28, 2017) officially supports <a href="http://kotlinlang.org/docs/reference/whatsnew12.html#array-literals-in-annotations">array literals in annotations</a>, allowing a more compact notation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"MyApp"</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="p">[</span><span class="s">"Kotlin picocli v4.0 demo"</span><span class="p">],</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="c1">// add --help and --version options</span>
        <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"@|bold Kotlin|@ @|underline picocli|@ example"</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="p">[</span><span class="s">"-c"</span><span class="p">,</span> <span class="s">"--count"</span><span class="p">],</span> <span class="n">paramLabel</span> <span class="p">=</span> <span class="s">"COUNT"</span><span class="p">,</span>
            <span class="n">description</span> <span class="p">=</span> <span class="p">[</span><span class="s">"the count"</span><span class="p">])</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">count</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">1</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">0</span> <span class="n">until</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"hello world $i..."</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">=</span> <span class="nc">System</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When specify a class as an argument of an annotation, use a Kotlin class (<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html">KClass</a>).
The Kotlin compiler will automatically convert it to a Java class, so that the Java code will be able to see the annotations and arguments normally.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"top"</span><span class="p">,</span> <span class="c1">// ...</span>
        <span class="n">subcommands</span> <span class="p">=</span> <span class="p">[</span><span class="nc">SubCmd</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="n">picocli</span><span class="p">.</span><span class="nc">CommandLine</span><span class="p">.</span><span class="nc">HelpCommand</span><span class="o">::</span><span class="k">class</span><span class="p">])</span>
<span class="kd">class</span> <span class="nc">TopCmd</span> <span class="p">{</span> <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"sub"</span><span class="p">,</span> <span class="cm">/* ... */</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">SubCmd</span> <span class="p">{</span> <span class="c1">// ...</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_older_versions_of_kotlin"><a class="anchor" href="#_older_versions_of_kotlin"></a>30.2.2. Older Versions of Kotlin</h4>
<div class="paragraph">
<p>Kotlin versions prior to 1.2 did not allow the <a href="https://kotlinlang.org/docs/reference/annotations.html">array literal syntax in annotations</a>, so with older versions of Kotlin you will have to write <code>arrayOf(&#8230;&#8203;)</code> for the <code>names</code>, <code>description</code> and <code>type</code> attributes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nd">@Command</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"MyApp"</span><span class="p">,</span> <span class="n">version</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"picocli demo for Kotlin v1.0 and Kotlin v1.1"</span><span class="p">),</span>
        <span class="n">mixinStandardHelpOptions</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="c1">// add --help and --version options</span>
        <span class="n">description</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"@|bold Kotlin|@ @|underline picocli|@ example"</span><span class="p">))</span>
<span class="kd">class</span> <span class="nc">MyApp</span> <span class="p">:</span> <span class="nc">Callable</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">{</span>

    <span class="nd">@Option</span><span class="p">(</span><span class="n">names</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"-c"</span><span class="p">,</span> <span class="s">"--count"</span><span class="p">),</span>
            <span class="n">description</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="s">"number of repetitions"</span><span class="p">))</span>
    <span class="k">private</span> <span class="kd">var</span> <span class="py">count</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">1</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">call</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">0</span> <span class="n">until</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"hello world $i..."</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">=</span> <span class="nc">System</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="nc">CommandLine</span><span class="p">(</span><span class="nc">MyApp</span><span class="p">()).</span><span class="nf">execute</span><span class="p">(*</span><span class="n">args</span><span class="p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to get you started quickly, you may have a look at the <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/kotlin/picocli/examples/kotlin">Kotlin examples</a> folder of the picocli code repository.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scala"><a class="anchor" href="#_scala"></a>30.3. Scala</h3>
<div class="paragraph">
<p>Scala does not allow specifying array annotation attribute as a single value,
so be aware that you will have to write <code>Array(&#8230;&#8203;)</code> for the <code>names</code>, <code>description</code> and <code>type</code> attributes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="scala"><span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="k">=</span> <span class="s">"MyApp"</span><span class="o">,</span> <span class="n">version</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"Scala picocli demo v4.0"</span><span class="o">),</span>
         <span class="n">mixinStandardHelpOptions</span> <span class="k">=</span> <span class="kc">true</span><span class="o">,</span> <span class="c1">// add --help and --version options</span>
         <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"@|bold Scala|@ @|underline picocli|@ example"</span><span class="o">))</span>
<span class="k">class</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">Callable</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">names</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"-c"</span><span class="o">,</span> <span class="s">"--count"</span><span class="o">),</span> <span class="n">paramLabel</span> <span class="k">=</span> <span class="s">"COUNT"</span><span class="o">,</span>
            <span class="n">description</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"the count"</span><span class="o">))</span>
    <span class="k">private</span> <span class="k">var</span> <span class="n">count</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">call</span><span class="o">()</span> <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nf">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="mi">0</span> <span class="n">until</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
            <span class="nf">println</span><span class="o">(</span><span class="n">s</span><span class="s">"hello world $i..."</span><span class="o">)</span>
        <span class="o">}</span>
        <span class="mi">0</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="k">object</span> <span class="nc">MyApp</span> <span class="o">{</span>
    <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nv">System</span><span class="o">.</span><span class="py">exit</span><span class="o">(</span><span class="k">new</span> <span class="nc">CommandLine</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyApp</span><span class="o">()).</span><span class="py">execute</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">))</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to get you started quickly, you may have a look at the <a href="https://github.com/remkop/picocli/tree/master/picocli-examples/src/main/scala/picocli/examples/scala">Scala examples</a> folder of the picocli code repository.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_api_javadoc"><a class="anchor" href="#_api_javadoc"></a>31. API Javadoc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli API Javadoc can be found <a href="apidocs/">here</a>.</p>
</div>
<div class="paragraph">
<p>See also: <a href="https://remkop.github.io/picocli/apidocs">latest version</a>, <a href="https://picocli.info/man/3.x/apidocs">picocli 3.x javadoc</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_github_project"><a class="anchor" href="#_github_project"></a>32. GitHub Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/remkop/picocli">GitHub project</a> has the source code, tests, build scripts, etc.</p>
</div>
<div class="paragraph">
<p>Star <span class="icon"><i class="fa fa-star-o"></i></span> and/or fork <span class="icon"><i class="fa fa-code-fork"></i></span> this project on GitHub if you like it!</p>
</div>
<iframe src="https://ghbtns.com/github-btn.html?user=remkop&repo=picocli&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=remkop&repo=picocli&type=fork&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=remkop&type=follow&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
</div>
</div>
<div class="sect1">
<h2 id="_issue_tracker"><a class="anchor" href="#_issue_tracker"></a>33. Issue Tracker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The GitHub <a href="https://github.com/remkop/picocli/issues">Issue Tracker</a> can be used to report bugs or request features. There is also a <a href="#_mailing_list">Mailing List</a>, and for questions where the user community may know the answer, <a href="https://stackoverflow.com/questions/tagged/picocli">StackOverflow</a> is both a good resource and a great way to build an online knowledge base.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mailing_list"><a class="anchor" href="#_mailing_list"></a>34. Mailing List</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Join the <a href="https://groups.google.com/d/forum/picocli">picocli Google group</a> if you are interested in discussing anything picocli-related and receiving announcements on new releases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license"><a class="anchor" href="#_license"></a>35. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Picocli is licensed under the <a href="https://github.com/remkop/picocli/blob/master/LICENSE">Apache License 2.0</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_releases"><a class="anchor" href="#_releases"></a>36. Releases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Previous versions are available from the GitHub project <a href="https://github.com/remkop/picocli/releases">Releases</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_download"><a class="anchor" href="#_download"></a>37. Download</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can add picocli as an external dependency to your project, or you can include it as source.</p>
</div>
<div class="sect2">
<h3 id="_build_tools"><a class="anchor" href="#_build_tools"></a>37.1. Build tools</h3>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="n">implementation</span> <span class="s1">'info.picocli:picocli:4.6.2'</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Gradle (Kotlin)</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"info.picocli:picocli:4.6.2"</span><span class="p">)</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Maven</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>info.picocli<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>picocli<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.6.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Scala SBT</div>
<div class="content">
<pre class="rouge highlight"><code>libraryDependencies += "info.picocli" % "picocli" % "4.6.2"</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Ivy</div>
<div class="content">
<pre class="rouge highlight"><code>&lt;dependency org="info.picocli" name="picocli" rev="4.6.2" /&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Grape</div>
<div class="content">
<pre class="rouge highlight"><code>@Grapes(
    @Grab(group='info.picocli', module='picocli', version='4.6.2')
)</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Leiningen</div>
<div class="content">
<pre class="rouge highlight"><code>[info.picocli/picocli "4.6.2"]</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Buildr</div>
<div class="content">
<pre class="rouge highlight"><code>'info.picocli:picocli:jar:4.6.2'</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">JBang</div>
<div class="content">
<pre class="rouge highlight"><code>//DEPS info.picocli:picocli:4.6.2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_source"><a class="anchor" href="#_source"></a>37.2. Source</h3>
<div class="paragraph">
<p>By using picocli in source form, you can avoid having an external dependency on picocli.
Picocli has only one source file: <a href="https://github.com/remkop/picocli/blob/master/src/main/java/picocli/CommandLine.java">CommandLine.java</a>.
This facilitates including picocli in your project: simply copy and paste the code of this file into a file called <code>CommandLine.java</code>, add it to your project, and enjoy!</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 4.6.2<br>
Last updated 2021-11-05 19:59:03 +0900
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.7/tocbot.min.js"></script>
<script>
    /* Tocbot dynamic TOC, works with tocbot 3.0.7 */
    var oldtoc = document.getElementById('toctitle').nextElementSibling;
    var newtoc = document.createElement('div');
    newtoc.setAttribute('id', 'tocbot');
    newtoc.setAttribute('class', 'js-toc');
    oldtoc.parentNode.replaceChild(newtoc, oldtoc);
    tocbot.init({ contentSelector: '#content',
        headingSelector: 'h1, h2, h3, h4, h5',
        smoothScroll: false,
        collapseDepth: 3 });
    var handleTocOnResize = function() {
        var width = window.innerWidth
                    || document.documentElement.clientWidth
                    || document.body.clientWidth;
        if (width < 768) {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: 'h1, h2, h3, h4',
                collapseDepth: 6,
                activeLinkClass: 'ignoreactive',
                throttleTimeout: 1000,
                smoothScroll: false });
        }
        else {
            tocbot.refresh({ contentSelector: '#content',
                headingSelector: 'h1, h2, h3, h4, h5',
                smoothScroll: false,
                collapseDepth: 3 });
        }
    };
    window.addEventListener('resize', handleTocOnResize);
    handleTocOnResize();
</script>
</body>
</html>